=>DLT Project

     =move file
          bcj3 > admintemplatetwo > assets
          exercisetwo > public

          bcj3 > admintemplatetwo > css, js
          exercisetwo > public > assets > disc (disc folder created)

     =Dashboard page
          default dashboard page to customized dashboards page 

          php artisan make:controller DashboardsController -r
     
     =In DashboardsController.php

     =In Web
          Route::get("/dashboards",[DashboardsController::class,'index'])->name("dashboard.index");
          *use App\Http\Controllers\DashboardsController;

     =In View
          dashboards >
          =create index.blade.php

          =create adminindex.blade.php
          =create adminheader.blade.php (<!DOCTYPE HTML - <body>)
          =create adminfooter.blade.php (</body> - </html>)
          =create adminleftsitebar.blae.php (Start -End Left Navbar)


          =In adminindex.blde.php
               @include("layouts.adminheader")

               <div>
                    <!-- Start Site Setting -->
                    <div id="sitesettings" class="sitesettings">
                         <div class="sitesettings-item"><a href="javascript:void(0);" id="sitetoggle" class="sitetoggle"><i class="fas fa-cog ani-rotates"></i></a></div>
                    </div>
                    <!-- End Site Settin -->

                    <!-- Start Left Side Bar -->
                    @include("layouts.adminleftsidebar")
                    <!-- End Left Side Bar -->

                    <!-- Start Content Area -->
                    @yield("content")
                    <!-- End Content Area -->
               </div>
         
               @include("layouts.adminfooter")

     
          =In index.blade.php
               @extends("layouts.adminindex")

               @section("content")
                    <!-- Start Content Area -->
                    <section>
                         ....
                    </section>
                    <!-- End Content Area -->
               @endsection

          =In adminheader.blade.php
               <!-- Application Name -->
               <title>{{ config('app.name') }}</title>
               <!-- fav icon -->
               <link href="{{ asset('assets/img/fav/favicon.png') }}" rel="icon" type="image/png" sizes="16x16"/>
               <!-- jqueryui css1 js1 -->
               <link href="{{asset('./assets/libs/jquery-ui-1.13.2.custom/jquery-ui.min.css')}}" rel="stylesheet" type="text/css">
               <!-- custom css css1 -->
               <link href="{{ asset('assets/disc/css/style.css') }}" rel="stylesheet" type="text/css"/>
          
               <!-- Extra CSS -->
               @yield('css')

               =.env
                    APP_NAME="DLT Project"
          =In adminfooter.blade.php
               <!-- jqueryui css1 js1 -->
               <script src="{{asset('./assets/libs/jquery-ui-1.13.2.custom/jquery-ui.min.js')}}"></script>
               <!-- custom js js1 -->
               <script src="{{ asset('assets/disc/js/app.js') }}" type="text/javascript"></script>

          
     =>Display Authenticated user name
          =In app > Provider > AppServiceProvider.php
               public function boot(): void
               {
                    View::composer('*',function($view){
                         $view->with("userdata",Auth::user());
                    });
               }
               *use Illuminate\Support\Facades\View;
               *use Illuminate\Support\Facades\Auth;

          =In adminleftsidebar.blade.php
               <span class="text-muted small me-2">{{ $userdata["name"] }}</span>

     =>After login/register Redirect
          app > Providers > RouteServiceProvider.php

               // public const HOME = '/dashboard';
               public const HOME = '/dashboards';
          
          *user is redirectd to dashboards after sucessful authentication.

     =create filder students >
     =index.blade.php
     =create.blade.php

     =>Sticky Form
          -When validation error occur, all form field is empty. To protect the user from repeatedly filling the field.
          -get the previous filled value if error occur
               old('inputname')
          
          =In create.blade.php
               <input type="text" name="firstname" id="firstname" class="form-control form-control-sm rounded-0" placeholder="Enter First name" value="{{ old('firstname') }}"/>
               <textarea name="remark" id="remark" class="form-control rounded-0" rows="5" placeholder="Enter Remark">{{ old('remark')}}</textarea>

     =>Limiting text length
          =In index.blade.php
               <td>{{Str::limit($student->remark,10)}}</td>

     =>Formattng date time (laravel)
          =In index.blade.php
               <td>{{ $student->created_at->format('d M Y') }}</td>
               <td>{{ $student->updated_at->format('d M Y') }}</td>

     =>Delete Best Practice 
          =In index.blade.php
                    <td>
                         <a href="{{ route('students.edit',$student->id) }}" class="text-info"><i class="fas fa-pen"></i></a>
                         <!-- <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$student->id}}"><i class="fas fa-trash-alt"></i></a> -->
                         <!-- <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a> -->
                         <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$student->regnumber}}"><i class="fas fa-trash-alt"></i></a>
                    
                    </td>
                    ....
                    <!-- <form id="formdelete-{{ $student->id }}" class="" action="{{route('students.destroy',$student->id)}}" method="POST"> -->
                    <!-- <form id="formdelete-{{ $idx }}" class="" action="{{route('students.destroy',$student->id)}}" method="POST"> -->
                    <form id="formdelete-{{ $student->regnumber }}" class="" action="{{route('students.destroy',$student->id)}}" method="POST">
                         @csrf
                         @method("DELETE")
                    </form>

               @section("scripts")
                    <script type="text/javascript">
                         $(document).ready(function(){
                              $(".delete-btns").click(function(){
                                   // console.log('hay');
                         
                                   var getidx = $(this).data("idx");
                                   // console.log(getidx);

                                   if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
                                        $('#formdelete-'+getidx).submit();
                                        return true;
                                   }else{
                                        false;
                                   }
                              });
                         });
                    </script>
               @endsection

          -Comfirm user to delete this student id (it is not very user-friendly. It can be complex).
          -Comfirm user to delete this current number or registration number (it is secretly delete the student id in background).

     =>user_id, status_id join
          =In Model (Student.php)
               public function user(){
                    return $this->belongsTo("App\Models\User");
               }

               public function status(){
                    // return $this->belongsTo(Status::class); // send all column
                    // return $this->belongsTo(Status::class)->select("name"); // send single column
                    return $this->belongsTo(Status::class)->select(["id","name","slug"]); // send multi column
               }

          =In index.blade.php
               <td>{{ $student->status->name }}</td>
               <td>{{ $student->user["name"] }}</td>
          =In show.blade.php
               <i class="fas fa-user fa-sm"></i> <span>{{$student["user"]["name"]}}</span>

          
          *show user name and status name by joining the tables

     =>Formattng date time (php)
          =In show.blade.php
               <i class="fas fa-calendar-alt fa-sm"></i> <span>{{date('d M Y',strtotime($student->created_at))}} {{date('h:i:s A',strtotime($student->created_at))}}</span>
               <br/>
               <i class="fas fa-edit fa-sm"></i> <span>{{date('d M Y h:i:s A',strtotime($student->updated_at))}}</span>

     =>Setting server timezone
          config > app.php
               'timezone' => 'Asia/Yangon',

     =>Update & Validate
          =In StudentsController.php
               public function update(Request $request, string $id)
               {
                    $this->validate($request,[
                         // "regnumber" => "required|unique:students,regnumber",
                         "regnumber" => "required|unique:students,regnumber,".$id,
                         "firstname"=>"required",
                         "lastname"=>"required",
                         "remark" => "max:1000"
                    ]);

                    $user = Auth::user();
                    $user_id = $user["id"];

                    $student = Student::findOrFail($id);
                    $student->regnumber = $request["regnumber"];
                    $student->firstname = $request["firstname"];
                    $student->lastname = $request["lastname"];
                    $student->slug = Str::slug($request["firstname"]);
                    $student->remark = $request["remark"];
                    $student->user_id = $user_id;

                    $student->save();
                    return redirect(route("students.index"));
               }

          *slug name will be updated, when the firstname is modified
          - validation error and the updated information is not stored 
               if check "regnumber" Unique and we only change firstname, not the regnumber field
          -Unique check the field is not exist in the database table

          - Forcing A Unique Rule To Ignore A Given ID
               unique rule pass for the student id.
               *update() must carefully specify id to ignore unique rule

     => Small resource CRUD (Single Page)
          =>Create/Store + index
               =index.blade.php
                    <div class="col-md-12">
                         <!-- http://127.0.0.1:8000/statuses -->
                         <form action="{{route('statuses.store')}}" method="POST">
                              {{ csrf_field() }}
                              <div class="row align-items-end">
                                   <div class="col-md-6">
                                        <label for="name">Name <span class="text-danger">*</span></label>
                                        <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Status Name" value="{{ old('name') }}"/>
                                   </div>

                                   <div class="col-md-6 ">
                                        <button type="reset" class="btn btn-secondary btn-sm rounded-0">Cancel</button>
                                        <button type="submit" class="btn btn-primary btn-sm rounded-0 ms-3">Submit</button>
                                   </div>
                              </div>
                         </form>
                    </div>
                    ....

                    <tbody>
                         @foreach($statuses as $idx=>$status)
                         <tr>
                              <td>{{++$idx}}</td>
                              <td>{{ $status->name }}</td>
                              <td>{{ $status->user["name"] }}</td>
                              <td>{{ $status->created_at->format('d M Y') }}</td>
                              <td>{{ $status->updated_at->format('d M Y') }}</td>
                              
                         </tr>
                         @endforeach
                    </tbody>

               =In StatusesController.php
                    public function index()
                    {
                         $statuses = Status::all();
                         return view("statuses.index",compact("statuses"));
                    }

                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "name" => "required|unique:statuses,name",
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $status = new Status();
                         $status->name = $request["name"];
                         $status->slug = Str::slug($request["name"]);
                         $status->user_id = $user_id;

                         $status->save();
                         return redirect(route("statuses.index"));
                    }
                    *This time use Request.
                    -We will study StatusCreateRequest later.

                    -No longer require create().
          
          =>Read 
               -Don't need to use show() because resource is too small.
          =>Delete
               =In index.blade.php
                    <td>
                         <a href="{{ route('statuses.edit',$status->id) }}" class="text-info"><i class="fas fa-pen"></i></a>
                         <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a>
                    
                    </td>
                    <form id="formdelete-{{ $idx }}" class="" action="{{route('statuses.destroy',$status->id)}}" method="POST">
                         @csrf
                         @method("DELETE")
                    </form>
               =In StatusesController.php
                    public function destroy(string $id)
                    {
                         $student = Status::findOrFail($id);
                         $student->delete();
                         return redirect()->back();
                    }
          
          =>Edit/Update + index (Single Page)
               =In index.blade.php
                    <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$status->id}}" data-name="{{$status->name}}"><i class="fas fa-pen"></i></a>
                    ....

                    <!-- START MODAL AREA -->
                         <!-- start edit modal -->
                              <div id="editmodal" class="modal fade">
                                   <div class="modal-dialog modal-sm modal-dialog-centered">
                                        <div class="modal-content">
                                             <div class="modal-header">
                                                  <h6 class="modal-title">Edit Form</h6>
                                                  <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                             </div>

                                             <div class="modal-body">
                                                  <form id="formaction" action="" method="POST">
                                                       {{ csrf_field() }}
                                                       {{ method_field('PUT') }}
                                                       <div class="row align-items-end">
                                                            <div class="col-md-8">
                                                                 <label for="editname">Name <span class="text-danger">*</span></label>
                                                                 <input type="text" name="name" id="editname" class="form-control form-control-sm rounded-0" placeholder="Enter Status Name" value="{{ old('name') }}"/>
                                                            </div>
                                   
                                                            <div class="col-md-2">
                                                                 <button type="submit" class="btn btn-primary btn-sm rounded-0">Update</button>
                                                            </div>
                                                       </div>
                                                  </form>
                                             </div>

                                             <div class="modal-footer">

                                             </div>
                                        </div>
                                   </div>
                              </div>
                         <!-- end edit modal -->
                    <!-- END MODAL AREA -->      

                    ....

                    // Start Edit Form
                    $(document).on("click",".editform",function(e){
                         // console.log($(this).attr("data-id"),$(this).attr("data-name"));
                         
                         $("#editname").val($(this).attr("data-name"));
                         const getid = $(this).attr("data-id");
                         $("#formaction").attr("action",`/statuses/${getid}`);

                         e.preventDefault();
                    });
                    // End Edit Form
               
               =In StatusesController.php

                    public function update(Request $request, string $id)
                    {
                         $this->validate($request,[
                              "name" => "required|unique:statuses,name,".$id,
                         ]);

                         $user = Auth::user();
                         $user_id = $user['id'];

                         $status = Status::findOrFail($id);
                         $status->name = $request["name"];
                         $status->slug = Str::slug($request["name"]);
                         $status->user_id = $user_id;

                         $status->save();
                         return redirect(route("statuses.index"));
                    }
                    -No longer require edit().

               *Show the current item information in edit modal 
                    -modal box with bootstrap
                    -link modal box with edit btn
                    -"id", "name" pass from edit btn
                    -clicking edit btn, set "name" to the edit form input field 

               *if modal form is set to action="{{route('statuses.update',$status->id)}}",
                    the url is http://127.0.0.1:8000/statuses/14
                    -change in any item will only change the last item because it is outside the loop
                    -if there is no row in database, it will get error (undefined variable) since it didn't even enter the loop 
               
               *atomatically change update url of current item
                    -clicking edit btn, dynamically set edit form action url with the current item "id" 


     =>Image + Select box
          php artisan make:controller RolesController -r
          php artisan make:model Role -m 

          =In Web
               *under Auth
               Route::resource("roles",RolesController::class);

          =Migration
               =create_roles_table.php
                    $table->string("image")->nullable();
                    $table->string("name");
                    $table->string("slug");
                    $table->unsignedBigInteger("status_id")->default("3");
                    $table->unsignedBigInteger("user_id");

               php artisan migrate:status
               php artisan migrate

          =In Model (Role.php)
               protected $table = "roles";
               protected $primaryKey = "id";
               protected $fillable = [
                    "image",
                    "name",
                    "slug",
                    "status_id",
                    "user_id"
               ];

               public function user(){
                    return $this->belongsTo(User::class);
               }

               public function status(){
                    return $this->belongsTo(Status::class);
               }

          =>Single Image Preview
               =In create.blade.php
                    jQuery image preview html css js        
                    filereader.onload = function(e){
                         $(output).html(""); 
                         $($.parseHTML('<img>')).attr('src',e.target.result).appendTo(output);
                    }
                    *Firstly repeatedly choosing image show unnecessary previous selected image.
                         -Solution for this is, output element's html is set empty, preparing ready to show new image.

          =>Status Option
               =In RolesController.php
                    public function create()
                    {    
                         //$statuses = Status::all(); // get all statuses
                         $statuses = Status::whereIn("id",[3,4])->get();
                         return view("roles.create",compact("statuses"));
                    }

               =In create.blade.php
                    <select type="text" name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                         <!-- <option value="3">On</option>
                         <option value="4">On</option> -->

                         @foreach($statuses as $status)
                              <option value="{{$status->id}}">{{ $status->name }}</option>
                         @endforeach
                    </select>

                    *dynamically get statuses from database
          
          =>Image Store With Selected Role
               =In RolesController.php
                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "name" => "required|max:50|unique:roles,name",
                              "image" => "image|mimes:jpg,jpeg,png|max:1024",
                              "status_id" => "required|in:3,4",
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $role = new Role();
                         $role->name = $request["name"];
                         $role->slug = Str::slug($request["name"]);
                         $role->status_id = $request["status_id"];
                         $role->user_id = $user_id;

                         // Single Image Upload
                         if(file_exists($request["image"])){
                              $file = $request["image"];
                              $fname = $file->getClientOriginalName();
                              $imagenewname = uniqid($user_id).$role['id'].$fname;
                              $file->move(public_path("assets/img/roles"),$imagenewname);
            
                              $filepath = "assets/img/roles/".$imagenewname;
                              $role->image = $filepath;
                         }    

                         $role->save();
                         return redirect(route("roles.index"));
                    }
                    *update() needed to be careful than store() if UNIQUE rule is declared,
                         other rules should be defined in front of UNIQUE for the clarity.
                    -Whatever view status_id change, validation rule is not match unless 3 or 4.
          
                    
                    public > foldername = routename
                         $file->move(public_path("roles/img"),$imagenewname);
                         $filepath = "roles/img".$imagenewname;

                    *error
                         Not Found
                         The requested resource /roles was not found on this server.
                    -However, roles/index can't be opened, create and other page can be opened.
                    -Although error occur, the role record and image file (public>roles) are inserted successfully.
          
          =>Image View
               =index.blade.php    
                    <td><img src="{{ asset($role->image) }}" class="rounded-circle" alt="{{$role->name}}" width="20" height="20"/> <a href="{{route('roles.show',$role->id)}}">{{$role->name}}</a></td>
                    
               *asset() use for the file in project folder
               *real world project use aws(amazone web service) and image store as http link
                    so directly give src="$role->image"

          =>Image Edit With Selected Role
               =In RolesController.php
                    public function edit(string $id)
                    {
                         $role = Role::findOrFail($id);
                         $statuses = Status::whereIn("id",[3,4])->get();
                         return view("roles.edit")->with("role",$role)->with("statuses",$statuses);
                    }

               option value = 2 
               equal to
               column value = 2

               <option value="1">myanmar</option>
               "country" column = 2
               *'selected' attribute is to an select option 

               =In index.blade.php
                    <select type="text" name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                         @foreach($statuses as $status)
                              <option value="{{$status->id}}" 
                                   @if($status['id'] === $role->status_id)
                                        selected
                                   @endif
                              >{{ $status->name }}</option>
                         @endforeach
                    </select>
                    -show the statuses and highlight the selected status

                    <form action="/roles/{{$role->id}}" method="POST" enctype="multipart/form-data">
                         @csrf
                         @method("PUT")

                         <div class="row">

                              <div class="col-md-4">
                                   <div class="row">
                                        <div class="col-md-6 text-sm-center">
                                             <img src="{{ asset($role->image) }}" class="" alt="{{$role->name}}" width="200"/>
                                        </div>
                                        <div class="col-md-6">
                                             <label for="image" class="gallery"><span>Choose Images</span></label>
                                        </div>
                                   </div>  
                              </div>
                    -one part show the previous image and another part show the newly changed image

          =>Image Update
               =In RolesController.php  
                    public function update(Request $request, string $id)
                    {
                         $this->validate($request,[
                              "name" => ["required","max:50","unique:roles,name,".$id],
                              "image" => ["image","mimes:jpg,jpeg,png","max:1024"],
                              "status_id" => ["required","in:3,4"],
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $role = Role::findOrFail($id);
                         $role->name = $request["name"];
                         $role->slug = Str::slug($request["name"]);
                         $role->status_id = $request["status_id"];
                         $role->user_id = $user_id;

                         // Remove Old Image
                         if($request->hasFile("image")){
                              $path = $role->image;

                              if(File::exists($path)){
                                   File::delete($path);
                              }
                         }

                         // Single Image Upload
                         if($request->hasFile("image")){
                              $file = $request->file("image");
                              $fname = $file->getClientOriginalName();
                              $imagenewname = uniqid($user_id).$role['id'].$fname;
                              $file->move(public_path("assets/img/roles"),$imagenewname);
                              
                              $filepath = "assets/img/roles/".$imagenewname;
                              $role->image = $filepath;
                         }    

                         $role->save();
                         return redirect(route("roles.index"));
                    }
                    *Validation can be written as array.
          
          =>Image Delete
               =In RolesController.php
                    public function destroy(string $id)
                    {
                         $role = Role::findOrFail($id);
                         
                         // Remove Old Image
                         $path = $role->image;
                         if(File::exists($path)){
                              File::delete($path);
                         }
                         
                         $role->delete();
                         return redirect()->back();
                    }
          -laravel has reload and reloading problem.
          -Adding javascript is the solution for the problem. (Single File Create/Edit)

          Laravel 
          -Large Solid File is given.
          -Long Time To download the file

          React js
          -Break the heavy workloads into Components
          -Combine seperate components into a single file
          -better performance

     =>Fix Analysis
          Statuses
               'Active'
               'Inactive'
               'On'
               'Off'
               'Online'
               'Offline'
               'Public'
               'Private'
               'Friend Only'
               'Member Only'
               'Only Me'
               'Enable'
               'Disable'
               'Ban'
               'Unban'
               'Block'
               'Unblock'
               'Terminate'

     =>Small resource + Select box
          php artisan make:controller TypesController 

          =In Migration
               php artisan make:model Type -m
               =create_types_table.php
                    up()
                         $table->string("name")->unique();
                         $table->string("slug");
                         $table->unsignedBigInteger("status_id");
                         $table->unsignedBigInteger("user_id");
                         $table->timestamps();

               php artisan migrate:status
               php artisan migrate

          =In Web
               Route::resource("types",TypesController::class);

          =>Check Route
               php artisan route:list
               php artisan route:clear
               php artisan route:cache

               *if the code is all fine and route is not ready
                    it must be the problem of cache, so clear the cache. 
          
          =>Create/Store + index With Selected Option
               =In TypesController.php
                    public function index()
                    {
                         $types = Type::all();
                         $statuses = Status::whereIn("id",[3,4])->get();
                         return view("types.index",compact("types","statuses"));
                    }
                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "name" => "required|max:50|unique:types",
                              "status_id" => "required|in:3,4",
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $type = new Type();
                         $type->name = $request["name"];
                         $type->slug = Str::slug($request["name"]);
                         $type->status_id = $request["status_id"];
                         $type->user_id = $user_id;
                         $type->save();
                         return redirect(route("types.index"));
                    }
               =In index.blade.php
                    <div class="col-md-12">
                         <form action="{{route('types.store')}}" method="POST">
                              {{ csrf_field() }}

                              <div class="row align-items-end">
                                   <div class="col-md-4">
                                        <label for="name">Name <span class="text-danger">*</span></label>
                                        <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Type Name" value="{{ old('name') }}"/>
                                   </div>

                                   <div class="col-md-4">
                                        <label for="status_id">Status</label>
                                        <select name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                                             @foreach($statuses as $status)
                                                  <option value="{{$status['id']}}">{{$status['name']}}</option>
                                             @endforeach     
                                        </select>
                                   </div>

                                   <div class="col-md-4">
                                        <button type="reset" class="btn btn-secondary btn-sm rounded-0">Cancel</button>
                                        <button type="submit" class="btn btn-primary btn-sm rounded-0 ms-3">Submit</button>
                                   </div>
                              </div>
                         </form>
                    </div>
                    ....
                    <tbody>
                         @foreach($types as $idx=>$type)
                         <tr>
                              <td>{{++$idx}}</td>
                              <td>{{$type["name"]}}</td>
                              <td>{{ $type->status->name }}</td>
                              <td>{{ $type["user"]["name"] }}</td>
                              <td>{{ $type->created_at->format('d M Y') }}</td>
                              <td>{{ $type->updated_at->format('d M Y') }}</td>
                              <td>
                                   <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$status->id}}" data-name="{{$status->name}}"><i class="fas fa-pen"></i></a>
                                   <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a>
                              </td>
                              <form id="formdelete-{{ $idx }}" class="" action="{{route('types.destroy',$type->id)}}" method="POST">
                                   @csrf
                                   @method("DELETE")
                              </form>
                         </tr>
                         @endforeach
                    </tbody>

          =>Delete
               public function destroy(string $id)
               {
                    $type = Type::findOrFail($id);
                    $type->delete();
                    return redirect()->back();
               }

          =>Edit/Update + index With Selected Option
               =In index.blade.php 
                    <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$type->id}}" data-name="{{$type->name}}" data-status="{{$type->status_id}}"><i class="fas fa-pen"></i></a>
                    ....

                    <!-- START MODAL AREA -->
                         <!-- start edit modal -->
                         <div id="editmodal" class="modal fade">
                              <div class="modal-dialog modal-dialog-centered">
                                   <div class="modal-content rounded-0">
                                        <div class="modal-header">
                                             <h6 class="modal-title">Edit Form</h6>
                                             <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>

                                        <div class="modal-body">
                                             <form id="formaction" action="" method="POST">
                                                  {{ csrf_field() }}
                                                  {{ method_field('PUT') }}
                                                  <div class="row align-items-end">
                                                       <div class="col-md-7">
                                                            <label for="editname">Name <span class="text-danger">*</span></label>
                                                            <input type="text" name="name" id="editname" class="form-control form-control-sm rounded-0" placeholder="Enter Status Name" value="{{ old('name') }}"/>
                                                       </div>
                                                       
                                                       <div class="col-md-3 form-group">
                                                            <label for="editstatus_id">Status</label>
                                                            <select name="status_id" id="editstatus_id" class="form-control form-control-sm rounded-0">
                                                                 @foreach($statuses as $status)
                                                                      <option value="{{$status['id']}}">{{$status['name']}}</option>
                                                                 @endforeach     
                                                            </select>
                                                       </div>
                                                       
                              
                                                       <div class="col-md-2">
                                                            <button type="submit" class="btn btn-primary btn-sm rounded-0">Update</button>
                                                       </div>
                                                  </div>
                                             </form>
                                        </div>

                                        <div class="modal-footer">

                                        </div>
                                   </div>
                              </div>
                         </div>
                         <!-- end edit modal -->
                    <!-- END MODAL AREA -->
                    ....
                    // Start Edit Form
                    $(document).on("click",".editform",function(e){
                         
                         $("#editname").val($(this).attr("data-name"));
                         $("#editstatus_id").val($(this).data("status"));
                         
                         const getid = $(this).attr("data-id");
                         $("#formaction").attr("action",`/types/${getid}`);

                         e.preventDefault();
                    });
                    // End Edit Form
               *setting select box value automatically select that value 

               =In TypesController.php
                    public function update(Request $request, string $id)
                    {
                         $this->validate($request,[
                              "name" => ["required","max:50","unique:types,name,".$id],
                              "status_id" => ["required","in:3,4"],
                         ]);

                         $user = Auth::user();
                         $user_id = $user["id"];

                         $type = Type::findOrFail($id);
                         $type->name = $request["name"];
                         $type->slug = Str::slug($request["name"]);
                         $type->status_id = $request["status_id"];
                         $type->user_id = $user_id;
                         $type->save();
                         return redirect(route("types.index"));
                    }

               *It immediately change the newly updated status.Because of php reload feature.
               *Later version will integrate switch to on/of and it doesn't update the value instantly.
               
          -----------------------------------------------------------------
          -hw
               create resources like statuses
                    city
                    country
                    gender

               php artisan make:model City -m
               php artisan make:model Country -m
               php artisan make:model Gender -m

               php artisan make:controller CitiesController -r
               php artisan make:controller CountriesController -r
               php artisan make:controller GendersController -r

               =Migration
                    up()
                         $table->string("name");
                         $table->string("slug");
                         $table->unsignedBigInteger('user_id');
               =In Model

                    protected $table = "statuses";
                    protected $primaryKey = "id";
                    protected $fillable = [
                         "name",
                         "slug",
                         "user_id"
                    ];

                    public function user(){
                         return $this->belongsTo(User::class);
                    }
          
          -hw
               category 
               tag

               (name, slug, status_id, user_id)
          ----------------------------------------------------------

     =>On/Off Switch Button 
          =Create Category & Tag as types
          
          =>Migration

               php artisan make:model Category -m
               php artisan make:model Tag -m

               =create_categories_table.php
               =create_tags_table.php
                    $table->string("name")->unique();
                    $table->string("slug");  
                    $table->unsignedBigInteger("status_id");
                    $table->unsignedBigInteger("user_id");

               php artisan make:controller TagsController -r
               php artisan make:controller CategoriesController -r

          =In categories > index.blade.php
               <td>
                    <div class="form-check form-switch">
                         <input type="checkbox" class="form-check-input" {{ $category->status_id === 3 ? "checked" : "" }} />
                    </div>
               </td>

          Tags
               WDF
               CSS Animation
               jQuery
               Bootstrap Projects
               Mysql
               Tailwind CSS
               JSON & Firebase
               ES6
               PHP
               Laravel
               React
               Node 
               Linux (Ubuntu)
               AWS

     =>Class
          
          =Migration
               php artisan make:model Post -m
               
               =crate_posts_table.php
                    $table->string("image")->nullable();
                    $table->string("title");
                    $table->string("slug");
                    $table->longText("content");
                    $table->decimal("fee",8,2)->default(0);
                    $table->date("startdate")->nullable();
                    $table->date("enddate")->nullable();
                    $table->time("starttime")->nullable();
                    $table->time("endtime")->nullable();
                    $table->unsignedBigInteger("type_id");
                    $table->unsignedBigInteger("tag_id");
                    $table->unsignedBigInteger("attshow")->default("4");
                    $table->unsignedBigInteger("status_id")->default("1");
                    $table->unsignedBigInteger("user_id");

               php artisan migrate:status
               php artisan migrate

               =In Model (Post)
                    protected $table = "posts";
                    protected $primaryKey = "id";
                    protected $fillable = [
                         "image",
                         "title",
                         "slug",
                         "content",
                         "fee",
                         "startdate",
                         "enddate",
                         "starttime",
                         "starttime",
                         "type_id",
                         "tag_id",
                         "attshow",
                         "status_id",
                         "user_id"
                    ];

                    public function user(){
                         return $this->belongsTo(User::class);
                    }

                    public function status(){
                         return $this->belongsTo(Status::class);
                    }

                    public function tag(){
                         return $this->belongsTo(Tag::class);
                    }

                    public function type(){
                         return $this->belongsTo(Type::class);
                    }

          php artisan make:controller PostsController

     
          =>Create Post (Class)
               =In PostsController.php
                    public function create()
                    {    
                         $attshows = Status::whereIn("id",[3,4])->get();
                         $statuses = Status::whereIn("id",[7,10,11])->get();
                         $tags = Tag::where("status_id",3)->get();
                         $types = Type::whereIn("id",[1,2])->get();

                         return view("posts.create",compact("attshows","statuses","tags","types"));
                    }
                    *attshows for whether to show or not to show this class in attendance form - on/off (it is the borrowed property from the statuses)
                    *statuses for visibility of this class (private/public/member only)
                    *tags for the course of this class to filter the classes with the course name
                    *types for the kind of this class (free or paid)

               =In create.blade.php
                    ....
                    <div class="col-md-6">
                         <label for="type_id">Type <span class="text-danger">*</span></label>
                         <select name="type_id" id="type_id" class="form-control form-control-sm rounded-0">
                              @foreach($types as $type)
                                   <option value="{{$type->id}}">{{ $type->name }}</option>
                              @endforeach
                         </select>
                    </div>

                    <div class="col-md-6 mb-3">
                         <label for="fee">Fee <span class="text-danger">*</span></label>
                         <input type="number" name="fee" id="fee" class="form-control form-control-sm rounded-0" placeholder="Class Fee" value="{{ old('fee') }}"/>
                    </div>

                    <div class="col-md-12 mb-3">
                         <label for="content">Content <span class="text-danger">*</span></label>
                         <textarea name="content" id="content" class="form-control form-control-sm rounded-0" rows="5" placeholder="Say Something....">{{ old('content') }}</textarea>
                    </div>

                    <div class="col-md-3">
                         <label for="tag_id">Type <span class="text-danger">*</span></label>
                         <select name="tag_id" id="tag_id" class="form-control form-control-sm rounded-0">
                              @foreach($tags as $tag)
                                   <option value="{{$tag->id}}">{{ $tag->name }}</option>
                              @endforeach
                         </select>
                    </div>

                    <div class="col-md-3">
                         <label for="attshow">Show on Att Form <span class="text-danger">*</span></label>
                         <select name="attshow" id="attshow" class="form-control form-control-sm rounded-0">
                              @foreach($attshows as $attshow)
                                   <option value="{{$attshow->id}}">{{ $attshow->name }}</option>
                              @endforeach
                         </select>
                    </div>

                    <div class="col-md-3">
                         <label for="name">Status <span class="text-danger">*</span></label>
                         <select type="text" name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                              @foreach($statuses as $status)
                                   <option value="{{$status->id}}">{{ $status->name }}</option>
                              @endforeach
                         </select>
                    </div>
                    ....

               =>Hide File Input  
                    =In create.blade.php     
                    <div class="row">
                         <div class="col-md-12 mb-3">
                              <label for="image" class="gallery"><span>Choose Images</span></label>
                              <input type="file" name="image" id="image" class="form-control form-control-sm rounded-0" value="{{ old('image')}}" hidden/>
                         </div>

                         <div class="col-md-6 mb-3">
                              <label for="startdate">Start Date <span class="text-danger">*</span></label>
                              <input type="date" name="startdate" id="startdate" class="form-control form-control-sm rounded-0" value="{{ old('startdate') }}"/>
                         </div>

                         <div class="col-md-6 mb-3">
                              <label for="enddate">End Date <span class="text-danger">*</span></label>
                              <input type="date" name="enddate" id="enddate" class="form-control form-control-sm rounded-0" value="{{ old('enddate') }}"/>
                         </div>

                         <div class="col-md-6 mb-3">
                              <label for="starttime">Start Time <span class="text-danger">*</span></label>
                              <input type="time" name="starttime" id="starttime" class="form-control form-control-sm rounded-0" value="{{ old('starttime') }}"/>
                         </div>

                         <div class="col-md-6 mb-3">
                              <label for="endtime">End Time <span class="text-danger">*</span></label>
                              <input type="time" name="endtime" id="endtime" class="form-control form-control-sm rounded-0" value="{{ old('endtime') }}"/>
                         </div>
                    </div>

          =>Store Post 
               =In PostsController.php
                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "image" => "image|mimes:jpg,jpeg,png|max:1024",
                              "title" => "required|max:50|unique:posts,title",
                              "content" => "required",
                              "fee" => "required",
                              "startdate" => "required",
                              "enddate" => "required",
                              "starttime" => "required",
                              "endtime" => "required",
                              "type_id" => "required|in:1,2",
                              "tag_id" => "required",
                              "attshow" => "required|in:3,4",
                              "status_id" => "required|in:7,10,11",   
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $post = new Post();
                         $post->title = $request["title"];
                         $post->slug = Str::slug($request["name"]);
                         $post->content = $request["content"];
                         $post->fee = $request["fee"];
                         $post->startdate = $request["startdate"];
                         $post->enddate = $request["enddate"];
                         $post->starttime = $request["starttime"];
                         $post->endtime = $request["endtime"];
                         $post->type_id = $request["type_id"];
                         $post->tag_id = $request["tag_id"];
                         $post->attshow = $request["attshow"];
                         $post->status_id = $request["status_id"];
                         $post->user_id = $user_id;

                         // Single Image Upload
                         if(file_exists($request["image"])){
                              $file = $request["image"];
                              $fname = $file->getClientOriginalName();
                              $imagenewname = uniqid($user_id).$post['id'].$fname;
                              // $file->move(public_path("posts/img"),$imagenewname);
                              $file->move(public_path("assets/img/posts"),$imagenewname);
                              
                              $filepath = "assets/img/posts/".$imagenewname;
                              $post->image = $filepath;
                         }    

                         $post->save();
                         return redirect(route("posts.index"));
                    }

          =>List All Posts
               
               =>Joining Customize Foriegn Key name

                    =In PostsController.php
                         public function attstatus(){
                                        // related, foreignKey
                              return $this->belongsTo(Status::class,"attshow");
                                                       // related, foreignKey, ownerKey
                              // return $this->belongsTo(Status::class,"attshow","id");
                         }

                         
                         public function type(){
                                                            // related
                              // return $this->belongsTo(Type::class);
                                                            // related, foreignKey
                              // return $this->belongsTo(Type::class,"type_id");
                                                       // related, foreignKey, ownerKey
                              return $this->belongsTo(Type::class,"type_id","id");

                         }
                    
                    *laravel automatically recognize foreign key name by the naming convention rule of 'basetable_column'
                    *Customize foreign key name require additional parameter to pass.
                    *$this->belongsTo(relatedtable,foreignkey,primarykey);

                    =In index.blade.php
                         @foreach($posts as $idx=>$post)
                              <tr>
                                   <td>{{++$idx}}</td>
                                   <td><img src="{{ asset($post->image) }}" class="rounded-circle" alt="{{$post->title}}" width="20" height="20"/> <a href="{{route('posts.show',$post->id)}}">{{ Str::limit($post->title,20) }}</a></td>
                                   <td>{{ $post->startdate }}</td>
                                   <td>{{ $post->enddate }}</td>
                                   <td>{{ $post->starttime }}</td>
                                   <td>{{ $post->endtime }}</td>
                                   <td>{{ $post->fee }}</td>
                                   <td>{{ $post->type->name }}</td>
                                   <td>{{ $post->tag->name }}</td>
                                   <td>{{ $post->attstatus["name"] }}</td>
                                   <td>{{ $post->status["name"] }}</td>
                                   <td>{{ $post->user["name"] }}</td>
                                   <td>{{ $post->created_at->format('d M Y') }}</td>
                                   <td>{{ $post->updated_at->format('d M Y') }}</td>
                                   <td>
                                        <a href="{{ route('posts.edit',$post->id) }}" class="text-info"><i class="fas fa-pen"></i></a>
                                        <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a>
                                   </td>
                                   <form id="formdelete-{{ $idx }}" class="" action="{{route('posts.destroy',$post->id)}}" method="POST">
                                        @csrf
                                        @method("DELETE")
                                   </form>
                              </tr>
                              @endforeach
                    =>Be Careful
                         column name = method name
                         *Error

                         <td>{{ $post->attshow["name"] }}</td>

                          public function attstatus(){
                              return $this->belongsTo(Status::class,"attshow");
                         }

          =>Edit Post
               =In PostsController.php
                    public function edit(string $id)
                    {

                         $post = Post::findOrFail($id);
                         $attshows = Status::whereIn("id",[3,4])->get();
                         $statuses = Status::whereIn("id",[7,10,11])->get();
                         $tags = Tag::where("status_id",3)->get();
                         $types = Type::whereIn("id",[1,2])->get();

                         return view("posts.edit")->with("post",$post)->with("attshows",$attshows)->with("statuses",$statuses)->with("tags",$tags)->with("types",$types);
                    }

               =In edit.blade.php
                    <div class="col-md-12 mb-3">
                         <label for="title">Title <span class="text-danger">*</span></label>
                         <input type="text" name="title" id="title" class="form-control form-control-sm rounded-0" placeholder="Enter Post Title" value="{{ $post->title }}"/>
                    </div>

                    <div class="col-md-6">
                         <label for="type_id">Type <span class="text-danger">*</span></label>
                         <select name="type_id" id="type_id" class="form-control form-control-sm rounded-0">
                              @foreach($types as $type)
                                   <option value="{{$type->id}}"
                                        @if($type["id"] === $post["type_id"])
                                             selected
                                        @endif
                                   >{{ $type->name }}</option>
                              @endforeach
                         </select>
                    </div>

                    <div class="col-md-6 mb-3">
                         <label for="fee">Fee <span class="text-danger">*</span></label>
                         <input type="number" name="fee" id="fee" class="form-control form-control-sm rounded-0" placeholder="Class Fee" value="{{ $post->fee }}"/>
                    </div>

                    <div class="col-md-12 mb-3">
                         <label for="content">Content <span class="text-danger">*</span></label>
                         <textarea name="content" id="content" class="form-control form-control-sm rounded-0" rows="5" placeholder="Say Something....">{{$post->content}}</textarea>
                    </div>

                    <div class="col-md-3">
                         <label for="tag_id">Type <span class="text-danger">*</span></label>
                         <select name="tag_id" id="tag_id" class="form-control form-control-sm rounded-0">
                              @foreach($tags as $tag)
                                   <option value="{{$tag->id}}"
                                        @if($tag->id === $post["tag_id"])
                                             selected
                                        @endif
                                   >{{ $tag->name }}</option>
                              @endforeach
                         </select>
                    </div>

                    <div class="col-md-3">
                         <label for="attshow">Show on Att Form <span class="text-danger">*</span></label>
                         <select name="attshow" id="attshow" class="form-control form-control-sm rounded-0">
                              @foreach($attshows as $attshow)
                                   <option value="{{$attshow->id}}"
                                        @if($attshow["id"] === $post["attshow"])
                                             selected
                                        @endif
                                   >{{ $attshow->name }}</option>
                              @endforeach
                         </select>
                    </div>

                    <div class="col-md-3">
                         <label for="name">Status <span class="text-danger">*</span></label>
                         <select type="text" name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                              @foreach($statuses as $status)
                                   <option value="{{$status->id}}" {{ ($status->id === $post->status_id) ? "selected" : "" }} >{{ $status->name }}</option>
                              @endforeach
                         </select>
                    </div>

               *Ternary Operator Condition Checking

               =>Old New Image Show
                    =In edit.blade.php
                         <div class="row">
                              <div class="col-md-6 text-sm-center">
                                   <img src="{{asset($post->image)}}" width="200" alt="{{$post->title}}"/>
                              </div>
                              <div class="col-md-6">
                                   <label for="image" class="gallery"><span>Choose Images</span></label>
                                   <input type="file" name="image" id="image" class="form-control form-control-sm rounded-0" value="{{ $post->image }}" hidden/>
                              </div>
                         </div>

          =>Update Post
               =In PostsController.php
                    public function update(Request $request, string $id)
                    {
                         $this->validate($request,[
                              "image" => "image|mimes:jpg,jpeg,png|max:1024",
                              "title" => "required|max:50|unique:posts,title,".$id,
                              "content" => "required",
                              "fee" => "required",
                              "startdate" => "required",
                              "enddate" => "required",
                              "starttime" => "required",
                              "endtime" => "required",
                              "type_id" => "required|in:1,2",
                              "tag_id" => "required",
                              "attshow" => "required|in:3,4",
                              "status_id" => "required|in:7,10,11",   
                         ]);

                         $user = Auth::user();
                         $user_id = $user["id"];

                         $post = Post::findOrFail($id);
                         $post->title = $request["title"];
                         $post->slug = Str::slug($request["name"]);
                         $post->content = $request["content"];
                         $post->fee = $request["fee"];
                         $post->startdate = $request["startdate"];
                         $post->enddate = $request["enddate"];
                         $post->starttime = $request["starttime"];
                         $post->endtime = $request["endtime"];
                         $post->type_id = $request["type_id"];
                         $post->tag_id = $request["tag_id"];
                         $post->attshow = $request["attshow"];
                         $post->status_id = $request["status_id"];
                         $post->user_id = $user_id;


                         // Remove Old Image
                         if($request->hasFile("image")){
                              $path = $post->image;

                              if(File::exists($path)){
                                   File::delete($path);
                              }
                         }

                         // Single Image Update
                         if($request->hasFile("image")){
                              $file = $request->file("image");
                              $fname = $file->getClientOriginalName();
                              $imagenewname = uniqid($user_id).$post['id'].$fname;
                              $file->move(public_path("assets/img/posts"),$imagenewname);
                              
                              $filepath = "assets/img/posts/".$imagenewname;
                              $post->image = $filepath;
                         }    

                         $post->save();
                         return redirect(route("posts.index"));
                    }

          =>Delete Post
               =In PostsController.php  
                    public function destroy(string $id)
                    {
                         $post = Post::findOrFail($id);
                         
                         // Remove Old Image
                         $path = $post->image;
                         if(File::exists($path)){
                              File::delete($path);
                         }
                         
                         $post->delete();
                         return redirect()->back();
                    }

          =>Show Post
               =In PostsController.php
                    public function show(string $id)
                    {
                         $post = Post::findOrFail($id);
                         return view("posts.show",["post"=>$post]);
                    }
               =In show.blade.php
                    <div class="col-md-6">
                         <i class="fas fa-user fa-sm"></i> <span>{{$post["tag"]["name"]}}</span>
                         <br/>
                         <i class="fas fa-user fa-sm"></i> <span>{{$post["type"]["name"]}} : {{$post->fee}} </span>
                         <br/>
                         <i class="fas fa-user fa-sm"></i> <span>{{$post["user"]["name"]}}</span>
                    </div>
                    <div class="col-md-6">
                         <i class="fas fa-file fa-sm"></i> <span>{{$post["attstatus"]["name"]}}</span>
                         <br/>
                         <i class="fas fa-calendar-alt fa-sm"></i> <span>{{date('d M Y',strtotime($post->created_at))}} | {{date('h:i:s A',strtotime($post->created_at))}}</span>
                         <br/>
                         <i class="fas fa-edit fa-sm"></i> <span>{{date('d M Y h:i:s A',strtotime($post->updated_at))}}</span>
                    </div>
               
          =>Commenting Feature
               =Migration
                    php artisan make:model Comment -m

                    =create_comments_table.php
                         $table->text("description");
                         $table->unsignedBigInteger("user_id");
                         $table->unsignedBigInteger("commentable_id");
                         $table->string("commentable_type");

                    php artisan migrate:status
                    php artisan migrate
               
               =In Model (Comment.php)

                    protected $table = "comments";
                    protected $primaryKey = "id";
                    protected $fillable = [
                         "description",
                         "user_id",
                         "commentable_id",
                         "commentable_type"
                    ];

                    public function user(){
                         return $this->belongsTo(User::class);
                    }
                    
               php artisan make:controller CommentsController

               =In CommentsController.php
                    public function store(Request $request)
                    {

                         $user = Auth::user();
                         $user_id = $user->id;

                         Comment::create([
                              "description"=>$request["description"],
                              "user_id"=>$user_id,
                              "commentable_id"=>$request["commentable_id"],
                              "commentable_type"=>$request["commentable_type"],
                         ]);
                         return redirect()->back();
                    }

               =In show.blade.php
                    <form action="{{route('comments.store')}}" method="POST">
                         @csrf
                         <div class="col-md-12 d-flex justify-between">
                              <textarea name="description" id="description"  class="form-control border-0 rounded-0" rows="1" style="resize:none;" placeholder="Comment here...."></textarea>
                              <button type="submit" class="btn btn-info btn-sm text-light ms-3"><i class="fas fa-paper-plane"></i></button>
                         </div>

                         <!-- Start Hidden Fields -->
                         <input type="hidden" name="commentable_id" id="commentable_id" value="{{$post->id}}" />
                         <input type="hidden" name="commentable_type" id="commentable_type" value="App\Models\Post" />
                         <!-- Start Hidden Fields -->

                    </form>

                    *commentable_id, commentable_type is passed as hidden field.
                         -user don't need to manually choose this fields
                         -it must be filled by the system

               =In Web 
                    Route::resource("comments",CommentsController::class);

               =>Showing others related comments
                    =In Model (Comments)
                         public function commentable(){
                              return $this->morphTo();
                         }
                    =In Model (Post, User)
                         public function comments(){
                              return $this->morphMany(Comment::class,"commentable");
                         }
                    
                    =In PostsController.php
                         public function show(string $id)
                         {
                              $post = Post::findOrFail($id);
                              // $comments = Comment::where("commentable_id",$post->id)->where("commentable_type","App\Models\Posts")->orderBy("created_at","desc")->get();
                              $comments = $post->comments()->orderBy("updated_at","desc")->get();
                              return view("posts.show",["post"=>$post,"comments"=>$comments]);
                         }
                         
                         *Simple comments retrieve must check "commentable_id" and "commenetable_type"   
                         *Relationship retrieve no need to to check commentable columns
                         *latest comments reach at the top with orderBy()

                    =In show.blade.php
                         <ul class="list-group chat-boxs">
                              @foreach($comments as $comment)
                                   <li class="list-group-item mt-2">
                                        <div>
                                             <p>{{$comment->description}}</p>
                                        </div>
                                        <div>
                                             <span class="small fw-bold  float-end">{{$comment->user["name"] }} | {{$comment->created_at->diffForHumans()}}</span>
                                             
                                        </div>
                                        
                                   </li>
                              @endforeach
                         </ul>

                         ....
                         @section("css")
                              <style type="text/css">
                                   .chat-boxs{
                                        height: 200px;
                                        overflow-y : scroll;
                                   }
                              </style>     

                         @endsection

                         *show comment details 
                         *human readable date formate changing
                         *add scroll bar for many comments

               =>No Comments 
                    -To show There is no comments for this post.

                    *error (syntax error, unexpected token "endforeach", expecting "elseif" or "else" or "endif")
                    =>In posts > show.blade.php 
                          @foreach($comments as $comment)
                              <li class="list-group-item mt-2">
                                   <div>
                                        <p>{{$comment->description}}</p>
                                   </div>
                                   <div>
                                        <span class="small fw-bold  float-end">{{$comment->user["name"] }} | {{$comment->created_at->diffForHumans()}}</span>
                                        
                                   </div>
                                   
                              </li>
                              @empty
                              <li class="list-group-item mt-2">No Comments Found</li>
                         @endforeach

                    =>In posts > show.blade.php 
                          @forelse($comments as $comment)
                              <li class="list-group-item mt-2">
                                   <div>
                                        <p>{{$comment->description}}</p>
                                   </div>
                                   <div>
                                        <span class="small fw-bold  float-end">{{$comment->user["name"] }} | {{$comment->created_at->diffForHumans()}}</span>
                                        
                                   </div>
                                   
                              </li>
                              @empty
                              <li class="list-group-item mt-2">No Comments Found</li>
                         @endforelse
                         *It has the option to display if there is no items.

          =>Class Days
               php artisan make:controller DaysController

               =>Migration
                    php artisan make:model Day -m              

                    =create_days_table.php
                         $table->string("name")->unique();
                         $table->string("slug");
                         $table->unsignedBigInteger("status_id");
                         $table->unsignedBigInteger("user_id");
                    
                    php artisan migrate:status
                    php artisan migrate
               
               =>In Web
                    Route::resource("days",DaysController::class);
               Days
                    Sunday
                    Monday
                    Tuesday
                    Wednesday
                    Thursday
                    Friday
                    Saturday

               =>Create Modal    
                    =In categories > index.blade.php
                         <a href="#createmodal" class="btn btn-primary btn-sm rounded-0" data-bs-toggle="modal">Create</a>

                         <!-- start create modal -->
                              <div id="createmodal" class="modal fade">
                                   <div class="modal-dialog modal-dialog-centered">
                                        <div class="modal-content rounded-0">
                                             <div class="modal-header">
                                                  <h6 class="modal-title">Create Form</h6>
                                                  <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                             </div>

                                             <div class="modal-body">
                                                  <form id="{{route('categories.store')}}" action="" method="POST">
                                                       {{ csrf_field() }}
                                                       <div class="row align-items-end">
                                                            <div class="col-md-7">
                                                                 <label for="name">Name <span class="text-danger">*</span></label>
                                                                 <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Status Name" value="{{ old('name') }}"/>
                                                            </div>
                                                            
                                                            <div class="col-md-3 form-group">
                                                                 <label for="status_id">Status</label>
                                                                 <select name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                                                                      @foreach($statuses as $status)
                                                                           <option value="{{$status['id']}}">{{$status['name']}}</option>
                                                                      @endforeach     
                                                                 </select>
                                                            </div>
                                                            
                                   
                                                            <div class="col-md-2">
                                                                 <button type="submit" class="btn btn-primary btn-sm rounded-0">Submit</button>
                                                            </div>
                                                       </div>
                                                  </form>
                                             </div>

                                             <div class="modal-footer">

                                             </div>
                                        </div>
                                   </div>
                              </div>
                         <!-- end create modal -->

                         *data-bs-target="" don't need to set for <a> tag 
                         because <a> tag include href="" for target element

               =>Days in Create Post
                    =In PostsController.php
                         public function create()
                         {    
                              $attshows = Status::whereIn("id",[3,4])->get();
                              $days = Day::where("status_id",3)->get();
                              $statuses = Status::whereIn("id",[7,10,11])->get();
                              $tags = Tag::where("status_id",3)->get();
                              $types = Type::whereIn("id",[1,2])->get();

                              return view("posts.create",compact("attshows","days","statuses","tags","types"));
                         }
                    =In posts > create.blade.php
                         <div class="col-md-12 for-group">
                              <label for="">Days</label>
                              <div class="d-flex flex-wrap">
                                   @foreach($days as $idx=>$day)
                                        <div class="form-check form-switch mx-3">
                                             <input type="checkbox" name="day_id[]" id="day_id{{$idx}}" class="form-check-input" value="{{$day->id}}" checked/> <label for="day_id{{$idx}}">{{$day->name}}</label>
                                        </div>
                                   @endforeach
                              </div>
                         </div>

               =>Days of Post Storing method
                    Method 1
                         -days are stored at "posts" table
                              by adding 7 columns  
                         -these columns type are boolean
                    Method 2
                         -days are stored at "posts" table
                              by adding only 1 column  

                         -That column will be JSON format

                    Method 3
                         Many to Many
                         dayable
                         id post_id day_id

               =>Days of Post Store With (Polymorphic Many to Many)                              
                    =Migration
                         php artisan make:model Dayable -m
                         
                         =create_dayables_table.php
                              $table->integer("day_id");
                              $table->integer("dayable_id");
                              $table->string("dayable_type");
                         *id, and timestamps are dropped at this time.

                         php artisan migrate:status
                         php artisan migrate
                    
                    =In Model (Day)
                         protected $table = "dayables";
                         protected $fillable = [
                              "day_id",
                              "dayable_id",
                              "dayable_type"
                         ];
                    
                    =In PostsController.php
                         $post->save();

     
                         if($post->id){
                              // dd($request["day_id"]);

                              // create dayable
                              // Method 1
                              // if(count($request["day_id"]) > 0){
                                   
                              //     foreach($request["day_id"] as $key=>$value){
                              //         Dayable::create([
                              //             // "day_id"=>$request["day_id"][$key],
                              //             "day_id"=>$value,
                              //             "dayable_id"=>$post->id,
                              //             "dayable_type"=>$request["dayable_type"]
                              //         ]);
                              //     }
                              // }

                              // Methd 2
                              if(count($request["day_id"]) > 0){
                                             
                                   foreach($request["day_id"] as $key=>$value){
                                        $day = [
                                        // "day_id"=>$request["day_id"][$key],
                                        "day_id"=>$value,
                                        "dayable_id"=>$post["id"],
                                        "dayable_type"=>$request["dayable_type"]
                                        ];
                                        Dayable::insert($day);
                                   }
                              }

                         }
                         

                         *store days after saving post.
                         *Successfully saved post id is already generated. It is ready for use.
                         
                         *day_id is given as array. This array need to iterate a looping.
                              array:7 [
                              0 => "1"
                              1 => "2"
                              2 => "3"
                              3 => "4"
                              4 => "5"
                              5 => "6"
                              6 => "7"
                              ]
                              -only the checked days are in the arrays.
                         
                         *dayable_type can be written directly at the Controller because it is only for the post.
                              In CommentController, it can not be written directly and given from the form.

                    =In create.blade.php
                         <!-- start hidden field -->
                                   <input type="hidden" name="dayable_type" id="dayable_type" value="App\Models\Post" />
                         <!-- end hidden field -->
                    
                    *error(Unknown column 'updated_at' in 'field list')
                         timestamps() are dropped at the migrations. Laravel automatically insert these columns.
                    
                    =In Model Dayable.php
                         protected $timestamps = false;

                    *error (Access level to App\Models\Dayable::$timestamps must be public)
                         public $timestamps = false;
                    
                    *while error occur, new post is successfully saved to the posts table. becausse these errors occur after saving post.

                    *after inserting a post, days related to this post is stored in dayable table.
                    "dayables"
                    day_id    dayable_id     dayable_type
                    2         18             App\Model\Post
                    4         18   
                    6         18

               =>Days in Edit Post
                    =In Model (Post.php)
                         public function days(){
                              return $this->morphToMany(Day::class,"dayable");
                         }
                    
                    =In Model (Day.php)
                         public function posts(){
                              return $this->morphedByMany(Post::class,"dayable");
                         }

                    =In PostsController.php
                         public function edit(string $id)
                         {

                              $post = Post::findOrFail($id);
                              // dd($post); // Post object
                              $days = Day::where("status_id",3)->get();
                              $dayables = $post->days()->get();
                              // dd($dayables); // Day object
                              $attshows = Status::whereIn("id",[3,4])->get();
                              $statuses = Status::whereIn("id",[7,10,11])->get();
                              $tags = Tag::where("status_id",3)->get();
                              $types = Type::whereIn("id",[1,2])->get();

                              return view("posts.edit")->with("post",$post)->with("attshows",$attshows)->with("days",$days)->with("dayables",$dayables)->with("statuses",$statuses)->with("tags",$tags)->with("types",$types);
                         }
                         *Query laravel executing in background (study from error)
                              select `days`.*, `dayables`.`dayable_id` as `pivot_dayable_id`, `dayables`.`dayable_type` as `pivot_dayable_type` from `days` inner join `dayables` on `days`.`id` = `dayables`.`dayable_id` where `dayables`.`dayable_id` = 18 and `dayables`.`dayable_type` = App\Models\Post
                         *$dayables get the relative days with the post
                         *not working
                              @if($dayable['day_id'] === $day['id'])
                              -because it is retrieved from dummy table and not from regular table.
                         *Regular Post Object
                              App\Models\Post {#1411 ▼ // app\Http\Controllers\PostsController.php:137
                              #connection: "mysql"
                              #table: "posts"
                              #primaryKey: "id"
                              ....
                              #original: array:17 [
                                   "id" => 18
                                   "image" => null
                                   "title" => "React Js Batch 10"
                                   "slug" => ""
                                   "content" => "hello sir"
                                   "fee" => "90000.00"
                                   "startdate" => "2023-12-22"
                                   "enddate" => "2024-01-30"
                                   "starttime" => "06:17:00"
                                   "endtime" => "08:20:00"
                                   "type_id" => 1
                                   "tag_id" => 11
                                   "attshow" => 3
                                   "status_id" => 7
                                   "user_id" => 1
                                   "created_at" => "2024-01-14 17:18:36"
                                   "updated_at" => "2024-01-14 17:18:36"
                              ]

                         *Eloquent Collection Object
                              Illuminate\Database\Eloquent\Collection {#1415 ▼ // app\Http\Controllers\PostsController.php:140
                                   #items: array:3 [▼
                                   0 => App\Models\Day {#1404 ▼
                                        #connection: "mysql"
                                        #table: "days"
                                        #primaryKey: "id"
                                        ....
                                        #original: array:10 [▼
                                        "id" => 2
                                        "name" => "Monday"
                                        "slug" => "monday"
                                        "status_id" => 3
                                        "user_id" => 1
                                        "created_at" => "2024-01-13 15:27:05"
                                        "updated_at" => "2024-01-13 15:27:05"
                                        "pivot_dayable_id" => 18
                                        "pivot_day_id" => 2
                                        "pivot_dayable_type" => "App\Models\Post"
                                        ]
                                        ....
                                   }
                                   1 => App\Models\Day {#1427 ▶}
                                   2 => App\Models\Day {#1430 ▶}
                                   ]
                                   #escapeWhenCastingToString: false
                              }
                              *Dummy table columlns can be retrived with keyword pivot
                         
                         -it is essential to check 'original'
                         
                         *not working
                              @if($dayable['pivot_day_id'] === $day['id'])
                              -it has specific method to retrieve pivot.

                    =In posts > edit.blade.php
                         @foreach($days as $idx=>$day)
                              <div class="form-check form-switch mx-3">
                                   <input type="checkbox" name="day_id[]" id="day_id{{$idx}}" class="form-check-input" value="{{$day->id}}" 
                                        @foreach($dayables as $dayable)
                                             @if($dayable['id'] === $day['id'])
                                                  checked
                                             @endif
                                        @endforeach
                                   /> 
                                   <label for="day_id{{$idx}}">{{$day->name}}</label>
                              </div>
                         @endforeach

               =>Days in Show Post
                    =In PostsController.php
                         public function show(string $id)
                         {
                              $post = Post::findOrFail($id);
                              // $comments = Comment::where("commentable_id",$post->id)->where("commentable_type","App\Models\Posts")->orderBy("created_at","desc")->get();
                              $comments = $post->comments()->orderBy("updated_at","desc")->get();
                              $dayables = $post->days()->get();
                              return view("posts.show",["post"=>$post,"comments"=>$comments,"dayables"=>$dayables]);
                         }
                    =In posts > show.blade.php
                         <div class="col-md-6">
                              <i class="fas fa-calendar fa-sm"></i>
                              <span>
                                   @foreach($dayables as $dayable)
                                             {{$dayable["name"]}}, 
                                   @endforeach
                              </span>
                         </div>

               =>Days of Post Update
                    three condition
                    -remove existing days
                    -add days
                    -add and remove days

                    =My own method 1
                         $post->save();

                         if($request["day_id"] > 0){
                              // dd($request["day_id"]);
                              $post->days()->sync($request["day_id"]);
                         }else{
                              $post->days()->detach();
                         }

                    =Chingu method
                         if(count($request["day_id"] > 0)){
                              $post->days()->detach();

                              foreach($request["day_id"] as $key=>$value){
                                   Dayable::create([
                                   "day_id"=>$value,
                                   "dayable_id"=>$post->id,
                                   "dayable_type"=>$request["dayable_type"]
                                   ]);
                              }
                         }

                         *error - when no date is specified.
                              -at code of condition, count()
                         
                              
                         *code operation
                              firstly remove all days related with the post
                              lastly add the selected days for the post
                              at "dayable" table
                              -before edit
                                   day_id    dayable_id
                                   1         1
                                   1         2
                                   2         2
                              -after edit (adding another day for post one)
                                   day_id    dayable_id
                                   1         2
                                   2         2
                                   1         1
                                   4         1
                    
                    =My own method 2
                         $post->save();
                         
                         $post->days()->detach();
                         if(!empty($request["day_id"])){
                              foreach($request["day_id"] as $key=>$value){
                                   Dayable::create([
                                   "day_id"=>$value,
                                   "dayable_id"=>$post->id,
                                   "dayable_type"=>$request["dayable_type"]
                                   ]);
                              }
                         }
                         
                         
                    =With JS method
                         =In posts > edit.blade.php
                              @foreach($days as $idx=>$day)
                                   <div class="form-check form-switch mx-3">
                                        <input type="checkbox" name="day_id[]" id="day_id{{$idx}}" class="form-check-input dayactions" value="{{$day->id}}" 
                              ....

                              // Start Day Action
                              $(".dayactions").click(function(){
                                   var checkboxs = $("input[type='checkbox']");
                                   // console.log(checkboxs);
                                   
                                   var checked = checkboxs.filter(":checked").map(function(){
                                        // return this.value;
                                        $(this).attr("name","newday_id[]");
                                   });

                                   var unchecked = checkboxs.not(":checked").map(function(uncheck){
                                        // return this.value;
                                        $(this).attr("name","oldday_id[]");
                                        
                                        // console.log(uncheck);
                                   });

                                   // check or uncheck
                                   // if($(this).prop('checked')){
                                   //      // console.log("yes");
                                   //      console.log("checked");
                                   // }else{
                                   //      // console.log("no");
                                   //      console.log("unchecked");
                                   // }
                              });
                              // End Day Action
                              
                         *seperate the days into the group of checked and unchecked.
                         -checked group = newday_id
                         -unchecked group = oldday_id

                         =In PostsController.php
                               $post->save();
                              
                              // Start Day Action
                              // dd($request["newday_id"]); // null ,or [1 3 5]
                              
                                   if(isset($request["newday_id"])){
                                        // remove all day first
                                        foreach($request["newday_id"] as $key=>$value){
                                             $dayable = Dayable::where("dayable_id",$post["id"])->where("dayable_type",$request["dayable_type"]);
                                             $dayable->delete();
                                        }
                                        // add renewday
                                        foreach($request["newday_id"] as $key=>$value){
                                             $day = [
                                             // "day_id"=>$request["day_id"][$key],
                                             "day_id"=>$request["newday_id"][$key],
                                             "dayable_id"=>$post["id"],
                                             "dayable_type"=>$request["dayable_type"]
                                             ];
                                             Dayable::insert($day);
                                        }
                                   }
                              // End Day Action
                              -firstly remove all days related with the post
                              -lastly add the new days for the post
                              *no error but not working - when no date is specified.
                              
                              -problem solved
                                   if(isset($request["newday_id"]) || isset($request["oldday_id"])){
                                        // remove all days
                                        if(!empty($request["newday_id"])){
                                             
                                             // add new days
                                        }
                                   }


     =>Attendance Form
          =Migration
          php artisan make:model Attendance -m
          
          =crate_attendances_table.php
               $table->date("classdate");
               $table->unsignedBigInteger("post_id");
               $table->string("attcode");    
               $table->unsignedBigInteger("user_id");        
               

          php artisan migrate:status
          php artisan migrate

          php artisan make:controller AttendancesController

          =In Model (Attendance.php)
               protected $table = "attendances";
               protected $primaryKey = "id";
               protected $fillable = [
                    "classdate",
                    "post_id",
                    "attcode",
                    "user_id"
               ];

               public function post(){
                    return $this->belongsTo(Post::class);
               }

               public function user(){
                    return $this->belongsTo(User::class);
               }

          =>Create/Store Attendance + index

               =In AttendancesController.php
                    public function index()
                    {
                         $attendances = Attendance::all();
                         // $posts = Post::where("attshow",3)->get();
                         $posts = DB::table("posts")->where("attshow",3)->orderBy("title","asc")->get();
                         return view("attendances.index",compact("attendances","posts"));
                    }

                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "classdate" => "required|date",
                              "post_id" => "required",
                              "attcode" => "required"
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $attendance = new attendance();
                         $attendance->classdate = $request["classdate"];
                         $attendance->post_id = $request["post_id"];
                         $attendance->attcode = $request["attcode"];
                         $attendance->user_id = $user_id;
                         
                         $attendance->save();
                         return redirect(route("attendances.index"));
                    }
               
               =In index.blade.php
                    <form action="{{route('attendances.store')}}" method="POST">
                         {{ csrf_field() }}

                         <div class="row align-items-end">
                              <div class="col-md-3">
                                   <label for="classdate">Class Date <span class="text-danger">*</span></label>
                                   <input type="date" name="classdate" id="classdate" class="form-control form-control-sm rounded-0" value="{{ old('classdate') }}"/>
                              </div>

                              <div class="col-md-3">
                                   <label for="post_id">Class <span class="text-danger">*</span></label>
                                   <select name="post_id" id="post_id" class="form-control form-control-sm rounded-0">
                                        @foreach($posts as $post)
                                             {{-- <option value="{{$post['id']}}">{{$post['title']}}</option> --}}
                                             <option value="{{$post->id}}">{{$post->title}}</option> 
                                        @endforeach     
                                   </select>
                              </div>

                              <div class="col-md-3">
                                   <label for="attcode">Attendance Code <span class="text-danger">*</span></label>
                                   <input type="text" name="attcode" id="attcode" class="form-control form-control-sm rounded-0" value="{{ old('attcode') }}"/>
                              </div>

                              <div class="col-md-3">
                                   <button type="reset" class="btn btn-secondary btn-sm rounded-0">Cancel</button>
                                   <button type="submit" class="btn btn-primary btn-sm rounded-0 ms-3">Submit</button>
                              </div>
                         </div>
                    </form>
               
               ** Retrieve data with DB:: method need to be careful
                    -can only get data as object
                    -can not get data as array
                         *error (Cannot use object of type stdClass as array)

               =>List Attendances

                    =In index.blade.php
                         <table id="mytable" class="table table-sm table-hover border">
               
                              <thead>
                                   <th>No</th>
                                   <th>Class</th>
                                   <th>Att Code</th>
                                   <th>By</th>
                                   <th>Class Date</th>
                                   <th>Created At</th>
                                   <th>Updated At</th>
                                   <th>Action</th>
                              </thead>
                    
                              <tbody>
                                   @foreach($attendances as $idx=>$attendance)
                                   <tr>
                                        <td>{{++$idx}}</td>
                                        <td>{{$attendance->post["title"]}}</td>
                                        <td>{{ $attendance->attcode }}</td>
                                        <td>{{ $attendance["user"]["name"] }}</td>
                                        <td>{{ $attendance->classdate }}</td>
                                        <td>{{ $attendance->created_at->format('d M Y') }}</td>
                                        <td>{{ $attendance->updated_at->format('d M Y') }}</td>
                                        <td>
                                             <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$attendance->id}}" data-name="{{$attendance->name}}" data-status="{{$attendance->status_id}}"><i class="fas fa-pen"></i></a>
                                        </td>
                                   </tr>
                                   @endforeach
                              </tbody>
                    
                         </table>

               =>Uppercase Attendance Code 
                    =In AttendancesController.php 
                         public function store(Request $request)
                         {
                              $this->validate($request,[
                                   "classdate" => "required|date",
                                   "post_id" => "required",
                                   "attcode" => "required"
                              ]);

                              $user = Auth::user();
                              $user_id = $user->id;

                              $attendance = new attendance();
                              $attendance->classdate = $request["classdate"];
                              $attendance->post_id = $request["post_id"];
                              $attendance->attcode = Str::upper($request["attcode"]);
                              $attendance->user_id = $user_id;

                              $attendance->save();
                              session()->flash("success","Att Created");
                              return redirect(route("attendances.index"));
                         }
                    *It change case in backend. Can change code in frontend like javascript and even with css.
                    *Str::upper() support in laravel.
                         *use Illuminate\Support\Str;

          =>Edit/Update Attendance + index
               =In index.blade.php
                    ....
                    <td>
                         <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$attendance->id}}" data-post_id="{{$attendance->post_id}}" data-attcode="{{$attendance->attcode}}"><i class="fas fa-pen"></i></a>
                    </td>
                    ....
                    
                    <!-- start edit modal -->
                         <div id="editmodal" class="modal fade">
                              <div class="modal-dialog modal-dialog-centered">
                                   <div class="modal-content rounded-0">
                                        <div class="modal-header">
                                             <h6 class="modal-title">Edit Form</h6>
                                             <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>

                                        <div class="modal-body">
                                             <form id="formaction" action="" method="POST">
                                                  {{ csrf_field() }}
                                                  {{ method_field('PUT') }}
                                                  <div class="row align-items-end">
                                                       
                                                       <div class="col-md-7 form-group">
                                                            <label for="editpost_id">Class <span class="text-danger">*</span></label>
                                                            <select name="post_id" id="editpost_id" class="form-control form-control-sm rounded-0">
                                                                 @foreach($posts as $post)
                                                                      {{-- <option value="{{$post['id']}}">{{$post['title']}}</option> --}} 
                                                                      <option value="{{$post->id}}">{{$post->title}}</option> 
                                                                 @endforeach     
                                                            </select>
                                                       </div>

                                                       <div class="col-md-3">
                                                            <label for="editattcode">Att Code <span class="text-danger">*</span></label>
                                                            <input type="text" name="attcode" id="editattcode" class="form-control form-control-sm rounded-0" value="{{ old('classdate') }}"/>
                                                       </div>
                                                       
                              
                                                       <div class="col-md-2">
                                                            <button type="submit" class="btn btn-primary btn-sm rounded-0">Update</button>
                                                       </div>
                                                  </div>
                                             </form>
                                        </div>

                                        <div class="modal-footer">

                                        </div>
                                   </div>
                              </div>
                         </div>
                    <!-- end edit modal -->
                    ....
                    @section("scripts")
                         <script type="text/javascript">
                              $(document).ready(function(){
                                   // Start Edit Form
                                   $(document).on("click",".editform",function(e){
                                        
                                        $("#editpost_id").val($(this).attr("data-post_id"));
                                        $("#editattcode").val($(this).data("attcode"));
                                        
                                        const getid = $(this).attr("data-id");
                                        $("#formaction").attr("action",`/attendances/${getid}`);

                                        e.preventDefault();
                                   });
                                   // End Edit Form
                                   
                              });
                         </script>
                    @endsection
               
               =In AttendancesController.php
                    public function update(Request $request, string $id)
                    {
                         $this->validate($request,[
                              "post_id" => "required",
                              "attcode" => "required"
                         ]);

                         $user = Auth::user();
                         $user_id = $user["id"];

                         $attendance = Attendance::findOrFail($id);
                         $attendance->post_id = $request["post_id"];
                         $attendance->attcode = $request["attcode"];
                         $attendance->user_id = $user_id;
                         $attendance->save();
                         return redirect(route("attendances.index"));
                    }

               *when another modify att code, modify user id will changed
               -To solve this delete the following sentence
                    //$attendance->user_id = $user_id;
               
     =>Enrollment

          php artisan make:model Stage -m

          =Migration
               =create_stages_table.php
                    $table->string("name")->unique();
                    $table->string("slug");  
                    $table->unsignedBigInteger("status_id");
                    $table->unsignedBigInteger("user_id");

          php atisan migratel:status
          php artisan migrate

          =In Model (Stage.php)

          php artisan make:controller StagesController

          "stages"
               Approved
               Pending
               Reject
               Complete
               Incomplete
               Loading
               Processing
               Passed
               Request
               Waiting
               Verifying
               Verified

          php artisan make:model Enroll -m 

          =Migration
               =create_enrolls_table
                    $table->string("image")->nullable();
                    $table->unsignedBigInteger('post_id')->comment("new class");
                    $table->unsignedBigInteger('user_id');
                    $table->enum('stage_id',[1,2,3])->default(2)->comment("1=Approved, 2= Pending, 3=Reject");
                    $table->text("remark")->nullable();
          
               =>Column Comment
                    *comment() - to remark something for the column
                    =In phpmyadmin
                    -see at table 'Structure' Tab
                    -see at 'Browse' Tab
          
          php atisan migratel:status
          php artisan migrate

          =In Model (Enroll.php)
               protected $table = "enrolls";
               protected $primaryKey = "id";
               protected $fillable = [
                    "image",
                    "post_id",
                    "user_id",
                    "stage_id",
                    "remark"
               ];

               public function stage(){
                    return $this->belongsTo(Stage::class);
               }

               public function user(){
                    return $this->belongsTo(User::class);
               }

          =In posts > show.blade.php
               ....
               <a href="{{route('posts.index')}}" class="btn btn-secondary btn-sm rounded-0">Close</a>
               <a href="#createmodal" class="btn btn-primary btn-sm rounded-0" data-bs-toggle="modal">Enroll</a>
               ....
               <!-- START MODAL AREA -->
                    <!-- start create modal -->
                    <div id="createmodal" class="modal fade">
                         <div class="modal-dialog modal-dialog-centered">
                              <div class="modal-content rounded-0">
                                   <div class="modal-header">
                                        <h6 class="modal-title">Enroll Form</h6>
                                        <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                   </div>

                                   <div class="modal-body">
                                        <form id="" action="{{route('categories.store')}}" method="POST" enctype="multipart/form-data">
                                             {{ csrf_field() }}
                                             <div class="row align-items-end">
                                                  <div class="col-md-12 mb-3">
                                                       <label for="image" class="gallery"><span>Choose Images</span></label>
                                                       <input type="file" name="image" id="image" class="form-control form-control-sm rounded-0" value="{{ old('image')}}" hidden/>
                                                  </div>
                                                  <div class="col-md-10">
                                                       <label for="remark">Remark <span class="text-danger">*</span></label>
                                                       <textarea type="text" name="remark" id="remark" class="form-control form-control-sm rounded-0" rows="3" placeholder="Enter Remark">{{ old('remark') }}</textarea>
                                                  </div>
                                                  
                                   
                                                  <div class="col-md-2">
                                                       <button type="submit" class="btn btn-primary btn-sm rounded-0">Submit</button>
                                                  </div>

                                                  <!-- Start Hidden Fields -->
                                                  <input type="hidden" name="post_id" value="{{$post->id}}" />
                                                  <!-- Start Hidden Fields -->
                                             </div>
                                        </form>
                                   </div>

                                   <div class="modal-footer">

                                   </div>
                              </div>
                         </div>
                    </div>
                    <!-- end create modal -->
               <!-- END MODAL AREA -->
               ....
               @section("css")....
               @section("scripts")....
          *form fields data can't be received at controller if not include
               enctype="multipart/form-data" 
          =In Controller
               php artisan make:controller EnrollsController
          
          =In EnrollsController.php
               public function store(Request $request)
               {
                    $this->validate($request,[
                         "image" => "image|mimes:jpg,jpeg,png|max:1024",
                    ]);

                    $user = Auth::user();
                    $user_id = $user->id;

                    $enroll = new Enroll();
                    $enroll->post_id = $request["post_id"];
                    $enroll->remark = $request["remark"];
                    $enroll->user_id = $user_id;

                    // Single Image Upload
                    if(file_exists($request["image"])){
                         $file = $request["image"];
                         $fname = $file->getClientOriginalName();
                         $imagenewname = uniqid($user_id).$enroll['id'].$fname;
                         // $file->move(public_path("enrolls/img"),$imagenewname);
                         $file->move(public_path("assets/img/enrolls"),$imagenewname);
                         
                         $filepath = "assets/img/enrolls/".$imagenewname;
                         $enroll->image = $filepath;
                    }    

                    $enroll->save();
                    return redirect()->back();
               }

               =>Restrict One User for only One Class
                    =In Post.php
                         public function checkenroll($userid){
                              return DB::table("enrolls")->where("post_id",$this->id)->where("user_id",$userid)->exists();
                         }

                    =In PostsController.php
                         public function show(string $id)
                         {    
                              $post = Post::findOrFail($id);
                              // dd($post->checkenroll(1)); // true
                              ....
                         }
                    =In posts > show.blade.php    
                         <a href="{{route('posts.index')}}" class="btn btn-secondary btn-sm rounded-0">Close</a>
                         @if(!$post->checkenroll($userdata->id))
                              <a href="#createmodal" class="btn btn-primary btn-sm rounded-0" data-bs-toggle="modal">Enroll</a>
                         @endif;    
                         <hr/>
                    
                    *'Enroll' button is hidden for the already enrolled post.
                    *'Enroll' button appear for the the post that is not enroled yet.

                    *$userdata represent authenticated user.

                    users
                    name           email
                    --------------------
                    admin          admin@gmail.com
                    aung aung      admin@gmail.com
                    su su          susu@gmail.com
                    yu yu          yuyu@gmail.com

                    =>Log Out
                         =Inspire layouts > navigation.blade.php 
                              <!-- Authentication -->
                              <form method="POST" action="{{ route('logout') }}">
                                   @csrf

                                   <x-dropdown-link :href="route('logout')"
                                             onclick="event.preventDefault();
                                                       this.closest('form').submit();">
                                        {{ __('Log Out') }}
                                   </x-dropdown-link>
                              </form>

                         =In layouts > adminleftsidebar.blade.php
                              <!-- Start Top Sidebar -->
                              @include("layouts.adminnavbar")
                              <!-- End Top Sidebar -->

                         =In layouts > adminnavbar.blade.php
                              //move top side bar
                              <!-- Authentication -->
                               <!-- <form action="{{ route('logout')}}" method="POST" > -->
                                   <!-- @csrf -->
                                   <!-- <a href="{{ route('logout') }}" class="dropdown-item" onclick="event.preventDefault(); this.closest('form').submit();"><i class="fas fa-sign-out fa-sm text-muted me-2"></i>Logout</a> -->
                                   <!-- <a href="javascript:void(0);" class="dropdown-item" onclick="event.preventDefault(); this.parentElement.submit();"><i class="fas fa-sign-out fa-sm text-muted me-2"></i>Logout</a> -->
                              <!-- </form> -->

                              <a href="javascript:void(0);" class="dropdown-item" onclick="event.preventDefault(); document.getElementById('logoutform').submit();"><i class="fas fa-sign-out fa-sm text-muted me-2"></i>Logout</a>
                              <form id="logoutform" action="{{ route('logout') }}" method="POST" >@csrf</form>

                    "students"
                    id   regnumber      firstname      lastname,,,,        user_id
                    1    WDF1001        Admin          Bot                 1
                    2    WDF1002        Aung           Aung                2
                    3    WDF1003        Su             Su                  3
                    4    WDF1004        Yu             Yu                  4

     =>Attendance <-> Student (Student ID)
               =>My Method
                    =In Attendance.php
                         public function userstu(){
                              $student = Student::where("user_id",$this->user_id)->first();

                              // dd($student);
                              // dd($student->regnumber);
                              return $student;
                         }
                         // *retrieve with get() will get error
                    =In attendances > index.blade.php
                         ....
                         @foreach($attendances as $idx=>$attendance)
                              <tr>
                                   <td>{{++$idx}}</td>
                                   <td>{{ $attendance->userstu()->regnumber }}</td>
               
               =>Simplest Solution (don't recommend)
                    =In Attendance.php
                         public function student(){
                              return $this->belongsTo(Student::class,"user_id");
                         }
                    =In attendances > index.blade.php
                         @foreach($attendances as $idx=>$attendance)
                              <tr>
                                   <td>{{++$idx}}</td>
                                   <td>{{ $attendance->student->regnumber }}</td>

                    "students"
                    id   regnumber      firstname      lastname,,,,        user_id
                    10    WDF1001        Admin          Bot                 1

                    *error (Attempt to read property "regnumber" on null)
                    -it only work with student.id for the foreigin key of attendances.user_id.
                    -because "attendances" table do not the student id, 1 of user_id, 1 .
               
               "users"
                    id     name           email
                    10     admin          admin@gmail.com
                    20     aung aung      admin@gmail.com
                    30     su su          susu@gmail.com
                    40     yu yu          yuyu@gmail.com

               "students"
                    id   regnumber      firstname      lastname,,,,        user_id
                    1    WDF1001        Admin          Bot                 10
                    2    WDF1002        Aung           Aung                20
                    3    WDF1003        Su             Su                  30
                    4    WDF1004        Yu             Yu                  40

               "attendances"
                    id   classdate      post_id   attcode   user_id
                    1    2023-12-02     17        AB        10
                    ....
                    6    2023-12-16     16        EFG       40
               
               =>Way 1 (Foreigh Key Table)
                    "Attendance"   "User"         "Student"
                    
                    user_id        id             id
                    post_id        name           regnumber
                    attcode        email          firstname   
                                   password       lastname
                    student_id                    user_id

               =>Way 2 (Table Through)
                    Attendance -> User -> Student

                    Attendance 
                    id classdate post_id attcode user_id

                    User
                    id name email .... student_id

                    Student 
                    id   regnumber      firstname      lastname,,,,

               =Method 1
                    =In Attendance.php
                         public function student($userid){
                              
                              $students = Student::where("user_id",$userid)->get();
                              // dd($students);

                              foreach($students as $student){
                                   // dd($student);
                                   // dd($student["regnumber"]);
                                   return $student["regnumber"];
                              }
                         }

                    *result ($students) - array given
                    Illuminate\Database\Eloquent\Collection {#1431 ▼ // app\Models\Attendance.php:41
                         #items: array:1 [▼
                         0 => App\Models\Student {#1430 ▶}
                         ]
                         #escapeWhenCastingToString: false
                    }
                    
                    *result ($student) ## - destructure array
                    App\Models\Student {#1430 ▼ // app\Models\Attendance.php:44
                         #connection: "mysql"
                         #table: "students"
                         #primaryKey: "id"
                         ....
                         #original: array:10 [▼
                         "id" => 1
                         "regnumber" => "WDF1001"
                         "firstname" => "Admin"
                         "lastname" => "Boot"
                         "slug" => "adminboot"
                         "remark" => "Lorem Ipsum is simply dummy text of the printing and typesetting industry."
                         "status_id" => 1
                         "user_id" => 1
                         "created_at" => "2023-12-14 12:43:02"
                         "updated_at" => "2023-12-14 12:43:02"
                    ]

                    =In attendances > index.blade.php
                         @foreach($attendances as $idx=>$attendance)
                              <tr>
                                   <td>{{++$idx}}</td>
                                   <td>{{ $attendance->student($attendance->user_id) }}</td>
               
               =Method 2
                    =In Attendance.php
                         public function student($userid){
                              // Method 2
                              $students = Student::where("user_id",$userid)->get()->pluck("regnumber");
                              // dd($students);

                              foreach($students as $student){
                                   // dd($student); // "WDF1001"
                                   return $student;
                              }
                         }

                    *result ($students) - array given
                    Illuminate\Support\Collection {#1422 ▼ // app\Models\Attendance.php:51
                         #items: array:1 [▼
                         0 => "WDF1001"
                         ]
                         #escapeWhenCastingToString: false
                    }

               =>Attendance Order
                    =In AttendancesController.php
                         public function index()
                         {
                              $attendances = Attendance::orderBy('updated_at','desc')->get();
                              ....
                         }
                    *attendances are displayed from recent days.

     =>Text Editor Plug-in    
          'summernote'        
          https://summernote.org/getting-started/#without-bootstrap-lite

          bootstrap 4
          bootstrap 5
          *Without bootstrap
               -local link
          
          summernote > Getting Started > Download compiled
          Extract here - summernote-0.8.18-dist

          =>At Create
               =In posts > create.blade.php
                    <div class="col-md-12 mb-3">
                         <label for="content">Content <span class="text-danger">*</span></label>
                         <textarea name="content" id="content" class="form-control form-control-sm rounded-0" rows="5" placeholder="Say Something....">{{ old('content') }}</textarea>
                    </div>
                    ....

                    @section("css")
                         {{-- summernote css1 js1 --}}
                         <link href="{{ asset('assets/libs/summernote-0.8.18-dist/summernote-lite.min.css') }}" rel="stylesheet" type="text/css"/>
                         <style type="text/css">
                         ....

                    @section("scripts")
                         {{-- summernote css1 js1 --}}
                         <script src="{{ asset('assets/libs/summernote-0.8.18-dist/summernote-lite.min.js') }}" type="text/javascript"></script>
                         <script type="text/javascript">
                         ....

                              // text editor for content
                              $('#content').summernote({
                                   placeholder: 'Say Something....',
                                   tabsize: 2,
                                   height: 120,
                                   toolbar: [
                                        ['style', ['style']],
                                        ['font', ['bold', 'underline', 'clear']],
                                        ['color', ['color']],
                                        ['para', ['ul', 'ol', 'paragraph']],
                                        ['insert', ['link']],
                                   ]
                              });

               
          =>At Edit
               =link summbernote as Create 

               *Edited text will be display as format.

          =>At Show
               =http://127.0.0.1:8000/posts/19
                    *result
                    <h2 style="margin-bottom: 10px; font-family: DauphinPlain; font-size: 24px; line-height: 24px; color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">What is Lorem Ipsum?</h2><p><strong style="font-family: &quot;Open Sans&quot;, Arial, sans-serif; font-size: 14px; text-align: justify; background-color: rgb(255, 255, 255);">Lorem Ipsum</strong><span style="font-family: &quot;Open Sans&quot;, Arial, sans-serif; font-size: 14px; text-align: justify; background-color: rgb(255, 255, 255);">&nbsp;is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the <a href="https://google.com" target="_blank">1500s</a>
               "phpmyadmin" > "posts" table > 'content' column
               *html & css code are stored.

               =To interpret html and css code
                    =In posts > show.blade.php
                         <tr>
                              <!-- <td>{{-- $post->content --}}</td> -->
                              <td>{!! $post->content !!}</td>
                         </tr>
               *other editor plug-in will use {!! !!} to understand html and css code.

     =>Table Plug in
          "DataTables"
          https://datatables.net/
          *cdn

          *cause it is jQuery library, jQuery file must be linked first.

          Full Getting Started Guide > 
               Initialising DataTables

          =In Index 
               =In posts > index.blade.php
                    <table id="mytable" class="table table-sm table-hover border">
                    ....

                    @section("css")
                         <link href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
                    @endsection
                    ....

                    @section("scripts")
                    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js" type="text/javascript"></script>
                    <script type="text/javascript">
                         ....
                         // for mytable
                         //let table = new DataTable('#mytable');
                         $("#mytable").DataTable();

               *Search, Column Sorting, Pagination included
               *search bar is for all column 

          =Method 1 (JS Object)
               let table = new DataTable('#myTable', {
               // config options...
               })

          =Method 2 (jQuery)
               $(document).ready( function () {
                    $('#myTable').DataTable();
               } );

     =>Fixed footer
          =In layouts > adminfooter.php 
               <footer class="footers">
          
          =In public > dist > style.css
               .footers{
                    width:100%;

                    position:fixed;
                    right:0;
                    bottom:0;
               }
     
     =>Enroll <-> Student (Student ID)

          =Method 1, 2
                =In enrolls.index.blade.php
                    <table id="mytable" class="table table-sm table-hover border">
               
                         <thead>
                              <th>No</th>
                              <th>Class</th>
                              <th>Student Id</th>
                              <th>Stage</th>
                              <th>Created At</th>
                              <th>Updated At</th>
                              <th>Action</th>
                         </thead>
               
                         <tbody>
                              @foreach($enrolls as $idx=>$enroll)
                              <tr>
                                   <td>{{++$idx}}</td>
                                   <td>{{$enroll->post["title"]}}</td>
                                   <td>{{ $enroll->student($enroll->user_id) }}</td>
                                   <td>{{ $enroll->stage->name }}</td>
                                   <td>{{ $enroll->created_at->format('d M Y') }}</td>
                                   <td>{{ $enroll->updated_at->format('d M Y') }}</td>
                                   <td>
                                        <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$enroll->id}}" data-post_id="{{$enroll->post_id}}" data-attcode="{{$enroll->attcode}}"><i class="fas fa-pen"></i></a>
                                   </td>
                              </tr>
                              @endforeach
                         </tbody>
               
                    </table>

               =Enroll.php
                    public function student($userid){
                         
                         // Method 1
                         // $students = Student::where("user_id",$userid)->get();
                         // // dd($students);

                         // foreach($students as $student){
                         //     // dd($student);
                         //     // dd($student["regnumber"]);
                         //     return $student["regnumber"];
                         // }

                         // Method 2
                         $students = Student::where("user_id",$userid)->get()->pluck("regnumber");
                         // dd($students);

                         foreach($students as $student){
                              // dd($student); // "WDF1001"
                              return $student;
                         }

                    }
         
          =Method 3, 4
               =In enrolls > index.blade.php
                    @foreach($enrolls as $idx=>$enroll)
                         <tr>
                              <td>{{++$idx}}</td>
                              <td>{{$enroll->post["title"]}}</td>
                              {{-- <td>{{ $enroll->student($enroll->user_id) }}</td> --}}
                              <td>{{$enroll->student()}}</td>
                              <td>{{ $enroll->stage->name }}</td>
                              <td>{{ $enroll->created_at->format('d M Y') }}</td>
                              <td>{{ $enroll->updated_at->format('d M Y') }}</td>
                              <td>
                                   <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$enroll->id}}" data-post_id="{{$enroll->post_id}}" data-attcode="{{$enroll->attcode}}"><i class="fas fa-pen"></i></a>
                              </td>
                         </tr>
                    @endforeach

               =In Enroll.php
                    public function student(){

                         // Method 3
                         // $students = Student::where("user_id",$this->user_id)->get();
                         // // dd($students);

                         // foreach($students as $student){
                         //     // dd($student);
                         //     // dd($student["regnumber"]);
                         //     return $student["regnumber"];
                         // }

                         // Method 4
                         $students = Student::where("user_id",$this->user_id)->get()->pluck("regnumber");
                         // dd($students);

                         foreach($students as $student){
                              // dd($student); // "WDF1001"
                              return $student;
                         }
                    }

          =Method 5, 6
                =Enroll.php
                    public function student(){
                         
                         // Method 5
                                // join(se table,sec table prikey,compare,primary table fkkey)
                         // $students = Student::join("users","users.id","=","students.user_id")->where("user_id",$this->user_id)->get();
                         // // dd($students);

                         // foreach($students as $student){
                         //     // dd($student);
                         //     return $student["regnumber"];
                         // }

                         // Method 6
                         $students = Student::join("users","users.id","=","students.user_id")->where("user_id",$this->user_id)->get()->pluck("regnumber");
                         // dd($students);

                         foreach($students as $student){
                              // dd($student); // "WDF1001"
                              return $student;
                         }

                    }
               
               * join(sec table, primary table fkkey,compare,sec table prikey)


               *result - when freely joning two tables without conditions 
                   Illuminate\Database\Eloquent\Collection {#1452 ▼ // app\Models\Enroll.php:76
                    #items: array:4 [▼
                    0 => App\Models\Student {#1450 ▶}
                    1 => App\Models\Student {#1455 ▶}
                    2 => App\Models\Student {#1456 ▶}
                    3 => App\Models\Student {#1454 ▶}
                    ]
                    #escapeWhenCastingToString: false
                    }
               
               *result ($student) ## - destructure array (two tables columns come out)
               	
                    App\Models\Student {#1449 ▼ // app\Models\Enroll.php:79
                    #connection: "mysql"
                    #table: "students"
                    #primaryKey: "id"
                    ....
                    #original: array:15 [▼
                         "id" => 1
                         "regnumber" => "WDF1001"
                         "firstname" => "Admin"
                         "lastname" => "Boot"
                         "slug" => "adminboot"
                         "remark" => "Lorem Ipsum is simply dummy text of the printing and typesetting industry."
                         "status_id" => 1
                         "user_id" => 1
                         "created_at" => "2023-12-12 07:27:33"
                         "updated_at" => "2023-12-12 07:53:59"
                         "name" => "admin"
                         "email" => "admin@gmail.com"
                         "email_verified_at" => null
                         "password" => "$2y$12$xffXPm7kidQvS4CgU8LThuAgkEb5otckKTMpVJtuDmrwFsmVApqh6"
                         "remember_token" => "4o4q9tTG60LrsI9HAxMWtCQVOH2xXgkjrOs1M9yeStdGtPmWQqOvovkApVRB"
                    ]
                    }

          =Method 7, 8
               public function student(){
                    
                    // Method 7
                    // $students = Student::join("users","users.id","=","students.user_id")->where("user_id",$this->user_id)->get(["users.*","students.*"]);
                    // // dd($students);

                    // foreach($students as $student){
                    //     // dd($student);
                    //     return $student["regnumber"];
                    // }


                    // Method 8
                    $students = Student::join("users","users.id","=","students.user_id")->where("user_id",$this->user_id)->get(["users.name","students.regnumber"])->first();
                    //dd($students);
                    //dd($students["regnumber"]);
                    return $students["regnumber"];

               }

               *result ($students)
               App\Models\Student {#1444 ▼ // app\Models\Enroll.php:106
                    #connection: "mysql"
                    #table: "students"
                    #primaryKey: "id"
                    ....
                    #original: array:2 [▼
                    "name" => "admin"
                    "regnumber" => "WDF1001"
                    ]        
                    ....
               }

               -Method 7 = all columns from two table come out
               -Method 8 = only selected columns come out

          =Method 9
               $students = Student::join("users","users.id","=","students.user_id")->where("user_id",$this->user_id)->get(["users.name","students.regnumber"])->pluck("regnumber")->first();
               // dd($students); // "WDF1001"
               return $students;

               *pluck should't be written at the end
               $students = Student::join("users","users.id","=","students.user_id")->where("user_id",$this->user_id)->get(["users.name","students.regnumber"])->first()->pluck("regnumber");
               *result ($students)
                    Illuminate\Support\Collection {#1445 ▼ // app\Models\Enroll.php:112
                    #items: array:4 [▼
                    0 => "WDF1001"
                    1 => "WDF1002"
                    2 => "WDF1003"
                    3 => "WDF1004"
                    ]
                    #escapeWhenCastingToString: false
                    } 
          
          =Method 10, 11

               // Method 10
               // $students = DB::table("students")
               //             ->join("users","users.id","=","students.user_id")
               //             ->where("user_id",$this->user_id)
               //             ->get(["users.name","students.regnumber"])
               //             ->pluck("regnumber")->first();
          
               // // dd($students);
               // return $students;

               // Method 11
               $students = DB::table("students")
                              ->select("users.id","users.name","students.regnumber")
                              ->join("users","users.id","=","students.user_id")
                              ->where("user_id",$this->user_id)
                              ->get()
                              ->pluck("regnumber")->first();
          
               // dd($students);
               return $students;

               *result ->get()
                    Illuminate\Support\Collection {#1446 ▼ // app\Models\Enroll.php:135
                    #items: array:1 [▼
                    0 => {#1444 ▼
                         +"id": 1
                         +"name": "admin"
                         +"regnumber": "WDF1001"
                    }
                    ]
                    #escapeWhenCastingToString: false
                    }

           =My     
     
          =MyMethod
               $student = Student::join("users","students.user_id","=","users.id")->where("users.id",$this->user_id)->get(["students.regnumber"])->first();
               // dd($student->regnumber);
               return $student->regnumber;

               
     =>Link with Student 
          =In Enroll.php
               public function studenturl(){
                    return Student::where("user_id",$this->user_id)->get(["students.id"])->first();
               }

          =In enrolls > index.blade.php

               @foreach($enrolls as $idx=>$enroll)
                         <tr>
                              <td>{{++$idx}}</td>
                              {{-- <td>{{ $enroll->student($enroll->user_id) }}</td> --}}
                              <td><a href="{{route('students.show',$enroll->studenturl())}}">{{$enroll->student()}}</a></td>
               ....

          =>Back to Enroll From Student
               =In students > show.blade.php
                    <a href="javascript:void(0);" id="btn-back" class="btn btn-secondary btn-sm rounded-0">Back</a>
                    ....
                    @section("scripts")
                         <script type="text/javascript">
                              // Start Back Btn
                                   const getbtnback = document.getElementById("btn-back");
                                   getbtnback.addEventListener("click",function(){
                                        // window.history.back();
                                        window.history.go(-1);
                                   });
                              // End Back Btn
                         </script>
                    @endsection

                    *go() can reach both front and back

     =>Student Tab Template
          =students > show.blade.php
               <h6>Additional Info</h6>
               <div class="card border-0 rounded-0 shadow mb-4">
                    <ul class="nav">
                         <li class="nav-item">
                              <button type="button" id="autoclick" class="tablinks" onclick="gettab(event,'follower')">Follower</button>
                         </li>
                         <li class="nav-item">
                              <button type="button" class="tablinks" onclick="gettab(event,'following')">Following</button>
                         </li>
                         <li class="nav-item">
                              <button type="button" class="tablinks" onclick="gettab(event,'liked')">Liked</button>
                         </li>
                         <li class="nav-item">
                              <button type="button" class="tablinks" onclick="gettab(event,'remark')">Remark</button>
                         </li>
                    </ul>

                    <div class="tab-content">

                         <div id="follower" class="tab-pane">
                              <h3>This is Home Information</h3>
                              <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                         </div>

                         <div id="following" class="tab-pane">
                              <h3>This is Profile Information</h3>
                              <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                         </div>

                         <div id="liked" class="tab-pane">
                              <h3>This is Contact Information</h3>
                              <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                         </div>

                         <div id="remark" class="tab-pane">
                              <p>{{ $student->remark }}</p>
                         </div>

                    </div>
               </div>

               ....
               @section("css")
                    <style type="text/css">
                         /* Start Tag Box */
                         .nav{
                         display: flex;

                         padding: 0;
                         margin: 0;
                         }
                         .nav .nav-item{
                         list-style-type: none;
                         }
                         .nav .tablinks{
                         border: none;
                         font-size: 16px;
                         padding: 15px 20px;
                         cursor: pointer;

                         transition: background-color 0.3s ease-in;
                         }
                         .nav .tablinks:hover{
                         background-color: #f3f3f3;
                         }

                         .nav .tablinks.active{
                              color: blue;
                         }

                         .tab-pane{

                         padding: 5px 15px;

                         display: none;
                         }
                         /* End Tag Box */
                    </style>
               @endsection

               @section("scripts")
                    // Start Tag Box
                    var gettablinks = document.getElementsByClassName('tablinks');  //HTMLCollection
                    var gettabpanes = document.getElementsByClassName('tab-pane');
                    // console.log(gettabpanes);

                    var tabpanes = Array.from(gettabpanes);

                    function gettab(evn,linkid){

                    tabpanes.forEach(function(tabpane){
                         tabpane.style.display = 'none';
                    });

                    for(var x = 0 ; x < gettablinks.length ; x++){
                         gettablinks[x].className = gettablinks[x].className.replace(' active','');
                    }


                    document.getElementById(linkid).style.display = 'block';


                    // evn.target.className += ' active';
                    // evn.target.className = evn.target.className.replace('tablinks','tablinks active');
                    // evn.target.classList.add('active');

                    // evn.target = evn.currentTarget
                    evn.currentTarget.className += ' active';

                    }

                    document.getElementById('autoclick').click();
                    // End Tag Box
               @endsection

     =>Student Enrolls
          =StudentController.php

               public function show(string $id)
               {
                    $student = Student::findOrFail($id);

                    // $enrolls = Enroll::where("user_id",$student["user_id"])->get();
                    $enrolls = $student->enrolls();
                    // dd($enrolls);
                    return view("students.show",["student"=>$student,"enrolls"=>$enrolls]);
               
               }

          =Student.php
               public function enrolls(){
                    return Enroll::where("user_id",$this->user_id)->get();
               }

          *Controller - Model 
          -enrolls information of the student

          =In students > show.blade.php

                <h6>Enrolls</h6>
               <div class="card border-0 rounded-0 shadow mb-4">
                    <div class="card-body d-flex flex-wrap gap-3">
                         
                         @foreach($enrolls as $enroll)
                         <div class="border shadow p-3 mb-3 enrollboxes">
                              <a href="javascript:void(0);">{{ $enroll->post["title"] }}</a>
                              <div class="text-muted">{{ $enroll->stage["name"] }}</div>
                              <div class="text-muted">{{ date("d M Y",strtotime($enroll->created_at)) }} | {{ date("h:i:s A",strtotime($enroll->created_at)) }}</div>
                              <div class="text-muted">{{ $enroll->updated_at->format("d M Y | h:i:s A") }} </div>
                              {{-- <div class="mt-1" title="{{ $enroll->remark }}">{{ Str::limit($enroll->remark,20) }}</div> --}}
                              {{-- <div class="mt-1" title="{{ $enroll->remark }}">{{ Str::limit($enroll->remark,20,"---") }}</div> --}}
                              {{-- <div class="mt-1" title="{{ $enroll->remark }}">{{ Str::of($enroll->remark)->limit(20) }}</div> --}}
                              {{-- <div class="mt-1" title="{{ $enroll->remark }}">{{ Str::of($enroll->remark)->words(4) }}</div> --}}
                              {{-- <div class="mt-1" title="{{ $enroll->remark }}">{{ Str::of($enroll->remark)->words(4,"----") }}</div> --}}
                              {{-- <div class="mt-1" title="{{ $enroll->remark }}">{{ Str::words($enroll->remark,4) }}</div> --}}
                              <div class="mt-1" title="{{ $enroll->remark }}">{{ Str::words($enroll->remark,4,"----") }}</div>
                         </div>
                         @endforeach
                    </div>
               </div>

          - Enroll Class
               post() inside Enroll.php
                    not in Student
               
               1.There is not post_id in students.
               2.Get information from enrolls. "enrolls" has post_id.
     
     =>Own Search
          =>By Controller
               =In countries > index.blade.php
                    <div class="col-md-12">
                         <form action="" method="">
                              <div class="row justify-content-end">
                                   <div class="col-md-2 col-sm-6 mb-2">
                                        <div class="input-group">
                                             <input type="text" name="filtername" id="filtername" class="form-control form-control-sm rounded-0" placeholder="Search...."/>
                                             <button type="submit" id="btn-search" class="btn btn-secondary btn-sm"><i class="fas fa-search"></i></button>
                                        </div>
                                   </div>
                              </div>
                         </form>
                    </div>

               =In CountriesController.php
                    public function index()
                    {
                         // http://127.0.0.1:8000/countries?filtername=mm
                         // dd(request("filtername")); // mm

                         $countries = Country::where(function($query){
                                   if($getname = request("filtername")){
                                        $query->where("name","LIKE","%".$getname."%");
                                   }
                         })->get();
                         // dd($countries);
                         return view("countries.index",compact("countries"));
                    }

                    -request() - get the request form value
                    -Countries -> where($query) = countries tables represent $query
                         Change query based on condition. (filtername exists or not) 

                    *result ($countries)
                    Illuminate\Database\Eloquent\Collection {#1412 ▼ // app\Http\Controllers\CountriesController.php:22
                    #items: array:1 [▼
                    0 => App\Models\Country {#1411 ▼
                         #connection: "mysql"
                         #table: "countries"
                         #primaryKey: "id"
                         #original: array:6 [▼
                         "id" => 1
                         "name" => "Myanmar"
                         "slug" => "myanmar"
                         "user_id" => 1
                         "created_at" => "2023-12-23 19:14:06"
                         "updated_at" => "2023-12-23 19:14:06"
                         ]
                    ....
                    }
                    ]
                    #escapeWhenCastingToString: false
                    }

                    http://127.0.0.1:8000/countries?filtername=th
                    *result 
                         Thailand
                    
                    http://127.0.0.1:8000/countries?filtername=
                    *result 
                         Myanmar
                         Thailand

               =>Get Old Search Value
                    =In cities > index.blade.php

                         <div class="col-md-12">
                              <form action="" method="">
                                   <div class="row justify-content-end">
                                        <div class="col-md-2 col-sm-6 mb-2">
                                             <div class="input-group">
                                                  <input type="text" name="filtername" id="filtername" class="form-control form-control-sm rounded-0" placeholder="Search...." value="{{ request('filtername') }}"/>
                                                  <button type="submit" id="btn-search" class="btn btn-secondary btn-sm"><i class="fas fa-search"></i></button>
                                             </div>
                                        </div>
                                   </div>
                              </form>
                         </div>

                    =In CitiesController.php
                         public function index()
                         {
                              $cities = City::where(function($query){
                                   if($getname = request("filtername")){
                                        $query->where("name","LIKE","%".$getname."%");
                                   }
                              })->get();
                              // dd($cities);
                              return view("cities.index",compact("cities"));
                         }
          
          =>With Javascript
               =In cities > index.blade.php
                    <div class="input-group">
                         <input type="text" name="filtername" id="filtername" class="form-control form-control-sm rounded-0" placeholder="Search...." value="{{ request('filtername') }}"/>
                         <button type="button" id="btn-search" class="btn btn-secondary btn-sm"><i class="fas fa-search"></i></button>
                    </div>
                    ....


                     // Start Filter
                    const getfilterbtn = document.getElementById("btn-search");
                    getfilterbtn.addEventListener("click",function(e){
                         // console.log("hay");

                         const getfiltername = document.getElementById("filtername").value;
                         const getcururl = window.location.href;
                         
                         // console.log(getfiltername); // search value
                         // console.log(getcururl); // http://127.0.0.1:8000/cities?filtername=yan
                         // console.log(getcururl.split("?")); // ['http://127.0.0.1:8000/cities', 'filtername=yan']
                         // console.log(getcururl.split("?")[0]); // 
                         window.location.href = getcururl.split("?")[0] + "?filtername="+getfiltername;

                         e.preventDefault();
                    });
                    // End Filter

                    *without using submit button, js send value to the current file with the url. 

     =>Lite Looping Method , pluck(value,key)
          =In RolesController.php
               public function create()
               {    
                    //$statuses = Status::all(); // get all statuses
                    $statuses = Status::whereIn("id",[3,4])->get()->pluck('name',"id");
                    //  dd($statuses);
                    return view("roles.create",compact("statuses"));
               }

          =In roles > create.blade.php
               <div class="col-md-6">
                    <label for="name">Status <span class="text-danger">*</span></label>
                    <select type="text" name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                         <!-- <option value="3">On</option>
                         <option value="4">On</option> -->

                         {{-- @foreach($statuses as $status)
                              <option value="{{$status->id}}">{{ $status->name }}</option>
                         @endforeach
                         --}}

                         {{-- 
                         @foreach($statuses as $id=>$name)
                              <option value="{{ $id}}">{{ $name }}</option>
                         @endforeach
                         --}}

                         @foreach($statuses as $idx=>$status)
                              <option value="{{ $idx}}">{{ $status }}</option>
                         @endforeach
                    </select>
               </div>

          *result ($statuses)
               Illuminate\Support\Collection {#1422 ▼ // app\Http\Controllers\RolesController.php:25
               #items: array:2 [▼
               "On" => 3
               "Off" => 4
               ]
               #escapeWhenCastingToString: false
          
          *@foreach($statuses as $id=>$name) is the recommended method.
               
     =>Own Filter DropDown
          =In roles > index.blade.php
               <div class="col-md-12">
                    <form action="" method="">
                         <div class="row justify-content-end">
                              <div class="col-md-2 col-sm-6 mb-2">
                                   <div class="form-group">
                                        <select name="filterstatus_id" id="filterstatus_id" class="form-control form-control-sm rounded-0">
                                             <option value="" selected>Choose Status....</option>     
                                             @foreach($filterstatuses as $id=>$name)
                                                  <option value="{{$id}}">{{ $name }}</option>
                                             @endforeach
                                        </select>
                                   </div>
                              </div>
                         </div>
                    </form>
               </div>
               ....
               <script type="text/javascript">
                    // Start Filter
                    const getfilterstatus = document.getElementById("filterstatus_id");
                    getfilterstatus.addEventListener("click",function(e){
                         // const getstatusid = this.value;
                         // const getstatusid = this.options[this.selectedIndex].value;
                         const getstatusid = this.value || this.options[this.selectedIndex].value;
                         // console.log(getstatusid);

                         let getcururl = window.location.href;
                         // console.log(getcururl); // http://127.0.0.1:8000/cities?filtername=yan
                         // console.log(getcururl.split("?")); // ['http://127.0.0.1:8000/cities', 'filtername=yan']
                         // console.log(getcururl.split("?")[0]); // 
                         
                         window.location.href = getcururl.split("?")[0] + "?filterstatus_id="+getstatusid;

                         e.preventDefault();
                    });
                    // End Filter
          
          =In RolesController.php
               public function index()
               {
                    $roles = Role::where(function($query){
                         if($statusid = request("filterstatus_id")){
                              $query->where("status_id",$statusid);
                         }
                    })->get();
                    $filterstatuses = Status::whereIn("id",[3,4])->get()->pluck('name',"id");
                    return view("roles.index",compact("roles"),compact("filterstatuses"));
               }
               -it doesn't need "LIKE" Sytax because status_id can be checked directly. 

          -may think 'js' is not useful for the above search feature.
               but it is useful for the filter faeture. Because it has no button to submit form. Only js can submit form. 

          =>Backend Option
               =In roles. index.blade.php

                    <select name="filterstatus_id" id="filterstatus_id" class="form-control form-control-sm rounded-0">
                         <!-- <option value="" selected>Choose Status....</option>      -->
                         @foreach($filterstatuses as $id=>$name)
                              <option value="{{$id}}">{{ $name }}</option>
                         @endforeach
                    </select>

               =In RolesController.php
                    public function index()
                    {
                         $roles = Role::where(function($query){
                              if($statusid = request("filterstatus_id")){
                                   $query->where("status_id",$statusid);
                              }
                         })->get();
                         $filterstatuses = Status::whereIn("id",[3,4])->get()->pluck('name',"id")->prepend("Choose Status","");
                         // dd($filterstatuses);
                         return view("roles.index",compact("roles"),compact("filterstatuses"));
                    }

                    *prepend() after pluck. Increase the array at the first. 

                    *result ($filterstatuses);
                    Illuminate\Support\Collection {#1424 ▼ // app\Http\Controllers\RolesController.php:23
                    #items: array:3 [▼
                    "" => "Choose Status"
                    3 => "On"
                    4 => "Off"
                    ]
                    #escapeWhenCastingToString: false
                    }

          => Get Old Filter Value
               =In roles > index.blade.php

                    <select name="filterstatus_id" id="filterstatus_id" class="form-control form-control-sm rounded-0">
                         <!-- <option value="" selected>Choose Status....</option>      -->
                         @foreach($filterstatuses as $id=>$name)
                              <option value="{{$id}}" {{ $id == request('filterstatus_id') ? 'selected' : '' }}>{{ $name }}</option>
                         @endforeach
                    </select>

     =>Using Laravel Folder Downloaded From Github

          Github
               repository > Code > 'Download Zip'

          *.env and other ignores file do not include


          composer update
          (vpn may be needed to on)

          =Create .env file
               -copy existing .env file's content    
          
          php artisan serve

     =>Validation Error
          =In genders > index.blade.php
                <form action="{{route('genders.store')}}" method="POST">
                    {{ csrf_field() }}
                    <div class="row align-items-end">
                         <div class="col-md-6 form-group">
                              <label for="name">Name <span class="text-danger">*</span></label>
                              @error("name")
                                   <span class="text-danger">{{ $message }}<span>
                              @enderror
                              <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0 @error('name') is-invalid @enderror" placeholder="Enter Gender Name" value="{{ old('name') }}"/>
                              {{-- @error("name")
                                   <span class="invalid-feedback">{{ $message }}<span>
                              @enderror
                              --}}

                         </div>
          
          "invalid-feedback" = text color red for message
          "is-invalid" = field red border
          Error Message = The name field is required.

          *can be displayed as you like.
          -error messagees are generally displayed under input field. 
          
          =In roles > create.blade.php  
               <div class="col-md-6 mb-3">
                    <label for="image">Image</label>
                    <input type="file" name="image" id="image" class="form-control form-control-sm rounded-0" value="{{ old('image')}}"/>
                    @error("image")
                         <span class="text-danger">{{ $message }}<span>
                    @enderror
               </div>

               <div class="col-md-6 mb-3">
                    <label for="name">Name <span class="text-danger">*</span></label>
                    <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Role Name" value="{{ old('name') }}"/>
                    @error("name")
                         <span class="text-danger">{{ $message }}<span>
                    @enderror
               </div>

               <div class="col-md-6">
                    <label for="name">Status <span class="text-danger">*</span></label>
                    <select type="text" name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                         <option selected disabled>Choose Status</option>

                         {{-- @foreach($statuses as $status)
                              <option value="{{$status->id}}">{{ $status->name }}</option>
                         @endforeach
                         --}}

                         {{-- 
                         @foreach($statuses as $id=>$name)
                              <option value="{{ $id}}">{{ $name }}</option>
                         @endforeach
                         --}}

                         @foreach($statuses as $idx=>$status)
                              <option value="{{ $idx}}">{{ $status }}</option>
                         @endforeach
                    </select>
                    @error("status_id")
                         <span class="text-danger">{{ $message }}<span>
                    @enderror
               </div>

          -Error get from validation rules that are specified at the controller of the respective method.
          -Error only occur when the input field didn't match the valudation rules.

          *select box is already chosen one option. It will not get error.
          

          Error Handling Pages
          1.Create page
          2.Edit page

     =>Laravel Pagination

          =In TagsController.php
               public function index()
               {
                    $tags = Tag::orderBy("id","asc")->paginate(5);
                    $statuses = Status::whereIn("id",[3,4])->get();
                    return view("tags.index",compact("tags","statuses"));
               }
               -paginate(limitnumber)
               -retrive only limited number of rows
               *paginate() should be placed at the last because it is the data retriever.

          =In tags > index.blade.php
               </table>
               {{ $tags->links('pagination::bootstrap-4') }}
               ----------------------------------------------
               </table>
                    {{ $tags->links() }}

               *Problem 
                    Angle Arrow Design do not align.  
               -problem is bootstrap version
                    project bootstrap = version 5
               -laravel no longer support bootstrap
                    laravel support bootstrap = version 4
               -laravel support tailwind

          http://127.0.0.1:8000/tags?page=1
          http://127.0.0.1:8000/tags?page=2

          paginate() & links() are closely connected.
          links() generate pagination links.
          paginate() retrieve relevant row from table.

          =>Number Order
               - No. always 1 to 5 at all pages.
               *Number should be ordered at each pages.

               =In tags > index.blade.php
                     @foreach($tags as $idx=>$tag)
                         <tr>
                              {{-- <td>{{++$idx}}</td> --}}
                              <td>{{$idx+ $tags->firstItem()}}</td>

                    
               {{$tags->firstItem()}}
               {{-- $idx+ $tags->lastItem() --}}
               <table id="mytable" class="table table-sm table-hover border">

               firstItem() - 1, 6, 11
               *id is added by the current page first item. 

     =>Search, Filter & Pagination
          =In CountriesController.php
               public function index()
               {
                    // http://127.0.0.1:8000/countries?filtername=mm
                    // dd(request("filtername")); // mm

                    $countries = Country::where(function($query){
                              if($getname = request("filtername")){
                                   $query->where("name","LIKE","%".$getname."%");
                              }
                    })->paginate(5);
                    // dd($countries);
                    return view("countries.index",compact("countries"));
               }
     
          =In RolesController.php
               public function index()
               {
                    $roles = Role::where(function($query){
                         if($statusid = request("filterstatus_id")){
                              $query->where("status_id",$statusid);
                         }
                    })->paginate(5);
                    $filterstatuses = Status::whereIn("id",[3,4])->get()->pluck('name',"id")->prepend("Choose Status","");
                    // dd($filterstatuses);
                    return view("roles.index",compact("roles"),compact("filterstatuses"));
               }

     =>Record Download Link

          =Migration
               php artisan make:model Edulink -m

               =In create_edilinks_table.php
                    $table->date("classdate");
                    $table->unsignedBigInteger("post_id");
                    $table->string("url");
                    $table->unsignedBigInteger("user_id");

               php artisan migrate:status
               php artisan migrate

          =php artisan make:controller EdulinksController    

          =>Create New Record
               =In EdulinksController.php
                    public function index()
                    {
                         $data["edulinks"] = Edulink::orderBy("updated_at","desc")->get();
                         $data["posts"] = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->pluck('title',"id");
                         return view("edulinks.index",$data);
                    }

               =In Edulinks index.blade.php
                    <form action="{{route('edulinks.store')}}" method="POST">
                         {{ csrf_field() }}

                         <div class="row align-items-end">
                              <div class="col-md-3">
                                   <label for="classdate">Class Date <span class="text-danger">*</span></label>
                                   @error("classdate")
                                        <span class="text-danger">{{ $message }}<span>
                                   @enderror
                                   <input type="date" name="classdate" id="classdate" class="form-control form-control-sm rounded-0" value="{{ old('classdate') }}"/>
                              </div>

                              <div class="col-md-3">
                                   <label for="post_id">Class <span class="text-danger">*</span></label>
                                   @error("post_id")
                                        <span class="text-danger">{{ $message }}<span>
                                   @enderror
                                   <select name="post_id" id="post_id" class="form-control form-control-sm rounded-0">
                                        <option selected disabled>Choose class</option>
                                        @foreach($posts as $id=>$title)
                                             <option value="{{$id}}">{{$title}}</option> 
                                        @endforeach     
                                   </select>
                              </div>

                              <div class="col-md-3">
                                   <label for="url">Url <span class="text-danger">*</span></label>
                                   @error("url")
                                        <span class="text-danger">{{ $message }}<span>
                                   @enderror
                                   <input type="text" name="url" id="url" class="form-control form-control-sm rounded-0" placeholder="Enter url" value="{{ old('url') }}"/>
                              </div>

                              <div class="col-md-3">
                                   <button type="reset" class="btn btn-secondary btn-sm rounded-0">Cancel</button>
                                   <button type="submit" class="btn btn-primary btn-sm rounded-0 ms-3">Submit</button>
                              </div>
                         </div>
                    </form>

               =>Store Record
                    =In EdulinksController.php
                         public function store(Request $request)
                         {
                              $this->validate($request,[
                                   "classdate"=>"required|date",
                                   "post_id"=>'required',
                                   "url"=>"required"
                              ]);

                              $user = Auth::user();
                              $user_id = $user->id;

                              $edulink = new Edulink();
                              $edulink->classdate = $request["classdate"];
                              $edulink->post_id = $request["post_id"];
                              $edulink->url = $request["url"];
                              $edulink->user_id = $user_id;

                              $edulink->save();
                              return redirect()->route("edulinks.index");
                         }
          
          =>List All Records
               =In edulinks > index.blade.php
                    <table id="mytable" class="table table-sm table-hover border">
          
                         <thead>
                              <th>ID</th>
                              <th>Class</th>
                              <th>URL</th>
                              <th>By</th>
                              <th>Class Date</th>
                              <th>Created At</th>
                              <th>Updated At</th>
                              <th>Action</th>
                         </thead>
                         <tbody>
                              @foreach($edulinks as $idx=>$edulink)
                              <tr>
                                   <td>{{++$idx}}</td>
                                   <td><a href="{{route('posts.show',$edulink->post_id)}}">{{$edulink->post['title']}}</a></td>
                                   <td><a href="#">{{ Str::limit($edulink->url,30) }}</a></td>
                                   <td>{{ $edulink["user"]["name"] }}</td>
                                   <td>{{ date("d M Y",strtotime($edulink->classdate)) }}</td>
                                   <td>{{ $edulink->created_at->format('d M Y h:i A') }}</td>
                                   <td>{{ $edulink->updated_at->format('d M Y') }}</td>
                                   <td>
                                        <a href="{{$edulink->url}}" class="text-primary" target="_blank" download="abc"><i class="fas fa-download"></i></a>
                                        <a href="javascript:void(0);" class="text-info ms-2 editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$edulink->id}}" data-post_id="{{$edulink->post_id}}" data-attcode="{{$edulink->attcode}}"><i class="fas fa-pen"></i></a>
                                   </td>
                              </tr>
                              @endforeach
                         </tbody>
               
                    </table>

               <a href="https://dlt.com/user/user1.jpg" class="text-primary" target="_blank" download="abc"><i class="fas fa-download"></i></a>

               *Real world server link 
               downlod ="abc"
               file is download with the specified file name from download attribute.

               =>Copy URL
                    =In Edulinks > index.blade.php
                         <td><a href="javascript:void(0);" class="link-btns" data-url="{{ $edulink->url}}" title="Copy Link">{{ Str::limit($edulink->url,30) }}</a></td>
                         ....

                         // Start link btn
                         $(".link-btns").click(function(){
                              var geturl = $(this).data("url");
                              // console.log(geturl);
                              navigator.clipboard.writeText(geturl);
                         });
                         // End link btn

          =>Own Search & Filter
               
               =In edulinks > index.blade.php
                    <form action="" method="">
                         <div class="row justify-content-end">
                              <div class="col-md-2 col-sm-6 mb-2">
                                   <div class="form-group">
                                        <select name="filter" id="filter" class="form-control form-control-sm rounded-0">
                                             @foreach($filterposts as $id=>$name)
                                                  <option value="{{$id}}" {{ $id == request('filter') ? 'selected' : '' }}>{{ $name }}</option>
                                             @endforeach
                                        </select>
                                   </div>
                              </div>

                              <div class="col-md-2 col-sm-6 mb-2">
                                   <div class="input-group">
                                        <input type="text" name="search" id="search" class="form-control form-control-sm rounded-0" placeholder="Search...." value="{{ request('filtername') }}"/>
                                        <button type="submit" id="btn-search" class="btn btn-secondary btn-sm"><i class="fas fa-search"></i></button>
                                   </div>
                              </div>

                              
                         </div>
                    </form>

                    ....
                    // Start Filter
                    document.getElementById("filter").addEventListener("click",function(){
                         let getfilterid = this.value || this.options[this.selectedIndex].value;
                         // console.log(getid);
                         window.location.href = window.location.href.split("?")[0]+"?filter="+getfilterid;
                    });
                    // End Filter

               =In EdulinksController.php
                    public function index()
                    {
                         // $data["edulinks"] = Edulink::orderBy("updated_at","desc")->paginate(5);
                         $data["edulinks"] = Edulink::where(function($query){
                              if($getfilter = request("filter")){
                                   $query->where("post_id",$getfilter);
                              } 
                              if($getsearch = request("search")){
                                   // $query->where("classdate","LIKE","%".$getsearch."%");
                                   $query->where("classdate","LIKE","%${getsearch}%");
                              }
                         })->orderBy("classdate","desc")->paginate(5);
                         $data["posts"] = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->pluck('title',"id");
                         $data["filterposts"] = Post::whereIn("attshow",[3])->orderBy("title","asc")->pluck('title',"id")->prepend("Choose Class","");
                         return view("edulinks.index",$data);
                    }
                    *search results based on filtered classes.
                    =If the filter option is choosen, search classes are within the filtered class. 

          =>Local Scopes in Laravel Eloquent
               = Method 1
                    =In Edulink.php
                         // Define Local Scope
                         // public function scope[name]($query){
                         //      return $query->(method);
                         // }

                         public function scopezaclassdate($query){
                              return $query->orderBy("classdate","desc");
                         }

                         *prefix "scope" must be included.

                    =In EdulinksController.php
                    public function index()
                    {
                         // $data["edulinks"] = Edulink::orderBy("updated_at","desc")->paginate(5);
                         $data["edulinks"] = Edulink::where(function($query){
                              if($getfilter = request("filter")){
                                   $query->where("post_id",$getfilter);
                              } 
                              if($getsearch = request("search")){
                                   // $query->where("classdate","LIKE","%".$getsearch."%");
                                   $query->where("classdate","LIKE","%${getsearch}%");
                              }
                         })->zaclassdate()->paginate(5);
                         $data["posts"] = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->pluck('title',"id");
                         $data["filterposts"] = Post::whereIn("attshow",[3])->orderBy("title","asc")->pluck('title',"id")->prepend("Choose Class","");
                         return view("edulinks.index",$data);
                    }

                    *can easily apply specific constraints to your database queries,

               =Method 2
                    =In Edulink.php
                         public function scopefilter($query){
                              if($getfilter = request("filter")){
                                   $query->where("post_id",$getfilter);
                              } 
                              if($getsearch = request("search")){
                                   // $query->where("classdate","LIKE","%".$getsearch."%");
                                   $query->where("classdate","LIKE","%${getsearch}%");
                              }
                              return $query;
                         }

                    =In EdulinksController.php
                         public function index()
                         {
                              // $data["edulinks"] = Edulink::orderBy("updated_at","desc")->paginate(5);
                              $data["edulinks"] = Edulink::filter()->zaclassdate()->paginate(5);
                              $data["posts"] = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->pluck('title',"id");
                              $data["filterposts"] = Post::whereIn("attshow",[3])->orderBy("title","asc")->pluck('title',"id")->prepend("Choose Class","");
                              return view("edulinks.index",$data);
                         }  

          =Inspecting Database Query In background
                    =In EdulinksController.php

                         // \DB::enableQueryLog();
                         // $data["edulinks"] = Edulink::all();
                         // dd( \DB::getQueryLog());

                         \DB::enableQueryLog();
                         $data["edulinks"] = Edulink::filter()->zaclassdate()->paginate(5);
                         dd( \DB::getQueryLog());
                         
                         
                         // \DB::enableQueryLog();
                         $data["posts"] = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->pluck('title',"id");
                         // dd( \DB::getQueryLog());
                         $data["filterposts"] = Post::whereIn("attshow",[3])->orderBy("title","asc")->pluck('title',"id")->prepend("Choose Class","");
                         return view("edulinks.index",$data);

                    *result ($data["edulinks"])                        
                    array:1 [▼ // app\Http\Controllers\EdulinksController.php:37
                    0 => array:3 [▼
                    "query" => "select * from `edulinks`"
                    "bindings" => []
                    "time" => 0.56
                    ]
                    ]
                                             
                    *result ($data["posts"])
                    array:1 [▼ // app\Http\Controllers\EdulinksController.php:45
                    0 => array:3 [▼
                    "query" => "select `title`, `id` from `posts` where `attshow` = ? order by `title` asc"
                    "bindings" => array:1 [▶]
                    "time" => 1.48
                    ]
                    ]

                    *result ($data["edulinks"] with pagination)
                    array:2 [▼ // app\Http\Controllers\EdulinksController.php:41
                    0 => array:3 [▼
                    "query" => "select count(*) as aggregate from `edulinks`"
                    "bindings" => []
                    "time" => 0.74
                    ]
                    1 => array:3 [▼
                    "query" => "select * from `edulinks` order by `classdate` desc limit 5 offset 0"
                    "bindings" => []
                    "time" => 0.66
                    ]
                    ]

          =Multi Column Search
               =In Edulink.php
                    public function scopefilter($query){
                         if($getfilter = request("filter")){
                              $query->where("post_id",$getfilter);
                         } 
                         if($getsearch = request("search")){
                              // $query->where("classdate","LIKE","%".$getsearch."%");
                              
                              // search by class date / created at / updated at
                              // $query->where("classdate","LIKE","%${getsearch}%")
                              //     ->orWhere("created_at","LIKE","%${getsearch}%")
                              //     ->orWhere("updated_at","LIKE","%${getsearch}%");
                              
                              // search by class date / created at / updated at
                              // $query->where("classdate","LIKE","%${getsearch}%");
                              // $query->orWhere("created_at","LIKE","%${getsearch}%");
                              // $query->orWhere("updated_at","LIKE","%${getsearch}%");
                         
                              $query->where("classdate","LIKE","%${getsearch}%")
                                   ->orWhere("created_at","LIKE","%${getsearch}%")
                                   ->orWhere("updated_at","LIKE","%${getsearch}%")
                                   ->orWhereHas("post",function($query) use($getsearch){
                                        $query->where("title","LIKE","%${getsearch}%");
                                   });
                         }
                         return $query;
                    }

               *class at the date or match with created_at, updated_at column will be received.
               *orWhereHas() allow to retrieve records from a table by checking specific condition in a related table.
                    -orWhereHas(relationship,callback(){})
                    -can search with post name in the search box insted of searching by post_id
               *error (Undefined variable $getsearch)  
                    -to apply $getsearch inside callback function 
                    -use($getseaerch) is needed

          =Get Old Search & Filter Values
               =In edulink > index.blade.php

                    <div class="col-md-2 col-sm-6 mb-2">
                         <div class="form-group">
                              <select name="filter" id="filter" class="form-control form-control-sm rounded-0">
                                   @foreach($filterposts as $id=>$name)
                                        <option value="{{$id}}" {{ $id == request('filter') ? 'selected' : '' }}>{{ $name }}</option>
                                   @endforeach
                              </select>
                         </div>
                    </div>

                    <div class="col-md-2 col-sm-6 mb-2">
                         <div class="input-group">
                              <input type="text" name="search" id="search" class="form-control form-control-sm rounded-0" placeholder="Search...." value="{{ request('search') }}"/>
                              <button type="submit" id="btn-search" class="btn btn-secondary btn-sm"><i class="fas fa-search"></i></button>
                         </div>
                    </div>


          =>Solving Pagination Problem
               =filter post
                    filtered results pagination
               =Switch Page 2
                    all the values passed with url cleared and paginate all results                
               
          =>Precise Search & Filter
               
               -above search and filter has some issue
                    =filter post
                    =search class date
                    *other post contains class date is inclusive.

               -to only search within filtered posts not in another post

               =In Edulinks.php
                    public function scopefilteronly($query){
                         if($getfilter = request("filter")){
                              $query->where("post_id",$getfilter);
                         } 
                         
                         return $query;
                    }

                    public function scopesearchonly($query){
                         
                         if($getsearch = request("search")){
                         
                              $query->where("classdate","LIKE","%${getsearch}%")
                                   ->orWhere("created_at","LIKE","%${getsearch}%")
                                   ->orWhere("updated_at","LIKE","%${getsearch}%")
                                   ->orWhereHas("post",function($query) use($getsearch){
                                        $query->where("title","LIKE","%${getsearch}%");
                                   });
                         }
                         return $query;
                    }

               =In EdulinksController.php
                    // \DB::enableQueryLog();
                    // $data["edulinks"] = Edulink::filter()->zaclassdate()->paginate(5);
                    // dd( \DB::getQueryLog());

                    // \DB::enableQueryLog();
                    $data["edulinks"] = Edulink::filteronly()->searchonly()->zaclassdate()->paginate(5);
                    // dd( \DB::getQueryLog());

               *result ($data["edulinks"])
                    =before split 
                         array:2 [▼ // app\Http\Controllers\EdulinksController.php:41
                         0 => array:3 [▼
                         "query" => "select count(*) as aggregate from `edulinks` where (`post_id` = ? and `classdate` LIKE ? or `created_at` LIKE ? or `updated_at` LIKE ? or exists (select * from `posts` where `edulinks`.`post_id` = `posts`.`id` and `title` LIKE ?)) ◀"
                         "bindings" => array:5 [▶]
                         "time" => 0.7
                         ]
                         1 => array:3 [▼
                         "query" => "select * from `edulinks` where (`post_id` = ? and `classdate` LIKE ? or `created_at` LIKE ? or `updated_at` LIKE ? or exists (select * from `posts` where `edulinks`.`post_id` = `posts`.`id` and `title` LIKE ?)) order by `classdate` desc limit 5 offset 0 ◀"
                         "bindings" => array:5 [▶]
                         "time" => 0.59
                         ]
                         ]

                    =after split
                         array:2 [▼ // app\Http\Controllers\EdulinksController.php:45
                         0 => array:3 [▼
                         "query" => "select count(*) as aggregate from `edulinks` where `post_id` = ? and (`classdate` LIKE ? or `created_at` LIKE ? or `updated_at` LIKE ? or exists (select * from `posts` where `edulinks`.`post_id` = `posts`.`id` and `title` LIKE ?)) ◀"
                         "bindings" => array:5 [▶]
                         "time" => 0.65
                         ]
                         1 => array:3 [▼
                         "query" => "select * from `edulinks` where `post_id` = ? and (`classdate` LIKE ? or `created_at` LIKE ? or `updated_at` LIKE ? or exists (select * from `posts` where `edulinks`.`post_id` = `posts`.`id` and `title` LIKE ?)) order by `classdate` desc limit 5 offset 0 ◀"
                         "bindings" => array:5 [▶]
                         "time" => 0.51
                         ]
                         ]

          =>Reset Search & Filter 
               =In edulinks > index.blade.php
                    <div class="input-group">
                         <input type="text" name="search" id="search" class="form-control form-control-sm rounded-0" placeholder="Search...." value="{{ request('search') }}"/>
                         <button type="button" id="btn-clear" class="btn btn-secondary btn-sm"><i class="fas fa-sync"></i></button>
                         <button type="submit" id="btn-search" class="btn btn-secondary btn-sm"><i class="fas fa-search"></i></button>
                    </div>
                    ....

                    // Start Clear btn
                    document.getElementById("btn-clear").addEventListener("click",function(){
                         const getfilter = document.getElementById("filter");
                         const getsearch = document.getElementById("search");

                         getfilter.selectedIndex = 0;
                         getsearch.value = "";

                         window.location.href = window.location.href.split("?")[0];
                    });
                    // End Clear btn

          =>Edit Record
               =In edulinks > index.blade.php
                    <!-- start edit modal -->
                    <div id="editmodal" class="modal fade">
                         <div class="modal-dialog modal-dialog-centered">
                              <div class="modal-content rounded-0">
                                   <div class="modal-header">
                                        <h6 class="modal-title">Edit Form</h6>
                                        <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                   </div>

                                   <div class="modal-body">
                                        <form id="formaction" action="" method="POST">
                                             {{ csrf_field() }}
                                             {{ method_field('PUT') }}
                                             <div class="row align-items-end">

                                                  <div class="col-md-6">
                                                       <label for="editclassdate">Class Date<span class="text-danger">*</span></label>
                                                       <input type="date" name="editclassdate" id="editclassdate" class="form-control form-control-sm rounded-0" />
                                                  </div>
                                                  
                                                  <div class="col-md-6 form-group">
                                                       <label for="editpost_id">Class <span class="text-danger">*</span></label>
                                                       <select name="editpost_id" id="editpost_id" class="form-control form-control-sm rounded-0">
                                                            @foreach($posts as $id=>$title)
                                                                 <option value="{{$id}}">{{$title}}</option> 
                                                            @endforeach     
                                                       </select>
                                                  </div>

                                                  <div class="col-md-12">
                                                       <label for="editurl">URL<span class="text-danger">*</span></label>
                                                       <input type="text" name="editurl" id="editurl" class="form-control form-control-sm rounded-0" />
                                                  </div>

                                                  <div class="col-md-12 d-flex justify-content-end mt-2">
                                                       <button type="submit" class="btn btn-primary btn-sm rounded-0">Update</button>
                                                  </div>
                                             </div>
                                        </form>
                                   </div>

                                   <div class="modal-footer">

                                   </div>
                              </div>
                         </div>
                    </div>
                    <!-- end edit modal -->
                    ....
                    // Start Edit Form
                    $(document).on("click",".editform",function(e){
                         
                         $("#editclassdate").val($(this).data("classdate"));
                         $("#editpost_id").val($(this).data("post"));
                         $("#editurl").val($(this).data("url"));
                         
                         const getid = $(this).attr("data-id");
                         $("#formaction").attr("action",`/edulinks/${getid}`);

                         e.preventDefault();
                    });
                    // End Edit Form
               
               =In EdulinksController.php
                    public function update(Request $request, string $id)
                    {
                         $this->validate($request,[
                              "editclassdate"=>"required|date",
                              "editpost_id"=>'required',
                              "editurl"=>"required"
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $edulink = Edulink::findOrFail($id);
                         $edulink->classdate = $request["editclassdate"];
                         $edulink->post_id = Str::slug($request["editpost_id"]);
                         $edulink->url = $request["editurl"];
                         $edulink->user_id = $user_id;

                         $edulink->save();
                         return redirect(route("edulinks.index"));
                    }

                    *error message at crreate fields (The classdate field is required. The post id field is required. The url field is required.)
                    $this->validate($request,[
                         "classdate"=>"required|date",
                         "post_id"=>'required',
                         "url"=>"required"
                    ]);

                    *validate() verify form field name. Not database column name.

          =>Success Message With Alert Box
               =>Create Message
                    =In EdulinksController.php
                         public function store(Request $request)
                         {
                              ....
                              $edulink->save();
                              //    return redirect()->route("edulinks.index");
                              // return redirect()->route("edulinks.index")->with("success","New Link Created");

                              session()->flash("success","New Link Created!!");
                              return redirect()->route("edulinks.index");
                         }

                    =In edulinks > index.blade.php
                          @if($getsuccess = session("success"))
                              <div class="alert alert-success rounded-0">{{ $getsuccess }}</div>
                         @endif
                         <form action="{{route('edulinks.store')}}" method="POST">

               =Update Message
                    =In EdulinksController.php
                         public function update(Request $request, string $id)
                         {
                              ....

                              $edulink->save();
                              // return redirect(route("edulinks.index"));
                              // return redirect()->route("edulinks.index")->with("success","Update Successfully");
                              
                              session()->flash("success","Update Successfully!!");
                              return redirect()->route("edulinks.index");
                         }

                    =In edulinks > index.blade.php

                         {{-- @if($getsuccess = session("success"))
                              <div class="alert alert-success rounded-0">{{ $getsuccess }}</div>
                              @endif
                         --}}

                         @if(session("success"))
                              <div class="alert alert-success rounded-0">{{ session("success") }}</div>
                         @endif

               -After the new record is created, system display create message to user.
               -After the record is updated, system display create message to user.
                    *message is displyed at the same location, because they use same variable name.
                    *Upon reload, the message disappear.

               *allows to attach data to the redirect response, making it accessible on the subsequent request.

               *The with() method is used to flash data to the session, meaning it stores the data temporarily for the next request and then removes it.
                    with(key,value)
                    -delete the data immediately after accessing.

          =>Delete Record
               =With jQuery
                    =In edulinks > index.blade.php
                    <td>
                         <a href="{{$edulink->url}}" class="text-primary" target="_blank" download="abc"><i class="fas fa-download"></i></a>
                         <a href="javascript:void(0);" class="text-info ms-2 editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$edulink->id}}" data-classdate="{{$edulink->classdate}}" data-post="{{$edulink->post_id}}" data-url="{{$edulink->url}}"  ><i class="fas fa-pen"></i></a>
                         <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx + $edulinks->firstItem()}}"><i class="fas fa-trash-alt"></i></a>
                    </td>
                    <form id="formdelete-{{ $idx + $edulinks->firstItem() }}" class="" action="{{route('edulinks.destroy',$edulink->id)}}" method="POST">
                         @csrf
                         @method("DELETE")
                    </form>
               
                    ....
                    // Start Delete Item
                    $(".delete-btns").click(function(){
                         // console.log('hay');
               
                         var getidx = $(this).data("idx");
                         // console.log(getidx);

                         if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
                              $('#formdelete-'+getidx).submit();
                              return true;
                         }else{
                              false;
                         }
                    });
                    // End Delete Item

                    =In EdulinksController.php
                         public function destroy(string $id)
                         {
                              $edulink = Edulink::findOrFail($id);
                              $edulink->delete();

                              session()->flash("success","Delete Successfully!!");
                              return redirect()->back();
                         }

                    *links() and firstItem() work together with the paginate() from controller.
                         *error 
                              if controller retrieve row with all() and get()
                    
                    *The edulinks is already paginated.
                         -it can't simply use the $idx. If use, it do not match the number between target number and actual number.

               =With JS
                    var deletebtns = document.querySelectorAll(".delete-btns");
                    deletebtns.forEach(function(deletebtn){
                         deletebtn.addEventListener("click",function(){
                              var getidx = this.getAttribute("data-idx");
                              console.log(getidx);

                              if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
                                   document.getElementById('formdelete-'+getidx).submit();
                                   return true;
                              }else{
                                   false;
                              }
                         });
                    });

          =>Auto show/hide Reset Button
               =In edulinks > index.blade.php
                    ....
                    // Start Autoshow Btn Clear
                    const autoshowbtn = function(){
                         let getbtnclear = document.getElementById("btn-clear");
                         let geturlquery = window.location.search; // ?filter=16&search=09
                         // console.log(geturlquery); 
                         let pattern = /[?&]search=/;

                         if(pattern.test(geturlquery)){
                              getbtnclear.style.display ="block";
                         }else{
                              getbtnclear.style.display ="none";
                         }
                    }
                    autoshowbtn();
                    // End Autoshow Btn Clear
     
     =>My Contact
          =Migration
               php artisan make:model Relative -m

               =create_relatives_table.php
                    $table->string("name")->unique();
                    $table->string("slug");
                    $table->unsignedBigInteger("status_id");
                    $table->unsignedBigInteger("user_id");

               php artisan make:model Contact -m 

               =create_contacts_table.php
                    $table->string("firstname");
                    $table->string("lastname")->nullable();
                    $table->string("birthday")->nullable();
                    $table->unsignedBigInteger("relative_id")->nullable();
                    $table->foreignId("user_id")->constrained(
                         table:"users",
                         indexName:"contacts_users_id"
                    )->onUpdate("cascade")->onDelete("cascade");

               *foreign key link 
                    -not to add if the main entity is not exist


                    onUpdate("cascade")
                    onDelete("cascade")
                    -ensures the correctness of the reference even when the primary table values are modified or deleted

               php artisan migrate:status
               php artisan migrate


          "Relatives"
               Mother
               Father
               Parent
               Brother
               Sister
               Son
               Daughter
               Child
               Friend
               Spouse
               Partner
               Assistant
               Manager
               Other
               Sweet Heart

          php artisan make:controller RelativesController
          php artisan make:controller ContactsController

          =>Create & Store Contacts
               =In contacts > index.blade.php
                    <!-- start create modal -->
                    <div id="createmodal" class="modal fade">
                         <div class="modal-dialog modal-dialog-centered">
                              <div class="modal-content rounded-0">
                                   <div class="modal-header">
                                        <h6 class="modal-title">Create Form</h6>
                                        <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                   </div>

                                   <div class="modal-body">
                                        <form id="{{route('contacts.store')}}" action="" method="POST">
                                             {{ csrf_field() }}
                                             <div class="row align-items-end">
                                                  <div class="col-md-6">
                                                       <label for="firstname">First Name <span class="text-danger">*</span></label>
                                                       <input type="text" name="firstname" id="firstname" class="form-control form-control-sm rounded-0" placeholder="Enter First Name" value="{{ old('firstname') }}"/>
                                                  </div>

                                                  <div class="col-md-6">
                                                       <label for="lastname">Last Name</label>
                                                       <input type="text" name="lastname" id="lastname" class="form-control form-control-sm rounded-0" placeholder="Enter Last Name" value="{{ old('lastname') }}"/>
                                                  </div>

                                                  <div class="col-md-6">
                                                       <label for="birthday">Birthday</label>
                                                       <input type="date" name="birthday" id="birthday" class="form-control form-control-sm rounded-0" value="{{ old('birthday') }}"/>
                                                  </div>
                                                  
                                                  <div class="col-md-6 form-group">
                                                       <label for="relative_id">Relative</label>
                                                       <select name="relative_id" id="relative_id" class="form-control form-control-sm rounded-0">
                                                            @foreach($relatives as $id=>$name)
                                                                 <option value="{{$id}}">{{ $name }}</option>
                                                            @endforeach     
                                                       </select>
                                                  </div>
                                                  
                         
                                                  <div class="col d-flex justify-content-end mt-2">
                                                       <button type="submit" class="btn btn-primary btn-sm rounded-0">Submit</button>
                                                  </div>
                                             </div>
                                        </form>
                                   </div>

                                   <div class="modal-footer">

                                   </div>
                              </div>
                         </div>
                    </div>
                    <!-- end create modal -->

               =In ContactsController.php
                    public function index()
                    {
                         $data["contacts"] = Contact::all();
                         $relatives = Relative::orderBy("id","asc")->pluck("name","id")->prepend("Choose relative","");
                         return view("contacts.index",compact("relatives"),$data);
                    }
               
               *pluck() automatically sort a-z
               -to sort as database row, use orderBy() by sorting id in asc 


               =In ContactsController.php
                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "firstname" => "required|min:3|max:50",
                              "lastname"=>"max:50",
                              "birthday"=>"nullable",
                              "relative_id"=>"nullable"
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $contact = new Contact();
                         $contact->firstname = $request["firstname"];
                         $contact->lastname = $request["lastname"];
                         $contact->birthday = $request["birthday"];
                         $contact->relative_id = $request["relative_id"];
                         $contact->user_id = $user_id;

                         $contact->save();
                         
                         session()->flash("success","New Contact Created");
                         return redirect(route("contacts.index"));
                    }

          =>List All Contacts
               =In contacts > index.blade.php
                    <table id="mytable" class="table table-sm table-hover border">
               
                         <thead>
                              <th>ID</th>
                              <th>First Name</th>
                              <th>Last Name</th>
                              <th>Birthday</th>
                              <th>Relative</th>
                              <th>By</th>
                              <th>Created At</th>
                              <th>Updated At</th>
                              <th>Action</th>
                         </thead>
               
                         <tbody>
                              @foreach($contacts as $idx=>$contact)
                              <tr>
                                   <td>{{++$idx}}</td>
                                   <td>{{$contact->firstname}}</td>
                                   <td>{{$contact->lastname}}</td>
                                   <td>{{ date("d M Y",strtotime($contact->birthday)) }}</td>
                                   <td>{{ $contact["relative"]["name"] }}</td>
                                   <td>{{ $contact["user"]["name"] }}</td>
                                   <td>{{ $contact->created_at->format('d M Y') }}</td>
                                   <td>{{ $contact->updated_at->format('d M Y') }}</td>
                                   <td>
                                        <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$contact->id}}" data-name="{{$contact->name}}" data-status="{{$contact->status_id}}"><i class="fas fa-pen"></i></a>
                                        <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a>
                                   </td>
                                   <form id="formdelete-{{ $idx }}" class="" action="{{route('contacts.destroy',$contact->id)}}" method="POST">
                                        @csrf
                                        @method("DELETE")
                                   </form>
                              </tr>
                              @endforeach
                         </tbody>  
                    </table>
               
          
               "contacts"
               id   firstname      lastname       birthday       relative_id
               2    Zaw            Myo            NULL           NULL

               *error
               Trying to access array offset on value of type null

               {{ dd(date("d M Y",strtotime(""))); }} 
               "01 Jan 1970"
               
               =In contacts > index.blade.php

                    <td>{{ $contact->birthday ? date("d M Y",strtotime($contact->birthday)) : "" }}</td>
                    <td>{{ $contact->relative_id ? $contact["relative"]["name"] : "" }}</td>
                    
                    *empty shown at the table column.
          
          =>Delete Contact
               public function destroy(string $id)
               {
                    $contact = Contact::findOrFail($id);
                    $contact->delete();
                    session()->flash("info","Delete Successfully");
                    return redirect()->back();
               }
               
          =>toastr Notification

               https://github.com/CodeSeven/toastr


               CDNs > 
               Minified
                    //cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js
                    //cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css
               
               =>Usage

                    Other Options > 

               =In adminheader.blade.php
                    <!-- toastr css1 js1 -->
                    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />

               =In adminfooter.blade.php
                    <!-- toastr css1 js1 -->
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js" type="text/javascript"></script>
                    
                    <script> 
                         
                         @if(session()->has("success"))
                              toastr.success('{{ session()->get("success") }}', 'Successful')
                         @endif

                         @if(session()->has("info"))
                              toastr.info('{{ session()->get("info") }}', 'Information')
                         @endif

                         // =>Display all validation errors 
                         @if($errors)
                              @foreach($errors->all() as $error)
                                   toastr.error('{{$error}}', 'Warning!')
                              @endforeach
                         @endif
                    </script>

                    *all pages can access success message from session and then display to user.
                    =contact create 
                    =contact delete 
                    =contact validation errors

                    =posts validation errors

                    *blade codes inside javascript <script></script> 

                    =>Seperate blade code and js code
                         =>Session method
                              =>Adding toastr Options
                                   =In adminfooter.blade.php
                                        <!-- toastr css1 js1 -->
                                        <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js" type="text/javascript"></script>
                                        <script>
                                             toastr.options = {
                                                  "progressBar":true,
                                                  "closeButton":true
                                             };
                                        </script> 

                                             @if(Session::has("success"))
                                                  <script>toastr.success('{{ session()->get("success") }}', 'Successful')</script>
                                             @endif

                                             @if(session()->has("info"))
                                                  <script>toastr.info('{{ session()->get("info") }}', 'Information')</script>
                                             @endif

                                             @if($errors)
                                                  @foreach($errors->all() as $error)
                                                       <script>toastr.error('{{$error}}', 'Warning!',{timeOut:1000})</script>
                                                  @endforeach
                                             @endif

          =>Edit Contact 
               =In index.blade.php
                    <td>
                         <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$contact->id}}" data-firstname="{{$contact->firstname}}" data-lastname="{{$contact->lastname}}" data-birthday="{{$contact->birthday}}" data-relative="{{$contact->relative_id}}"><i class="fas fa-pen"></i></a>
                         <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a>
                    </td>
                    ....
                    <!-- start edit modal -->
                    <div id="editmodal" class="modal fade">
                         <div class="modal-dialog modal-dialog-centered">
                              <div class="modal-content rounded-0">
                                   <div class="modal-header">
                                        <h6 class="modal-title">Edit Form</h6>
                                        <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                   </div>

                                   <div class="modal-body">
                                        <form id="formaction" action="" method="POST">
                                             {{ csrf_field() }}
                                             {{ method_field('PUT') }}
                                             <div class="row align-items-end">
                                                  <div class="col-md-6 form-group">
                                                       <label for="editfirstname">First Name <span class="text-danger">*</span></label>
                                                       <input type="text" name="firstname" id="editfirstname" class="form-control form-control-sm rounded-0"/>
                                                  </div>

                                                  <div class="col-md-6 form-group">
                                                       <label for="editlastname">Last Name <span class="text-danger">*</span></label>
                                                       <input type="text" name="lastname" id="editlastname" class="form-control form-control-sm rounded-0"/>
                                                  </div>

                                                  <div class="col-md-6 form-group">
                                                       <label for="editbirthday">Birthday<span class="text-danger">*</span></label>
                                                       <input type="date" name="birthday" id="editbirthday" class="form-control form-control-sm rounded-0"/>
                                                  </div>
                                             
                                                  
                                                  <div class="col-md-6 form-group">
                                                       <label for="editrelative_id">Relative</label>
                                                       <select name="relative_id" id="editrelative_id" class="form-control form-control-sm rounded-0">
                                                            @foreach($relatives as $id=>$name)
                                                                 <option value="{{$id}}">{{$name}}</option>
                                                            @endforeach       
                                                       </select>
                                                  </div>
                                                  
                         
                                                  <div class="col d-flex justify-content-end mt-2">
                                                       <button type="submit" class="btn btn-primary btn-sm rounded-0">Update</button>
                                                  </div>
                                             </div>
                                        </form>
                                   </div>

                                   <div class="modal-footer">

                                   </div>
                              </div>
                         </div>
                    </div>
                    <!-- end edit modal -->
                    ....
                    // Start Edit Form
                    $(document).on("click",".editform",function(e){
                         
                         $("#editfirstname").val($(this).attr("data-firstname"));
                         $("#editlastname").val($(this).attr("data-lastname"));
                         $("#editbirthday").val($(this).attr("data-birthday"));
                         $("#editrelative_id").val($(this).attr("data-relative"));
                         
                         const getid = $(this).data("id");
                         $("#formaction").attr("action",`/contacts/${getid}`);

                         e.preventDefault();
                    });
                    // End Edit Form

               =In ContactsController.php
                    public function update(Request $request, string $id)
                    {
                         $this->validate($request,[
                              "firstname" => "required|min:3|max:50",
                              "lastname"=>"max:50",
                              "birthday"=>"nullable",
                              "relative_id"=>"nullable"
                         ]);

                         $user = Auth::user();
                         $user_id = $user["id"];

                         $contact = Contact::findOrFail($id);
                         $contact->firstname = $request["firstname"];
                         $contact->lastname = $request["lastname"];
                         $contact->birthday = $request["birthday"];
                         $contact->relative_id = $request["relative_id"];
                         $contact->user_id = $user_id;
                         $contact->save();

                         session()->flash("success","Update Successfully");
                         return redirect(route("contacts.index"));
                    }

          =>Setting Default to Laravel Pagination
               =In app > Providers > AppServiceProvider.php
                    use Illuminate\Pagination\Paginator;

                    public function boot(): void
                    {
                         View::composer('*',function($view){
                              $view->with("userdata",Auth::user());
                         });

                         Paginator::useBootstrapFive();
                    }

               =In contacts > index.blade.php
                    {{ $contacts->links() }}
                    {{-- $contacts->links("pagination::bootstrap-4") --}}
                    {{-- $contacts->links("pagination::bootstrap-5") --}}
               
          =>Contact Search & Filter + Pagination
               =In contacts > index.blade.php
                    <div class="col-md-12">
                         <form action="" method="">
                              <div class="row justify-content-end">
                                   <div class="col-md-2 col-sm-6 mb-2">
                                        <div class="form-group">
                                             <select name="filter" id="filter" class="form-control form-control-sm rounded-0">
                                                  @foreach($relatives as $id=>$name)
                                                       <option value="{{$id}}" {{ $id == request('filter') ? 'selected' : '' }}>{{ $name }}</option>
                                                  @endforeach
                                                  
                                             </select>
                                        </div>
                                   </div>

                                   <div class="col-md-2 col-sm-6 mb-2">
                                        <div class="input-group">
                                             <input type="text" name="search" id="search" class="form-control form-control-sm rounded-0" placeholder="Search...." value="{{ request('search') }}"/>
                                             <button type="button" id="btn-clear" class="btn btn-secondary btn-sm"><i class="fas fa-sync"></i></button>
                                             <button type="submit" id="btn-search" class="btn btn-secondary btn-sm"><i class="fas fa-search"></i></button>
                                        </div>
                                   </div>

                                   
                              </div>
                         </form>
                    </div>
                    ....
                    </table>
                    {{ $contacts->links() }}
                    {{-- $contacts->appends(request()->only("filter","search"))->links() --}}

                    ....
                    <script type="text/javascript">
                         // Start Filter
                         document.getElementById("filter").addEventListener("click",function(){
                              let getfilterid = this.value || this.options[this.selectedIndex].value;
                              // console.log(getid);
                              window.location.href = window.location.href.split("?")[0]+"?filter="+getfilterid;
                         });
                         // End Filter

                         // Start Clear btn
                         document.getElementById("btn-clear").addEventListener("click",function(){
                              const getfilter = document.getElementById("filter");
                              const getsearch = document.getElementById("search");

                              getfilter.selectedIndex = 0;
                              getsearch.value = "";

                              window.location.href = window.location.href.split("?")[0];
                         });
                         // End Clear btn

                         // Start Autoshow Btn Clear
                         const autoshowbtn = function(){
                              let getbtnclear = document.getElementById("btn-clear");
                              let geturlquery = window.location.search; // ?filter=16&search=09
                              // console.log(geturlquery); 
                              let pattern = /[?&]search=/;

                              if(pattern.test(geturlquery)){
                                   getbtnclear.style.display ="block";
                              }else{
                                   getbtnclear.style.display ="none";
                              }
                         }
                         autoshowbtn();
                         // End Autoshow Btn Clear

                    **have to appends() both 'filter' and 'search' query
                         if not, pagination will not correctly work. It will start from the orignal url not including filtered and searched query.

               =In Contact.php     
                    public function scopefilteronly($query){
                         if($getfilter = request("filter")){
                              $query->where("relative_id",$getfilter);
                         } 
                         
                         return $query;
                    }

                    public function scopesearchonly($query){
                         
                         if($getsearch = request("search")){
                              // search by firstname / lastname / birthday / relative name or WhereHas(relation,callback)
                              $query->where("firstname","LIKE","%${getsearch}%")
                                   ->orWhere("lastname","LIKE","%${getsearch}%")
                                   ->orWhere("birthday","LIKE","%${getsearch}%")
                                   ->orWhereHas("relative",function($query) use($getsearch){
                                        $query->where("name","LIKE","%${getsearch}%");
                                   });
                         }
                         return $query;
                    }

                    public function scopezafirstname($query){
                         return $query->orderBy("firstname","asc");
                    }

               =In ContactsController.php

                    public function index()
                    {
                         // $data["contacts"] = Contact::paginate(5);
                         $data["contacts"] = Contact::filteronly()->searchonly()->zafirstname()->paginate(5)->withQueryString();
                         $relatives = Relative::orderBy("id","asc")->pluck("name","id")->prepend("Choose relative","");
                         return view("contacts.index",compact("relatives"),$data);
                    }

                    *withQueryString() to include all the query string at the end of url.

     =>Breradcrumb & Auto page title

               {{-- <p>{{ \Request::root() }}<p> --}}            {{-- http://127.0.0.1:8000 --}}
               {{-- <p>{{ \Request::fullURL() }}<p> --}}          {{-- http://127.0.0.1:8000/edulinks?filter=4&search=16 --}}
               {{-- <p>{{ \Request::url() }}<p> --}}              {{-- http://127.0.0.1:8000/edulinks (not including query) --}}
               {{-- <p>{{ \Request::getRequestUri() }}<p> --}}    {{-- /edulinks?filter=4&search=16 ( include all url and query behind domain /host name ) --}}
               {{-- <p>{{ \Request::getPathInfo() }}<p> --}}      {{-- /edulinks ( include all url behind domain /host name but not including query ) --}}
               {{-- <p>{{ \Request::path() }}<p> --}}             {{-- posts/1/edit ( include all url behind domain /host name but not including query ) --}}
                                   

               {{-- <p>{{ request()->root() }}<p> --}}             {{-- http://127.0.0.1:8000 --}}
               {{-- <p>{{ request()->fullURL() }}<p> --}}          {{-- http://127.0.0.1:8000/edulinks?filter=4&search=16 --}}
               {{-- <p>{{ request()->url() }}<p> --}}              {{-- http://127.0.0.1:8000/edulinks (not including query) --}}
               {{-- <p>{{ request()->getRequestUri() }}<p> --}}    {{-- /edulinks?filter=4&search=16 ( include all url and query behind domain /host name ) --}}
               {{-- <p>{{ request()->getPathInfo() }}<p> --}}      {{-- /edulinks ( include all url behind domain /host name but not including query ) --}}
               {{-- <p>{{ request()->path() }}<p> --}}             {{-- posts/1/edit ( include all url behind domain /host name but not including query ) --}}
                                        
               {{-- /////////////////////////////////////////////////////////////////// --}}

               {{-- <p>{{ url()->full() }}<p> --}}                {{-- http://127.0.0.1:8000/edulinks?filter=4&search=16 --}}
               {{-- <p>{{ url()->current() }}<p> --}}             {{-- http://127.0.0.1:8000/edulinks (not including query) --}}
               {{-- <p>{{ url()->previous() }}<p> --}}            {{-- http://127.0.0.1:8000/edulinks?filter=4&search=16 (get full url but it is the last url request not current) --}}

          =Breadcrumb Format 
               Home / Recent / Current

          =In adminindex.blade.php
               <!-- Start Inner Content Area -->
               <div class="row">
                    {{-- <h5>@yield("caption")</h5> --}}
                    {{--<h6>{{ucfirst(Request::path()) }}</h6> --}}

                    <nav>
                         <ol class="breadcrumb">
                              <li class="breadcrumb-item"><a href="{{ \Request::root() }}"><i class="fas fa-home"></i></a></li>
                              <li class="breadcrumb-item"><a href="{{ url()->previous() }}">{{ Str::title(preg_replace("/[[:punct:]]+[[:alnum:]]+/","",str_replace(Request::root()."/","",url()->previous()))) }}</a></li>
                              <li class="breadcrumb-item active">{{ucfirst(Request::path()) }}</li>
                         </ol>
                    </nav>

                    
                    @yield("content")
               </div>
               <!-- End Inner Content Area -->
          
          *Steps of removing previous url 
          <!-- http://127.0.0.1:8000/edulinks?filter=4&search=16 -->
          {{-- str_replace(Request::root()."/","",url()->previous()) --}}
          <!-- =remove primary domain name with / -->
          
          <!-- edulinks?filter=4&search=16 -->
          {{-- preg_replace("/[[:punct:]]+[[:alnum:]]+/","",str_replace(Request::root()."/","",url()->previous())) --}}
          <!-- =remove all query string -->
          
          <!-- edulinks -->
          {{-- Str::title(preg_replace("/[[:punct:]]+[[:alnum:]]+/","",str_replace(Request::root()."/","",url()->previous()))) --}}


          *URL Circle
          http://127.0.0.1:8000/posts <-> Edulinks
          http://127.0.0.1:8000/edulinks?filter=20&search=8 <-> Posts


          *URL conflit
               http://127.0.0.1:8000/posts
               http://127.0.0.1:8000/posts/1

               <- (back to the previous posts lists)
               Home / Posts / Posts

               =Click previous Posts
               Home / Posts / Posts/1

     =>Leaves
          php artisan make:model Leave -m

          =In create_leaves_table.php
               $table->unsignedBigInteger("post_id");
               $table->date("startdate");
               $table->date("enddate");
               $table->unsignedBigInteger("tag");
               $table->string("title");
               $table->longText("content");
               $table->string("image")->nullable();
               $table->enum('stage_id',[1,2,3])->default(2)->comment("1=Approved, 2= Pending, 3=Reject");
               $table->unsignedBigInteger("authorize_id")->nullable();
               $table->unsignedBigInteger("user_id");

          php artisan migrate:status
          php artisan migrate

          php artisan make:controller LeavesController

          =>Create & Store Leave
               =In leaves > index.blade.php
                    <form action="/posts" method="POST" enctype="multipart/form-data">
                         @csrf

                         <div class="row">

                              <div class="col-md-4">

                                   <div class="row">
                                        <div class="col-md-12 mb-3">
                                             <label for="image" class="gallery"><span>Choose Images</span></label>
                                             <input type="file" name="image" id="image" class="form-control form-control-sm rounded-0" value="{{ old('image')}}" hidden/>
                                        </div>

                                        <div class="col-md-6 mb-3">
                                             <label for="startdate">Start Date <span class="text-danger">*</span></label>
                                             <input type="date" name="startdate" id="startdate" class="form-control form-control-sm rounded-0" value="{{ old('startdate') }}"/>
                                        </div>

                                        <div class="col-md-6 mb-3">
                                             <label for="enddate">End Date <span class="text-danger">*</span></label>
                                             <input type="date" name="enddate" id="enddate" class="form-control form-control-sm rounded-0" value="{{ old('enddate') }}"/>
                                        </div>
                                        
                                   </div>
                                   
                              </div>

                              <div class="col-md-8">
                                   <div class="row">
                                        
                                        <div class="col-md-12 mb-3">
                                             <label for="title">Title <span class="text-danger">*</span></label>
                                             <input type="text" name="title" id="title" class="form-control form-control-sm rounded-0" placeholder="Enter Post Title" value="{{ old('title') }}"/>
                                        </div>

                                        <div class="col-md-6 mb-3">
                                             <label for="post_id">Class <span class="text-danger">*</span></label>
                                             <select name="post_id" id="post_id" class="form-control form-control-sm rounded-0">
                                             <option selected disabled value="">Choose Class</option>     
                                                  @foreach($posts as $id=>$name)
                                                       <option value="{{$id}}">{{ $name }}</option>
                                                  @endforeach
                                             </select>
                                   
                                        </div>
     
                                        <div class="col-md-6 mb-3">
                                             <label for="tag">Tag <span class="text-danger">*</span></label>
                                             <select name="tag" id="tag" class="form-control form-control-sm rounded-0">
                                                  <option selected disabled value="">Choose authorize person</option>     
                                                  
                                                  @foreach($tags as $id=>$name)
                                                       <option value="{{$id}}">{{ $name }}</option>
                                                  @endforeach
                                             </select>
                                   
                                        </div>

                                        <div class="col-md-12 mb-3">
                                             <label for="content">Content <span class="text-danger">*</span></label>
                                             <textarea name="content" id="content" class="form-control form-control-sm rounded-0" rows="5" placeholder="Say Something....">{{ old('content') }}</textarea>
                                        </div>
                                        

                                        <div class="col-md-12 d-flex justify-content-end align-items-end">
                                                  <a href="{{route('posts.index')}}" class="btn btn-secondary btn-sm rounded-0 me-3">Cancel</a>
                                                  <button type="submit" class="btn btn-primary btn-sm rounded-0">Submit</button>
                                        </div>
                                   </div>
                              </div>

                              
                         </div>
                    </form>

               =In LeavesController.php
                    public function create()
                    {    
                         $data["posts"] = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->pluck("title","id");
                         $data["tags"] = User::orderBy("name","asc")->get()->pluck("name","id");

                         return view("leaves.create",$data);
                    }     

                    *tag person should be the person who has admin role. Future project iteration should implement this needs.

               =In LeavesController.php
                    public function store(LeaveRequest $request)
                    {
                         // $this->validate($request,[
                         //     "post_id" => "required",
                         //     "startdate" => "required",
                         //     "enddate" => "required",
                         //     "tag" => "required",
                         //     "title" => "required|max:50",
                         //     "content" => "required",
                         //     "image" => "nullable|image|mimes:jpg,jpeg,png|max:1024",
                         // ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $leave = new Leave();
                         $leave->post_id = $request["post_id"];
                         $leave->startdate = $request["startdate"];
                         $leave->enddate = $request["enddate"];
                         $leave->tag = $request["tag"];
                         $leave->title = $request["title"];
                         $leave->content = $request["content"];
                         $leave->user_id = $user_id;

                         // Single Image Upload
                         if(file_exists($request["image"])){
                              $file = $request["image"];
                              $fname = $file->getClientOriginalName();
                              $imagenewname = uniqid($user_id).$leave['id'].$fname;
                              // $file->move(public_path("leaves/img"),$imagenewname);
                              $file->move(public_path("assets/img/leaves"),$imagenewname);
                              
                              $filepath = "assets/img/leaves/".$imagenewname;
                              $leave->image = $filepath;
                         }    
                         $leave->save();
                         
                         session()->flash("success","New Leave Created");
                         return redirect(route("leaves.index"));
                    }

          =>Validation with Request file
               php artisan make:request LeaveRequest

               =Original LeaveRequest.php
                    <?php

                    namespace App\Http\Requests;

                    use Illuminate\Foundation\Http\FormRequest;

                    class LeaveRequest extends FormRequest
                    {
                         /**
                              * Determine if the user is authorized to make this request.
                              */
                         public function authorize(): bool
                         {
                              return false;
                         }

                         /**
                              * Get the validation rules that apply to the request.
                              *
                              * @return array<string, \Illuminate\Contracts\Validation\ValidationRule|array<mixed>|string>
                              */
                         public function rules(): array
                         {
                              return [
                                   //
                              ];
                         }
                    }

               =In app > Http > Requests > LeaveRequest.php
                    public function authorize(): bool
                    {
                         return true;
                    }

                    public function rules(): array
                    {
                         return [
                                   "post_id" => "required",
                                   "startdate" => "required",
                                   "enddate" => "required",
                                   "tag" => "required",
                                   "title" => "required|max:50",
                                   "content" => "required",
                                   "image" => "nullable|image|mimes:jpg,jpeg,png|max:1024",
                              ];
                    }

               *result ( authorize() - return false; )
               403 | THIS ACTION IS UNAUTHORIZED.

               *Validate Request should only be used when there are many validation rules.
                    - should not seperate validate request when validation rules a few of lines. 

               =>Default Validation Message

                    *result (create a leave without filling any fields.)
                         The content field is required.
                         The title field is required.
                         The tag field is required.
                         The enddate field is required.
                         The startdate field is required.
                         The post id field is required.

                    *First validation error is displayed at the bottom.
                    -User do not know the post id field. She know class. 

               =>Changing the name of attributes in error message
                    =In LeaveRequest.php
                         public function attributes(){
                              return [
                                   "post_id" => "class name",
                                   "startdate" => "start date",
                                   "enddate" => "end date",
                                   "tag" => "authorize person",
                              ]; 
                         }
                    *result (create a leave without filling any fields.)
                         The content field is required.
                         The title field is required.
                         The authorize person field is required.
                         The end date field is required.
                         The start date field is required.
                         The class name field is required.

                    *only change the attribute name not the whole message.
                    *Prove 
                         "post_id" => "class name is required",

                         The class name is required field is required.z

               =>Customizing Validtaion error message in Request File
                    -use in strict validation rules
                    
                    =In LeaveRequest.php
                         public function messages(){
                              return [
                                   "post_id.required" => "class name can't be empty",
                                   "startdate.required" => "start date can't be empty",
                                   "enddate.required" => "end date can't be empty",
                                   "tag.required" => "authorize person must be choose",
                              ];
                         }

                    *result (create a leave without filling any fields.)
                         The content field is required.
                         The title field is required.
                         authorize person must be choose
                         end date can't be empty
                         start date can't be empty
                         class name can't be empty

               =>Customizing Validation in controller
                    -use in loose validation rules

                    =In DaysController.php
                         public function store(Request $request)
                         {
                              $this->validate($request,[
                                   "name" => "required|max:50|unique:days",
                                   "status_id" => "required|in:3,4",
                              ],[
                                   "name.required"=>"Day Name is required"
                              ]);

                              $user = Auth::user();
                              $user_id = $user->id;

                              $day = new Day();
                              $day->name = $request["name"];
                              $day->slug = Str::slug($request["name"]);
                              $day->status_id = $request["status_id"];
                              $day->user_id = $user_id;
                              $day->save();
                              return redirect(route("days.index"));
                         }
          
          =>Edit & Update Leave
               =In leaves > edit.blade.php
                    <form action="/leaves/{{$leave->id}}" method="POST" enctype="multipart/form-data">
                         @csrf
                         @method("PUT")

                         <div class="row">

                              <div class="col-md-4">

                                   <div class="row">
                                        <div class="col-md-12 mb-3">

                                             <div class="row">
                                                  <div class="col-md-6 text-sm-center">
                                                       <img src="{{asset($leave->image)}}" width="200" alt="{{$leave->title}}"/>
                                                  </div>
                                                  <div class="col-md-6">
                                                       <label for="image" class="gallery"><span>Choose Images</span></label>
                                                       <input type="file" name="image" id="image" class="form-control form-control-sm rounded-0" value="{{ old('image',$leave->image) }}" hidden/>
                                                  </div>
                                             </div>
                                        </div>

                                        <div class="col-md-6 mb-3">
                                             <label for="startdate">Start Date <span class="text-danger">*</span></label>
                                             <input type="date" name="startdate" id="startdate" class="form-control form-control-sm rounded-0" value="{{ old('startdate',$leave->startdate) }}"/>
                                        </div>

                                        <div class="col-md-6 mb-3">
                                             <label for="enddate">End Date <span class="text-danger">*</span></label>
                                             <input type="date" name="enddate" id="enddate" class="form-control form-control-sm rounded-0" value="{{ old('enddate',$leave->enddate) }}"/>
                                        </div>
                                   </div>
                                   
                              </div>

                              <div class="col-md-8">
                                   <div class="row">
                                        
                                        <div class="col-md-12 mb-3">
                                             <label for="title">Title <span class="text-danger">*</span></label>
                                             <input type="text" name="title" id="title" class="form-control form-control-sm rounded-0" placeholder="Enter leave Title" value="{{ old('title',$leave->title) }}"/>
                                        </div>

                                        <div class="col-md-6">
                                             <label for="post_id">Class <span class="text-danger">*</span></label>
                                             <select name="post_id" id="post_id" class="form-control form-control-sm rounded-0">
                                                  @foreach($posts as $id=>$name)
                                                       <option value="{{$id}}"
                                                            @if($id === $leave["post_id"])
                                                                 selected
                                                            @endif
                                                       >{{ $name }}</option>
                                                  @endforeach
                                             </select>
                                        </div>

                                        <div class="col-md-6">
                                             <label for="tag">Tag <span class="text-danger">*</span></label>
                                             <select name="tag" id="tag" class="form-control form-control-sm rounded-0">
                                                  @foreach($tags as $id=>$name)
                                                       <option value="{{$id}}"
                                                            @if($id === $leave["tag"])
                                                                 selected
                                                            @endif
                                                       >{{ $name }}</option>
                                                  @endforeach
                                             </select>
                                        </div>


                                        <div class="col-md-12 mb-3">
                                             <label for="content">Content <span class="text-danger">*</span></label>
                                             <textarea name="content" id="content" class="form-control form-control-sm rounded-0" rows="5" placeholder="Say Something....">{{$leave->content}}</textarea>
                                        </div>                                   

                                        <div class="col-md-12 d-flex justify-content-end align-items-end">
                                             <div class="">
                                                  <a href="{{route('leaves.index')}}" class="btn btn-secondary btn-sm rounded-0 me-3">Cancel</a>
                                                  <button type="submit" class="btn btn-primary btn-sm rounded-0">Submit</button>
                                             </div>
                                        </div>
                                   </div>
                              </div>

                              
                         </div>
                    </form>

               =In LeavesController.php
                    public function edit(string $id)
                    {

                         $data["leave"] = Leave::findOrFail($id);

                         $data["posts"] = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->pluck("title","id");
                         $data["tags"] = User::orderBy("name","asc")->get()->pluck("name","id");

                         return view("leaves.edit",$data);
                    }

                    public function update(LeaveRequest $request, string $id)
                    {
                         // $this->validate($request,[
                         //     "post_id" => "required",
                         //     "startdate" => "required",
                         //     "enddate" => "required",
                         //     "tag" => "required",
                         //     "title" => "required|max:50",
                         //     "content" => "required",
                         //     "image" => "nullable|image|mimes:jpg,jpeg,png|max:1024",
                         // ]);

                         $user = Auth::user();
                         $user_id = $user["id"];

                         $leave = Leave::findOrFail($id);
                         $leave->post_id = $request["post_id"];
                         $leave->startdate = $request["startdate"];
                         $leave->enddate = $request["enddate"];
                         $leave->tag = $request["tag"];
                         $leave->title = $request["title"];
                         $leave->content = $request["content"];


                         // Remove Old Image
                         if($request->hasFile("image")){
                              $path = $leave->image;

                              if(File::exists($path)){
                                   File::delete($path);
                              }
                         }

                         // Single Image Update
                         if($request->hasFile("image")){
                              $file = $request->file("image");
                              $fname = $file->getClientOriginalName();
                              $imagenewname = uniqid($user_id).$leave['id'].$fname;
                              $file->move(public_path("assets/img/leaves"),$imagenewname);
                              
                              $filepath = "assets/img/leaves/".$imagenewname;
                              $leave->image = $filepath;
                         }    

                         $leave->save();
                         session()->flash("success","Update Successfully");

                         return redirect(route("leaves.index"));
                    }

          =>Two Request Files
               =Create 2 Request Files for create & edit

               -validation rules are not the exactly same
                    1. form field attributes changes (firstname,editfirstname) 
                    2. rules are differents according to the situation (create column unique do not need id but edit column need id)
               
               *There are too many files making messy project. 

          =>Incorporate validation ruels in one request file

               =In LeaveRequest.php
                    public function authorize(): bool
                    {

                         // dd($this->method()); 
                         return true;
                    }

                    public function rules(): array
                    {
                         // return [
                         //     "post_id" => "required",
                         //     "startdate" => "required",
                         //     "enddate" => "required",
                         //     "tag" => "required",
                         //     "title" => "required|max:50",
                         //     "content" => "required",
                         //     "image" => "nullable|image|mimes:jpg,jpeg,png|max:1024",
                         // ];
                         if($this->method() == "POST"){
                              return [
                                   "post_id" => "required",
                                   "startdate" => "required",
                                   "enddate" => "required",
                                   "tag" => "required",
                                   "title" => "required|max:50",
                                   "content" => "required",
                                   "image" => "nullable|image|mimes:jpg,jpeg,png|max:1024",
                              ];
                         }else{
                              return [
                                   "post_id" => "required",
                                   "startdate" => "required",
                                   "enddate" => "required",
                                   "tag" => "required",
                                   "title" => "required|max:50",
                                   "content" => "required",
                                   "image" => "nullable|image|mimes:jpg,jpeg,png|max:1024",
                              ];
                         }
                         
                    }

               
               *result (create and edit leave)                    
                    "POST" // app\Http\Requests\LeaveRequest.php:14  
                    "PUT" // app\Http\Requests\LeaveRequest.php:15

          =>List all leaves
               =In LeavesController.php
                    public function index()
                    {
                         $leaves = Leave::all();
                         return view("leaves.index",compact("leaves"));
                    }

               =In leaves > index.blade.php
                    <table id="mytable" class="table table-sm table-hover border">
     
                         <thead>
                              <th>No</th>
                              <th>Student Id</th>
                              <th>Class</th>
                              <th>Start Date</th>
                              <th>End Date</th>
                              <th>Tag</th>
                              <th>Stage</th>
                              <th>By</th>
                              <th>Created At</th>
                              <th>Updated At</th>
                              <th>Action</th>
                         </thead>
               
                         <tbody>
                              @foreach($leaves as $idx=>$leave)
                              <tr>
                                   <td>{{++$idx}}</td>
                                   <td><a href="{{ route('students.show',$leave->studenturl()) }}">{{ $leave->student($leave->user_id) }}</a></td>
                                   <td><a href="{{ route('posts.show',$leave->post_id) }}"> {{ $leave->post["title"] }}</a></td>
                                   <td>{{ $leave->startdate }}</td>
                                   <td>{{ $leave->enddate }}</td>
                                   <td>{{ $leave->tagperson["name"] }}</td>
                                   <td>{{ $leave->stage["name"] }}</td>
                                   <td>{{ $leave->user["name"] }}</td>
                                   <td>{{ $leave->created_at->format('d M Y') }}</td>
                                   <td>{{ $leave->updated_at->format('d M Y') }}</td>
                                   <td>
                                        <a href="{{ route('leaves.edit',$leave->id) }}" class="text-info"><i class="fas fa-pen"></i></a>
                                        <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a>
                                   </td>
                                   <form id="formdelete-{{ $idx }}" class="" action="{{route('leaves.destroy',$leave->id)}}" method="POST">
                                        @csrf
                                        @method("DELETE")
                                   </form>
                              </tr>
                              @endforeach
                         </tbody>
               
                    </table>

               =In Leave.php

                    class Leave extends Model
                    {
                         use HasFactory;
                         protected $table = "leaves";
                         protected $primaryKey = "id";
                         protected $fillable = [
                              "post_id",
                              "startdate",
                              "enddate",
                              "tag",
                              "title",
                              "content",
                              "image",
                              "stage_id",
                              "authorize_id",
                              "user_id",
                         ];

                         public function user(){
                              return $this->belongsTo(User::class);
                         }

                         public function post(){
                              return $this->belongsTo(Post::class);
                         }

                         public function stage(){
                              return $this->belongsTo(Stage::class);
                         }

                         public function student($userid){
                              
                              $students = Student::where("user_id",$userid)->get()->pluck("regnumber");

                              foreach($students as $student){
                                   return $student;
                              }
                         }

                         public function studenturl(){
                              return Student::where("user_id",$this->user_id)->get(["students.id"])->first();
                         }

                         public function tagperson(){
                              return $this->belongsTo(User::class,"tag");
                         }
                    }

          =>Show leave
               =In LeavesController.php
                    public function show(string $id)
                    {
                         $leave = Leave::findOrFail($id);
                         
                         return view("leaves.show",["leave"=>$leave]);
                    }
               =In index.blade.php
                    <td>
                         <a href="{{ route('leaves.show',$leave->id) }}" class="text-primary"><i class="fas fa-book-reader"></i></a>
                         <a href="{{ route('leaves.edit',$leave->id) }}" class="text-info ms-2"><i class="fas fa-pen"></i></a>
                         <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a>
                    </td>
               =In show.blade.php
                    <div class="col-md-4">
                         <h6>Info</h6>
                         <div class="card border-0 rounded-0 shadow">
                              <div class="card-body">
                                   <div class="d-flex flex-column align-items-center mb-3">
                                        <div class="h5 mb-1">{{ $leave->title }} </div>
                                        <div class="text-muted">
                                             <span>{{ $leave["stage"]["name"] }}</span>
                                        </div>
                                        <img src="{{ asset($leave->image) }}" class="" alt="{{$leave->title}}" width="200"/>
                                   </div>

                                   <div class="mb-5">
                                       

                                        <div class="row g-0 mb-2">
                                             <div class="col-auto">
                                                  <i class="fas fa-user"></i>
                                             </div>
                                             <div class="col ps-3">
                                                  <div class="row">
                                                       <div class="col">
                                                            <div class="">Authorize</div>
                                                       </div>
                                                       <div class="col-auto">
                                                            <div class="">{{ $leave["user"]["name"] }}</div>
                                                       </div>
                                                  </div>
                                             </div>
                                        </div>

                                        <div class="row g-0 mb-2">
                                             <div class="col-auto">
                                                  <i class="fas fa-calendar-alt fa-sm"></i>
                                             </div>
                                             <div class="col ps-3">
                                                  <div class="row">
                                                       <div class="col">
                                                            <div class="">Created</div>
                                                       </div>
                                                       <div class="col-auto">
                                                            <div class="">{{date('d M Y',strtotime($leave->created_at))}} | {{date('h:i:s A',strtotime($leave->created_at))}}</div>
                                                       </div>
                                                  </div>
                                             </div>
                                        </div>

                                        <div class="row g-0 mb-2">
                                             <div class="col-auto">
                                                  <i class="fas fa-edit fa-sm"></i>
                                             </div>
                                             <div class="col ps-3">
                                                  <div class="row">
                                                       <div class="col">
                                                            <div class="">Updated</div>
                                                       </div>
                                                       <div class="col-auto">
                                                            <div class="">{{date('d M Y h:i:s A',strtotime($leave->updated_at))}}</div>
                                                       </div>
                                                  </div>
                                             </div>
                                        </div>
                                   </div>


                                   <div class="mb-5">
                                        <p class="text-small text-muted text-uppercase mb-2">Contact Info</p>
                                        <div class="row g-0 mb-2">
                                             <div class="col-auto me-2">
                                                  <i class="fas fa-calender-alt"></i>
                                             </div>
                                             <div class="col">Sample Data</div>
                                        </div>
                                        <div class="row g-0 mb-2">
                                             <div class="col-auto me-2">
                                                  <i class="fas fa-calender-alt"></i>
                                             </div>
                                             <div class="col">Sample Data</div>
                                        </div>
                                        <div class="row g-0 mb-2">
                                             <div class="col-auto me-2">
                                                  <i class="fas fa-calender-alt"></i>
                                             </div>
                                             <div class="col">Sample Data</div>
                                        </div>
                                        <div class="row g-0 mb-2">
                                             <div class="col-auto me-2">
                                                  <i class="fas fa-calender-alt"></i>
                                             </div>
                                             <div class="col">Sample Data</div>
                                        </div>
                                   </div>
                              </div>
                         </div>
                    </div>

                    <div class="col-md-8">
                         

                         <h6>Additional Info</h6>
                         <div class="card border-0 rounded-0 shadow mb-4">
                              <ul class="nav">
                                   <li class="nav-item">
                                        <button type="button" id="autoclick" class="tablinks" onclick="gettab(event,'content')">Content</button>
                                   </li>
                              </ul>

                              <div class="tab-content">

                                   <div id="content" class="tab-pane">
                                        <p>{!! $leave->content !!}</p>
                                   </div>

                                   

                              </div>
                         </div>
                    </div>
               
          =>Auto Select Today
               =In LeavesController.php
                    public function create()
                    {    
                         $data["posts"] = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->pluck("title","id");
                         $data["tags"] = User::orderBy("name","asc")->get()->pluck("name","id");
                         $data["gettoday"] = Carbon::today()->format("Y-m-d"); // get today // "2024-02-26"
                         // dd($data["gettoday"]);
                         return view("leaves.create",$data);
                    }

                         *result (Carbon object)
                         Illuminate\Support\Carbon @1708882200 {#1459 ▼ // app\Http\Controllers\LeavesController.php:32
                         #endOfTime: false
                         #startOfTime: false
                         #constructedObjectId: "00000000000005b30000000000000000"
                         #localMonthsOverflow: null
                         #localYearsOverflow: null
                         #localStrictModeEnabled: null
                         #localHumanDiffOptions: null
                         #localToStringFormat: null
                         #localSerializer: null
                         #localMacros: null
                         #localGenericMacros: null
                         #localFormatFunction: null
                         #localTranslator: null
                         #dumpProperties: array:3 [▶]
                         #dumpLocale: null
                         #dumpDateProperties: null
                         date: 2024-02-26 00:00:00.0 Asia/Yangon (+06:30)
                         }

               =In leaves > create.blade.php
                    <div class="col-md-6 mb-3">
                         <label for="startdate">Start Date <span class="text-danger">*</span></label>
                         <input type="date" name="startdate" id="startdate" class="form-control form-control-sm rounded-0" value="{{ old('startdate',$gettoday) }}"/>
                    </div>

                    <div class="col-md-6 mb-3">
                         <label for="enddate">End Date <span class="text-danger">*</span></label>
                         <input type="date" name="enddate" id="enddate" class="form-control form-control-sm rounded-0" value="{{ old('enddate',$gettoday) }}"/>
                    </div>

                    *laravel send day with "Y-m-d" format. UI automatically change the date into "m/d/Y".
                    *old()
                         Even thought validation error occur, the form valules will be as user specified values, improving UX.
                         User's values will not be removed.
                    *old(user value, default value)
                         When there is no error, default value will be shown.


     =>API Switch to change on, off in UI
          =In TypesController.php
               public function typestatus(Request $request){
                    $type = Type::findOrFail($request["id"]);
                    $type->status_id = $request["status_id"];
                    $type->save();

                    return response()->json(["success"=>"Status Change Successfully"]);
               }
               *added method should write after the CRUD methods.
               *response() is for message to the client. In javascript it can be used in many ways. Alert respoonse text or other.

          php artisan route:list

          GET|HEAD        types types.index › TypesController@index  
          POST            types types.store › TypesController@store  
          GET|HEAD        types/create types.create › TypesControl…  
          GET|HEAD        types/{type} types.show › TypesControlle…  
          PUT|PATCH       types/{type} types.update › TypesControl…  
          DELETE          types/{type} types.destroy › TypesContro…  
          GET|HEAD        types/{type}/edit types.edit 

          *The added method is not inclusive.
          *Needed to register route for the method.

          =>In Web.php
               Route::resource("types",TypesController::class);
               Route::get("/typesstatus",[TypesController::class,"typestatus"]);

               php artisan route:list

               GET|HEAD        typesstatus .......................................................................... TypesController@typestatus

          =In types > index.blade.php
               <td>
                    <div class="form-checkbox form-switch">
                         <input type="checkbox" class="form-check-input change-btn" {{  $type->status_id === 3 ? 'checked' : '' }} data-id="{{ $type->id }}" />
                    </div>
               </td>
               ....
               //Start change-btn
               $(".change-btn").change(function(){
                    var getid = $(this).data("id");
                    // console.log(getid); // 1 2

                    var setstatus = $(this).prop("checked") === true ? 3 : 4;
                    // console.log(setstatus); // 3 4

                     $.ajax({
                         url:"typesstatus",
                         type:"GET",
                         dataType:"json",
                         data:{"id":getid,"status_id":setstatus},
                         success:function(response){
                              console.log(response); // {success: 'Status Change Successfully'}
                              console.log(response.success); // Status Change Successfully
                         }
                    });
               });
               // End change btn

               jQuery fullpackage is aleady connected.
               jQuery has lite file for only ajax request.

               ****Status is changed at database by server side code. 
               ****Even Though status change in UI(form switch) and database, status is not yet change in edit form. It will only change in next reload.

          =>Stage on/off
               =In StagesController.php
                    public function typestatus(Request $request){
                         $stage = Stage::findOrFail($request["id"]);
                         $stage->status_id = $request["status_id"];
                         $stage->save();

                         return response()->json(["success"=>"Stage Change Successfully"]);
                    }
               
               =In stages > index.blade.php
                    <td>
                         <div class="form-check form-switch">
                              <input type="checkbox" class="form-check-input change-btn" {{ $stage->status_id === 3 ? "checked" : "" }}  data-id="{{ $stage->id }}"/>
                         </div>
                    </td>
                    ....

                     //Start change-btn
                    $(".change-btn").change(function(){
                         var getid = $(this).data("id");
                         // console.log(getid); // 1 2

                         var setstatus = $(this).prop("checked") === true ? 3 : 4;
                         // console.log(setstatus); // 3 4

                         $.ajax({
                              url:"stagesstatus",
                              type:"GET",
                              dataType:"json",
                              data:{"id":getid,"status_id":setstatus},
                              success:function(response){
                                   console.log(response); // {success: 'Status Change Successfully'}
                                   console.log(response.success); // Status Change Successfully
                              }
                         });
                    });
                    // End change btn


     =>Notification Feature
          https://laravel.com
          Search Box > Notifications

          https://laravel.com/docs/10.x/notifications

          #Mail Notifications 
          #Database Notifications
          #Broadcast Notifications
          #SMS Notifications
          #Slack Notifications (Developer's platform)

          =>Tag Person Notification     
               -retrieve and display the relevant notifications of the tagged person

               #Database Notifications
               =>Step1: 
                    php artisan notifications:table
                    php artisan migrate

                    *need to run for the first time
                    
                    =>Notification migrations
                         public function up(): void
                         {
                              Schema::create('notifications', function (Blueprint $table) {
                                   $table->uuid('id')->primary();
                                   $table->string('type');
                                   $table->morphs('notifiable');
                                   $table->text('data');
                                   $table->timestamp('read_at')->nullable();
                                   $table->timestamps();
                              });
                         }
                    =>phpmyadmin
                         "notifications"
                         id	type	notifiable_type	notifiable_id	data	read_at	created_at	updated_at	

               =>Setp 2
                    #Generating Notifications
                         php artisan make:notification LeaveNotify

                    app\Notifications\LeaveNotify.php

                    =>Original LeaveNotify.php
                         <?php

                         namespace App\Notifications;

                         use Illuminate\Bus\Queueable;
                         use Illuminate\Contracts\Queue\ShouldQueue;
                         use Illuminate\Notifications\Messages\MailMessage;
                         use Illuminate\Notifications\Notification;

                         class LeaveNotify extends Notification
                         {
                         use Queueable;

                         /**
                              * Create a new notification instance.
                              */
                         public function __construct()
                         {
                              //
                         }

                         /**
                              * Get the notification's delivery channels.
                              *
                              * @return array<int, string>
                              */
                         public function via(object $notifiable): array
                         {
                              return ['mail'];
                         }

                         /**
                              * Get the mail representation of the notification.
                              */
                         public function toMail(object $notifiable): MailMessage
                         {
                              return (new MailMessage)
                                             ->line('The introduction to the notification.')
                                             ->action('Notification Action', url('/'))
                                             ->line('Thank you for using our application!');
                         }

                         /**
                              * Get the array representation of the notification.
                              *
                              * @return array<string, mixed>
                              */
                         public function toArray(object $notifiable): array
                         {
                              return [
                                   //
                              ];
                         }
                         }


                         *__construct() for setting notification contents or data
                         *via() for setting deliver channel
                         *toMail() for email notification
                         *toArray for formatting notification as an array
                    
                         #Specifying Delivery Channels 
                              mail, database, broadcast, vonage, and slack channels.

                              =In LeaveNotify.php
                                   public function via(object $notifiable): array
                                   {
                                        return ['database'];
                                   }
               
               =>Step 3
                    #Sending Notifications
                         #Using the Notification Facade
                              Notification::send($users, new InvoicePaid($invoice));

                    *sending the specific noti to the targets users 

                    =In LeavesController.php
                         public function store(LeaveRequest $request)
                         {
                             ....
                              $leave->save();
                              
                              session()->flash("success","New Leave Created");

                              Notification::send($user,new LeaveNotify($leave->id,$leave->title));

                              return redirect(route("leaves.index"));
                         }

                         *use Illuminate\Support\Facades\Notification;
                         *use App\Notifications\LeaveNotify;

                    =>Self Notification
                         =create a leave
                         
                         "notifications"
                         id	                    type	                              notifiable_type     notifiable_id	data	                              read_at	created_at	updated_at	
                         cb1358d5-8829-4b64       App\Notifications\LeaveNotify      App\Models\User     1              {"id":4,"title":"I am very sick"}  NULL
                         -8317-026544ec9231

                         *because Auth::user is me.

                    =>All user notifications 
                         =In LeavesController.php
                         public function store(LeaveRequest $request)
                         {
                             ....
                              $leave->save();
                              
                              session()->flash("success","New Leave Created");

                              $users = User::all();
                              Notification::send($users,new LeaveNotify($leave->id,$leave->title));
                              return redirect(route("leaves.index"));
                         }

                         "notifications"
                              id	                    type	                              notifiable_type     notifiable_id	data	                              read_at	created_at	updated_at	
                              dee29ded-b963-4c26       App\Notifications\LeaveNotify      App\Models\User     1              {"id":4,"title":"I am very tired"}  NULL
                              -8b41-cb129722fe38
                              dee29ded-b963-4c26       App\Notifications\LeaveNotify      App\Models\User     20              {"id":4,"title":"I am very tired"}  NULL
                              -8b41-cb129722fe38
                              dee29ded-b963-4c26       App\Notifications\LeaveNotify      App\Models\User     30              {"id":4,"title":"I am very tired"}  NULL
                              -8b41-cb129722fe38
                              dee29ded-b963-4c26       App\Notifications\LeaveNotify      App\Models\User     40              {"id":4,"title":"I am very tired"}  NULL
                              -8b41-cb129722fe38

                              cb1358d5-8829-4b64       App\Notifications\LeaveNotify      App\Models\User     1              {"id":4,"title":"I am very sick"}  NULL
                              -8317-026544ec9231

                              *connect "users" table with the notifiable_type, notifiable_id
                              *read_at null because it is not read yet.

                    =>Tagged User Notification
                         =In LeavesController.php
                              public function store(LeaveRequest $request)
                              {
                              ....
                                   $leave->save();
                                   
                                   session()->flash("success","New Leave Created");

                                   // $users = User::all();
                                   $tagperson = $leave->tagperson()->get();
                                   // dd($tagperson);

                                   Notification::send($tagperson,new LeaveNotify($leave->id,$leave->title));
                                   return redirect(route("leaves.index"));
                              }

                         *result($tagperson)

                              Illuminate\Database\Eloquent\Collection {#1467 ▼ // app\Http\Controllers\LeavesController.php:78
                              #items: array:1 [▼
                              0 => App\Models\User {#1466 ▼
                                   #connection: "mysql"
                                   #table: "users"
                                   #primaryKey: "id"
                                   #keyType: "int"
                                   +incrementing: true
                                   ....
                                   #attributes: array:8 [▶]
                                   #original: array:8 [▼
                                   "id" => 1
                                   "name" => "admin"
                                   "email" => "admin@gmail.com"
                                   "email_verified_at" => null
                                   "password" => "$2y$12$xffXPm7kidQvS4CgU8LThuAgkEb5otckKTMpVJtuDmrwFsmVApqh6"
                                   "remember_token" => "lIABpazPUorBPwSax8FUafdsSgK8QeJRVblsC5uNtDK9gNfqQtHzTqVGyRkm"
                                   "created_at" => "2023-12-12 07:27:33"
                                   "updated_at" => "2023-12-12 07:53:59"
                                   ]
                                   ....
                              }
                              ]
                              #escapeWhenCastingToString: false
                              }

                         *error 
                              App\Notifications\LeaveNotify::via(): Argument #1 ($notifiable) must be of type object, int given, called in
                              -if object is not passed ant other data type are given


               =>Step 4
                    #Accessing the Notifications

                    =In adminnavbar.blade.php
                         <!-- notify -->
                         <li class="nav-item dropdowns me-3">
                         <a href="javascript:void(0);" class="nav-link dropbtn" onclick="dropbtn(event)">
                              <i class="fas fa-bell"></i>
                              {{-- <span class="badge bg-danger">{{ $userdata->unreadNotifications->count() }}</span> --}}
                              <span class="badge bg-danger">{{ auth()->user()->unreadNotifications->count() }}</span>
                         </a>

                         <div class="dropdown-contents mydropdowns">
                              <a href="javascript:void(0);" class="small text-muted text-center">Mark all as read</a>
                              
                              @foreach($userdata->unreadNotifications as $notification)
                              <a href="javascript:void(0);" class="d-flex">
                                   <div class="me-3">
                                        <i class="fas fa-bell fa-xs text-primary"></i>
                                   </div>
                                   <div class="small">
                                        <ul class="list-unstyled">
                                             <li>{{ Str::limit($notification->data["title"],20) }}</li>
                                             <li>{{ $notification->created_at->format("d M Y h:i:s A") }}</li>
                                        </ul>
                                        
                                   </div>
                              </a>
                              @endforeach
                              

                              <a href="javascript:void(0);" class="small text-muted text-center">Show All Notification</a>
                         </div>
                         </li>
                         <!-- notify -->

                    =>Test with other users
                         =login in aung aung acc

                         =View notification 1 (from admin)
                         =create a leave
                         =View notification 2 (from admin and me)

                         *result
                              I want to take a lea...
                              26 Feb 2024 06:11:41 PM

                              I am very tired.
                              26 Feb 2024 04:55:46 PM

                         *last notification on the top

                         -----------------------------------

                         =login in admin acc
                         =View notification 3 (from aung aung and me) 1 + 2

          =>Notification link
               =In adminnavbar.php
                     @foreach($userdata->unreadNotifications as $notification)
                         <a href="{{ route('leaves.show',$notification->data['id']) }}" class="d-flex">
                              <div class="me-3">
                                   <i class="fas fa-bell fa-xs text-primary"></i>
                              </div>
                              <div class="small">
                                   <ul class="list-unstyled">
                                        <li>{{ Str::limit($notification->data["title"],20) }}</li>
                                        <li>{{ $notification->created_at->format("d M Y h:i:s A") }}</li>
                                   </ul>
                                   
                              </div>
                         </a>
                    @endforeach

                    -reach to the notification related leave.

          =>Notification with studentid 
               =In LeavesController.php
                    public function store(LeaveRequest $request)
                    {
                    ....
                         $leave->save();
                         
                         session()->flash("success","New Leave Created");

                         // $users = User::all();
                         $tagperson = $leave->tagperson()->get();
                         // dd($tagperson);

                         $studentid = $leave->student($user_id);

                         Notification::send($tagperson,new LeaveNotify($leave->id,$leave->title,$studentid));
                         return redirect(route("leaves.index"));
                    }
               
               =In LeaveNotify.php
                    public $tbid;
                    public $title;
                    public $studentid;
                    

                    public function __construct($id,$title,$studentid)
                    {
                         $this->tbid = $id;
                         $this->title = $title;
                         $this->studentid = $studentid;
                    }
                    ...
                    public function toArray(object $notifiable): array
                    {
                         return [
                              "id"=>$this->tbid,
                              "title"=>$this->title,
                              "studentid"=>$this->studentid
                         ];
                    }
               =In adminnavbar.php
                    @foreach($userdata->unreadNotifications as $notification)
                    <a href="{{ route('leaves.show',$notification->data['id']) }}" class="d-flex">
                         <div class="me-3">
                              <i class="fas fa-bell fa-xs text-primary"></i>
                         </div>
                         <div class="small">
                              <ul class="list-unstyled">
                                   <li>{{ $notification->data["studentid"] }}</li>
                                   <li>{{ Str::limit($notification->data["title"],20) }}</li>
                                   <li>{{ $notification->created_at->format("d M Y h:i:s A") }}</li>
                              </ul>
                              
                         </div>
                    </a>
                    @endforeach

               firstly, we got err
               *error (Undefined array key "studentid")
                    -because previous row do not have studentid info.
               *solution 
                    Truncate the notification table.

          =>#Using the Notifiable Trait
               Notifications may be sent in two ways: 
                    using the notify method of the Notifiable trait or 
                    using the Notification facade. 
               The Notifiable trait is included on your application's App\Models\User model by default:

               =In Leave.php
                    use Illuminate\Notifications\Notifiable;

                    class Leave extends Model
                    {
                         use HasFactory;
                         use Notifiable;
                         ....
                    }

          =>Reading Notification
               =In LeavesController.php
                    public function show(string $id)
                    {
                         $leave = Leave::findOrFail($id);
                         $getnoti = \DB::table("notifications")->where('data->id',$id)->pluck("id"); 
                         // dd($getnoti);
                         \DB::table("notifications")->where('id',$getnoti)->update(["read_at"=>now()]);
                         
                         return view("leaves.show",["leave"=>$leave]);
                    }

               *error
               Call to undefined method Illuminate\Notifications\Channels\MailChannel::where()
               $getnoti = \Notification::where('data->id',$id)->pluck("id"); 

               because Notification is not a regular model.
               
               *result ($getnoti)
                    Illuminate\Support\Collection {#1456 ▼ // app\Http\Controllers\LeavesController.php:90
                    #items: array:1 [▼
                    0 => "2a13bcb8-3be2-470e-88d4-47a25a6d8898"
                    ]
                    #escapeWhenCastingToString: false
                    }
               *indierctly get the Notification id and update it.

               "notifications"
                    id	                    type	                              notifiable_type     notifiable_id	data	                                                       read_at	          created_at	updated_at	
                    2a13bcb8-3be2-470e      App\Notifications\LeaveNotify      App\Models\User     1               {"id":9,"title":"I am very sick","studentid":"WDF1002"}     2024-02-28 16:50:44
                    -88d4-47a25a6d8898 

               ----
               *inspect query result (further study)
                    array:1 [▼ // app\Http\Controllers\LeavesController.php:92
                    0 => array:3 [▼
                    "query" => "select * from `notifications` where json_unquote(json_extract(`data`, '$."id"')) = ?"
                    "bindings" => array:1 [▶]
                    "time" => 46.63
                    ]
                    ]

               *mysql & json
                    mysql> SELECT event_id, browser_name->'$.name' AS browser FROM events;  

          =Mark as read
               #Marking Notifications as Read

               =In web.php
                    Route::resource("leaves",LeavesController::class);
                    Route::get("leaves/markasread",[LeavesController::class,"markasread"])->name('leaves.markasread');


               php artisan route:list
               
               *result
               GET|HEAD        leaves .................................................................... leaves.index › LeavesController@index  
               POST            leaves .................................................................... leaves.store › LeavesController@store  
               GET|HEAD        leaves/create ........................................................... leaves.create › LeavesController@create  
               GET|HEAD        leaves/markasread ............................................... leaves.markasread › LeavesController@markasread  
               GET|HEAD        leaves/{leaf} ............................................................... leaves.show › LeavesController@show  
               PUT|PATCH       leaves/{leaf} ........................................................... leaves.update › LeavesController@update  
               DELETE          leaves/{leaf} ......................................................... leaves.destroy › LeavesController@destroy  
               GET|HEAD        leaves/{leaf}/edit .......................................................... leaves.edit › LeavesController@edit  
                              
               =In LeavesController.php
                    public function markasread(){
                         dd("oki");
                    }

               =In adminnavbar.php
                     <div class="dropdown-contents mydropdowns">
                         <a href="{{ route('leaves.markasread') }}" class="small text-muted text-center">Mark all as read</a>
                         
                         @foreach($userdata->unreadNotifications as $notification)
               
               *error (404 | NOT FOUND)
               because of server architecture (route dividing technique)
               1 parameter 
                    GET leaves - index
                    POST leaves 
               2 parameter
                    GET leaves/create - create
               2 parameter - route parameter
                    leaves.show 
                    leaves.update
                    leaves.destroy

               --------------------------------------------------------------------------------------------------
               =In web.php
                    Route::resource("leaves",LeavesController::class);
                    Route::get("notify/markasread",[LeavesController::class,"markasread"])->name('leaves.markasread');

               php artisan route:list
               GET|HEAD        notify/markasread ............................................... leaves.markasread › LeavesController@markasread 
     
               =>Mark as read vs Delete Notification
                    =In LeavesController.php
                         public function markasread(){
                              $user = Auth::user();
                              $user_id = $user->id;

                              // $user->unreadNotifications->markAsRead();
                              // $user->notifications()->delete(); // all delete (r/un)

                              // $user = User::findOrFail($user_id);
                              $user = User::findOrFail(auth()->user()->id);
                              foreach ($user->unreadNotifications as $notification) {
                                   // $notification->markAsRead();

                                   $notification->delete(); // all delete (un)
                              }

                              return redirect()->back();
                         }
                    *if mark as read, notifications still remain in database table, it only update the time it was read.
                    *only delete the current authenticated notifications

                    =>Preventing DDoS Attack 
                         -come from bot (script)
                         -continuous click 
                         
                         =In adminnavbar.blade.php
                              @if($userdata->unreadNotifications->count() > 0)
                                   <a href="{{ route('leaves.markasread') }}" class="small text-muted text-center">Mark all as read</a>
                              
                                   @foreach($userdata->unreadNotifications as $notification)
                                   <a href="{{ route('leaves.show',$notification->data['id']) }}" class="d-flex">
                                        <div class="me-3">
                                             <i class="fas fa-bell fa-xs text-primary"></i>
                                        </div>
                                        <div class="small">
                                             <ul class="list-unstyled">
                                                  <li>{{ $notification->data["studentid"] }}</li>
                                                  <li>{{ Str::limit($notification->data["title"],20) }}</li>
                                                  <li>{{ $notification->created_at->format("d M Y h:i:s A") }}</li>
                                             </ul>
                                             
                                        </div>
                                   </a>
                                   @endforeach
                                   
                                   <a href="javascript:void(0);" class="small text-muted text-center">Show All Notification</a>
                              @else
                                   <a href="javascript:void(0);" class="small text-muted text-center">No New Notification</a>
                              @endif 

                         *user can mark as read or delete notification only if their notification exists 

          =>Multiple Notifications 
               =>Announcement

                    php artisan make:model Announcement -m

                    =>Migration 
                         =In create_announcements_table.php
                              $table->string("image")->nullable();
                              $table->string("title");
                              $table->longText("content");
                              $table->unsignedBigInteger("post_id")->nullable();
                              $table->unsignedBigInteger("user_id");
                    
                    php artisan migrate:status 
                    php artisan migrate


                    php artisan make:controller AnnouncementsController
     
                    =In AnnouncementsController.php
                         class AnnouncementsController extends Controller
                         {
                              public function index()
                              {
                                   $announcements = Announcement::all();
                                   return view("announcements.index",compact("announcements"));
                              }

                              public function create()
                              {    
                                   $posts = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->get()->pluck("title","id");

                                   return view("announcements.create",compact("posts"));
                              }


                              public function store(Request $request)
                              {
                                   $this->validate($request,[
                                        "image" => "image|mimes:jpg,jpeg,png|max:1024",
                                        "title" => "required|max:50",
                                        "content" => "required",  
                                   ]);

                                   $user = Auth::user();
                                   $user_id = $user->id;

                                   $announcement = new Announcement();
                                   $announcement->title = $request["title"];
                                   $announcement->post_id = $request["post_id"];
                                   $announcement->content = $request["content"];
                                   $announcement->user_id = $user_id;

                                   // Single Image Upload
                                   if(file_exists($request["image"])){
                                        $file = $request["image"];
                                        $fname = $file->getClientOriginalName();
                                        $imagenewname = uniqid($user_id).$announcement['id'].$fname;
                                        // $file->move(public_path("announcements/img"),$imagenewname);
                                        $file->move(public_path("assets/img/announcements"),$imagenewname);
                                        
                                        $filepath = "assets/img/announcements/".$imagenewname;
                                        $announcement->image = $filepath;
                                   }    
                                   $announcement->save();

                                   // $users = User::where("id","!=",$user_id)->get();
                                   $users = User::where("id","!=",auth()->user()->id)->get();
                                   // Notification::send($users,new AnnouncementNotify($announcement->id,$announcement->title,$announcement->image));
                                   // $users->notify(new AnnouncementNotify($announcement->id,$announcement->title,$announcement->image));
                                   session()->flash("success","Create Successfully");

                                   return redirect(route("announcements.index"));
                              }

                              public function show(string $id)
                              {
                                   $announcement = Announcement::findOrFail($id);
                                   $comments = $announcement->comments()->orderBy("updated_at","desc")->get();
                                   return view("announcements.show",["announcement"=>$announcement,"comments"=>$comments]);
                              }


                              public function edit(string $id)
                              {

                                   $announcement = Announcement::findOrFail($id);
                                   $posts = \DB::table("posts")->where("attshow",3)->orderBy("title","asc")->get()->pluck("title","id");

                                   return view("announcements.edit")->with("announcement",$announcement)->with("posts",$posts);
                              }

                              public function update(Request $request, string $id)
                              {
                                   $this->validate($request,[
                                        "image" => "image|mimes:jpg,jpeg,png|max:1024",
                                        "title" => "required|max:100",
                                        "content" => "required",
                                   ]);

                                   $user = Auth::user();
                                   $user_id = $user["id"];

                                   $announcement = Announcement::findOrFail($id);
                                   $announcement->title = $request["title"];
                                   $announcement->post_id = $request["post_id"];
                                   $announcement->content = $request["content"];
                                   $announcement->user_id = $user_id;


                                   // Remove Old Image
                                   if($request->hasFile("image")){
                                        $path = $announcement->image;

                                        if(File::exists($path)){
                                             File::delete($path);
                                        }
                                   }

                                   // Single Image Update
                                   if($request->hasFile("image")){
                                        $file = $request->file("image");
                                        $fname = $file->getClientOriginalName();
                                        $imagenewname = uniqid($user_id).$announcement['id'].$fname;
                                        $file->move(public_path("assets/img/announcements"),$imagenewname);
                                        
                                        $filepath = "assets/img/announcements/".$imagenewname;
                                        $announcement->image = $filepath;
                                   }    

                                   $announcement->save();
                                   session()->flash("success","Update Successfully");

                                   return redirect(route("announcements.index"));
                              }


                              public function destroy(string $id)
                              {
                                   $announcement = Announcement::findOrFail($id);
                                   
                                   // Remove Old Image
                                   $path = $announcement->image;
                                   if(File::exists($path)){
                                        File::delete($path);
                                   }
                                   
                                   $announcement->delete();

                                   session()->flash("info","Delete Successfully");
                                   return redirect()->back();
                              }
                         }

                    =In announcements > create.blade.php
                         <form action="/announcements" method="POST" enctype="multipart/form-data">
                              @csrf

                              <div class="row">

                                   <div class="col-md-4">

                                        <div class="row">
                                             <div class="col-md-12 mb-3">
                                                  <label for="image" class="gallery"><span>Choose Images</span></label>
                                                  <input type="file" name="image" id="image" class="form-control form-control-sm rounded-0" value="{{ old('image')}}" hidden/>
                                                  @error("image")
                                                       <span class="text-danger">{{ $message }}<span>
                                                  @enderror
                                             </div>

                                        </div>
                                        
                                   </div>

                                   <div class="col-md-8">
                                        <div class="row">
                                             

                                             <div class="col-md-6 mb-3">
                                                  <label for="title">Title <span class="text-danger">*</span></label>
                                                  <input type="text" name="title" id="title" class="form-control form-control-sm rounded-0" placeholder="Enter Title" value="{{ old('title') }}"/>
                                                  @error("title")
                                                       <span class="text-danger">{{ $message }}<span>
                                                  @enderror
                                             </div>

                                             <div class="col-md-6 mb-3">
                                                  <label for="post_id">Class <span class="text-danger">*</span></label>
                                                  <select name="post_id" id="post_id" class="form-control form-control-sm rounded-0">
                                                       <option value="" selected disabled>Choose Class</option>
                                                       @foreach($posts as $id=>$title)
                                                            <option value="{{$id}}">{{ $title }}</option>
                                                       @endforeach
                                                  </select>
                                                  @error("tag_id")
                                                       <span class="text-danger">{{ $message }}<span>
                                                  @enderror
                                             </div>     

                                             <div class="col-md-12 mb-3">
                                                  <label for="content">Content <span class="text-danger">*</span></label>
                                                  <textarea name="content" id="content" class="form-control form-control-sm rounded-0" rows="5" placeholder="Say Something....">{{ old('content') }}</textarea>
                                                  @error("content")
                                                       <span class="text-danger">{{ $message }}<span>
                                                  @enderror
                                             </div>

                                             <div class="col-md-12 d-flex justify-content-end align-items-end">
                                                  <div class="">
                                                       <a href="{{route('announcements.index')}}" class="btn btn-secondary btn-sm rounded-0 me-3">Cancel</a>
                                                       <button type="submit" class="btn btn-primary btn-sm rounded-0">Submit</button>
                                                  </div>
                                             </div>
                                        </div>
                                   </div>

                                   
                              </div>
                         </form>

                    =In announcements > index.blade.php
                         <table id="mytable" class="table table-sm table-hover border">
          
                              <thead>
                                   <th>No</th>
                                   <th>Title</th>
                                   <th>Class</th>
                                   <th>By</th>
                                   <th>Created At</th>
                                   <th>Updated At</th>
                                   <th>Action</th>
                              </thead>
                    
                              <tbody>
                                   @foreach($announcements as $idx=>$announcement)
                                   <tr>
                                        <td>{{++$idx}}</td>
                                        <td><img src="{{ asset($announcement->image) }}" class="rounded-circle" alt="{{$announcement->title}}" width="20" height="20"/> <a href="{{route('announcements.show',$announcement->id)}}">{{ Str::limit($announcement->title,20) }}</a></td>
                                        <td><a href="{{ route('posts.show',$announcement->post_id) }}">{{ $announcement->post["title"] }}</a></td>
                                        <td>{{ $announcement->user["name"] }}</td>
                                        <td>{{ $announcement->created_at->format('d M Y') }}</td>
                                        <td>{{ $announcement->updated_at->format('d M Y') }}</td>
                                        <td>
                                             <a href="{{ route('announcements.edit',$announcement->id) }}" class="text-info"><i class="fas fa-pen"></i></a>
                                             <a href="#" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a>
                                        </td>
                                        <form id="formdelete-{{ $idx }}" class="" action="{{route('announcements.destroy',$announcement->id)}}" method="POST">
                                             @csrf
                                             @method("DELETE")
                                        </form>
                                   </tr>
                                   @endforeach
                              </tbody>
                         </table>

                    =In announcements > edit.blade.php
                         <form action="/announcements/{{$announcement->id}}" method="POST" enctype="multipart/form-data">
                              @csrf
                              @method("PUT")

                              <div class="row">

                                   <div class="col-md-4">

                                        <div class="row">
                                             <div class="col-md-12 mb-3">

                                                  <div class="row">
                                                       <div class="col-md-6 text-sm-center">
                                                            <img src="{{asset($announcement->image)}}" width="200" alt="{{$announcement->title}}"/>
                                                       </div>
                                                       <div class="col-md-6">
                                                            <label for="image" class="gallery"><span>Choose Images</span></label>
                                                            <input type="file" name="image" id="image" class="form-control form-control-sm rounded-0" value="{{ $announcement->image }}" hidden/>
                                                       </div>
                                                  </div>
                                             </div>

                                        </div>
                                        
                                   </div>

                                   <div class="col-md-8">
                                        <div class="row">
                                             
                                             <div class="col-md-6 mb-3">
                                                  <label for="title">Title <span class="text-danger">*</span></label>
                                                  <input type="text" name="title" id="title" class="form-control form-control-sm rounded-0" placeholder="Enter Post Title" value="{{ $announcement->title }}"/>
                                             </div>

                                             <div class="col-md-6">
                                                  <label for="post_id">Class <span class="text-danger">*</span></label>
                                                  <select name="post_id" id="post_id" class="form-control form-control-sm rounded-0">
                                                       @foreach($posts as $id=>$title)
                                                            <option value="{{$id}}"
                                                                 @if($id === $announcement["post_id"])
                                                                      selected
                                                                 @endif
                                                            >{{ $title }}</option>
                                                       @endforeach
                                                  </select>
                                             </div>

                                             <div class="col-md-12 mb-3">
                                                  <label for="content">Content <span class="text-danger">*</span></label>
                                                  <textarea name="content" id="content" class="form-control form-control-sm rounded-0" rows="5" placeholder="Say Something....">{{$announcement->content}}</textarea>
                                             </div>

                                             

                                        
                                             <div class="col-md-12 d-flex justify-content-end align-items-end">
                                                  <div class="">
                                                       <a href="{{route('announcements.index')}}" class="btn btn-secondary btn-sm rounded-0 me-3">Cancel</a>
                                                       <button type="submit" class="btn btn-primary btn-sm rounded-0">Submit</button>
                                                  </div>
                                             </div>
                                        </div>
                                   </div>

                                   
                              </div>
                         </form>

                    =In announcements > show.blade.php
                         <div class="row">
               
                              <div class="col-md-4">
                                   <h6>Info</h6>
                                   <div class="card border-0 rounded-0 shadow">
                                        <div class="card-body">
                                             <div class="d-flex flex-column align-items-center mb-3">
                                                  <div class="h5 mb-1">{{ $announcement->title }} </div>
                                                  <div class="text-muted">
                                                       <span>{{ $announcement->post["title"] }}</span>
                                                  </div>
                                                  <img src="{{ asset($announcement->image) }}" class="" alt="{{$announcement->title}}" width="200"/>
                                             </div>

                                             <div class="w-100 d-flex flex-row justify-content-between mb-3">
                                                       <a href="#createmodal" class="w-100 btn btn-primary btn-sm rounded-0 me-2" data-bs-toggle="modal">Enroll</a>
                                                       <button type="button" class="w-100 btn btn-outline-primary btn-sm rounded-0">Follow</button>
                                             </div>

                                             <div class="mb-5">
                                        
                                                  <div class="row g-0 mb-2">
                                                       <div class="col-auto">
                                                            <i class="fas fa-user"></i>
                                                       </div>
                                                       <div class="col ps-3">
                                                            <div class="row">
                                                                 <div class="col">
                                                                      <div class="">By</div>
                                                                 </div>
                                                                 <div class="col-auto">
                                                                      <div class="">{{ $announcement["user"]["name"] }}</div>
                                                                 </div>
                                                            </div>
                                                       </div>
                                                  </div>

                                                  <div class="row g-0 mb-2">
                                                       <div class="col-auto">
                                                            <i class="fas fa-calendar-alt fa-sm"></i>
                                                       </div>
                                                       <div class="col ps-3">
                                                            <div class="row">
                                                                 <div class="col">
                                                                      <div class="">Created</div>
                                                                 </div>
                                                                 <div class="col-auto">
                                                                      <div class="">{{date('d M Y',strtotime($announcement->created_at))}} | {{date('h:i:s A',strtotime($announcement->created_at))}}</div>
                                                                 </div>
                                                            </div>
                                                       </div>
                                                  </div>

                                                  <div class="row g-0 mb-2">
                                                       <div class="col-auto">
                                                            <i class="fas fa-edit fa-sm"></i>
                                                       </div>
                                                       <div class="col ps-3">
                                                            <div class="row">
                                                                 <div class="col">
                                                                      <div class="">Updated</div>
                                                                 </div>
                                                                 <div class="col-auto">
                                                                      <div class="">{{date('d M Y h:i:s A',strtotime($announcement->updated_at))}}</div>
                                                                 </div>
                                                            </div>
                                                       </div>
                                                  </div>
                                             </div>

                                             <div class="mb-5">
                                                  <p class="text-small text-muted text-uppercase mb-2">Contact Info</p>
                                                  <div class="row g-0 mb-2">
                                                       <div class="col-auto me-2">
                                                            <i class="fas fa-calender-alt"></i>
                                                       </div>
                                                       <div class="col">Sample Data</div>
                                                  </div>
                                                  <div class="row g-0 mb-2">
                                                       <div class="col-auto me-2">
                                                            <i class="fas fa-calender-alt"></i>
                                                       </div>
                                                       <div class="col">Sample Data</div>
                                                  </div>
                                                  <div class="row g-0 mb-2">
                                                       <div class="col-auto me-2">
                                                            <i class="fas fa-calender-alt"></i>
                                                       </div>
                                                       <div class="col">Sample Data</div>
                                                  </div>
                                                  <div class="row g-0 mb-2">
                                                       <div class="col-auto me-2">
                                                            <i class="fas fa-calender-alt"></i>
                                                       </div>
                                                       <div class="col">Sample Data</div>
                                                  </div>
                                             </div>
                                        </div>
                                   </div>
                              </div>

                              <div class="col-md-8">
                                   <h6>Comments</h6>
                                   <div class="card border-0 rounded-0 shadow mb-4">
                                        <div class="card-body d-flex flex-wrap gap-3">
                                             
                                             <div class="col-md-12">
                                                  <div class="card rounded-0">
                                                       <div class="card-body">
                                                            <ul class="list-group chat-boxs">
                                                                 @foreach($comments as $comment)
                                                                      <li class="list-group-item mt-2">
                                                                           <div>
                                                                                <p>{{$comment->description}}</p>
                                                                           </div>
                                                                           <div>
                                                                                <span class="small fw-bold  float-end">{{$comment->user["name"] }} | {{$comment->created_at->diffForHumans()}}</span>
                                                                                
                                                                           </div>
                                                                           
                                                                      </li>
                                                                 @endforeach
                                                            </ul>
                                                       </div>
                                                       <div class="card-body border-top">
                                                            <form action="{{route('comments.store')}}" method="POST">
                                                                 @csrf
                                                                 <div class="col-md-12 d-flex justify-between">
                                                                      <textarea name="description" id="description"  class="form-control border-0 rounded-0" rows="1" style="resize:none;" placeholder="Comment here...."></textarea>
                                                                      <button type="submit" class="btn btn-info btn-sm text-light ms-3"><i class="fas fa-paper-plane"></i></button>
                                                                 </div>

                                                                 <!-- Start Hidden Fields -->
                                                                 <input type="hidden" name="commentable_id" id="commentable_id" value="{{$announcement->id}}" />
                                                                 <input type="hidden" name="commentable_type" id="commentable_type" value="App\Models\Announcement" />
                                                                 <!-- Start Hidden Fields -->

                                                            </form>
                                                       </div>
                                                  </div>    
                                             </div>
                                        </div>
                                   </div>

                                   <h6>Additional Info</h6>
                                   <div class="card border-0 rounded-0 shadow mb-4">
                                        <ul class="nav">
                                             <li class="nav-item">
                                                  <button type="button" id="autoclick" class="tablinks" onclick="gettab(event,'content')">Follower</button>
                                             </li>
                                        </ul>

                                        <div class="tab-content">

                                             <div id="content" class="tab-pane">
                                                  <p>{!! $announcement->content !!}</p>
                                             </div>

                                        </div>
                                   </div>
                              </div>
                         </div>
                    
                    =In Announcement.php
                         <?php

                         namespace App\Models;

                         use Illuminate\Database\Eloquent\Factories\HasFactory;
                         use Illuminate\Database\Eloquent\Model;
                         use Illuminate\Notifications\Notifiable;
                         class Announcement extends Model
                         {
                         use HasFactory,Notifiable;
                         
                         protected $table = "announcements";
                         protected $primaryKey = "id";
                         protected $fillable = [
                              "image",
                              "title",
                              "content",
                              "post_id",
                              "user_id"
                         ];

                         public function post(){
                              return $this->belongsTo(Post::class);
                         }

                         public function user(){
                              return $this->belongsTo(User::class);
                         }

                         public function comments(){
                              return $this->morphMany(Comment::class,"commentable");
                         }

                         }

               =>Announcement Notification 
                    php artisan make:notification AnnouncementNotify

                    =In AnnouncementNotify.php
                         <?php

                         namespace App\Notifications;

                         use Illuminate\Bus\Queueable;
                         use Illuminate\Contracts\Queue\ShouldQueue;
                         use Illuminate\Notifications\Messages\MailMessage;
                         use Illuminate\Notifications\Notification;

                         class AnnouncementNotify extends Notification
                         {
                         use Queueable;

                         protected $tbid;
                         protected $title;
                         protected $img;
                         public function __construct($id,$title,$img)
                         {
                              $this->tbid = $id;
                              $this->title = $title;
                              $this->img = $img;
                         }

                         public function via(object $notifiable): array
                         {
                              return ['database'];
                         }

                         public function toArray(object $notifiable): array
                         {
                              return [
                                   "id" => $this->tbid,
                                   "title" => $this->title,
                                   "img" => $this->img
                              ];
                         }
                         }

                    *error (Undefined array key "studentid")
                    -because Announcement Notification do not contain studentid info.
                    and Leave Notification do not contain image info.
                    -error at the side of admin not the person who create announcement.

                    =In adminnavbar.blade.php
                              <!-- notify -->
                              <li class="nav-item dropdowns me-3">
                                   <a href="javascript:void(0);" class="nav-link dropbtn" onclick="dropbtn(event)">
                                        <i class="fas fa-bell"></i>
                                        {{-- <span class="badge bg-danger">{{ $userdata->unreadNotifications->count() }}</span> --}}
                                        <span class="badge bg-danger">{{ auth()->user()->unreadNotifications->count() }}</span>
                                   </a>

                                   <div class="dropdown-contents mydropdowns">
                                   
                                        @if($userdata->unreadNotifications->count() > 0)
                                             <a href="{{ route('leaves.markasread') }}" class="small text-muted text-center">Mark all as read</a>
                                        
                                             @foreach($userdata->unreadNotifications as $notification)
                                             <a href="{{ route('leaves.show',$notification->data['id']) }}" class="d-flex">
                                                  <div class="me-3">
                                                       @if($notification->type === "App\Notifications\AnnouncementNotify")
                                                       <img src="{{ $notification->data['img'] }}" class="rounded-circle" width="30" alt="{{ $notification->data['id'] }}">
                                                       @else
                                                       <i class="fas fa-bell fa-xs text-primary"></i>
                                                       @endif
                                                  </div>
                                                  <div class="small">
                                                       <ul class="list-unstyled">
                                                       @if($notification->type == "App\Notifications\AnnouncementNotify")
                                                            <li>{{ Str::limit($notification->data["title"],20) }}</li>
                                                            <li>{{ $notification->created_at->format("d M Y h:i:s A") }}</li>
                                                       @else
                                                            <li>{{ $notification->data["studentid"] }}</li>
                                                            <li>{{ Str::limit($notification->data["title"],20) }}</li>
                                                            <li>{{ $notification->created_at->format("d M Y h:i:s A") }}</li>
                                                       </ul>
                                                       @endif
                                                  </div>
                                             </a>
                                             @endforeach
                                             
                                             <a href="javascript:void(0);" class="small text-muted text-center">Show All Notification</a>
                                        @else
                                             <a href="javascript:void(0);" class="small text-muted text-center">No New Notification</a>
                                        @endif 
                                   
                                        
                                   </div>
                              </li>
                              <!-- notify -->

                    *Notify only to the specific class should implement.

               =>Multiple Notifiation Links
                    @foreach($userdata->unreadNotifications as $notification)
                         <a href="{{ route($notification->type === 'App\Notifications\AnnouncementNotify'?'announcements.show':'leaves.show',$notification->data['id']) }}" class="d-flex">
                    ....       
               =>Reading Multiple Notifications
                    =In AnnouncementsController.php
                         public function show(string $id)
                         {   
                              $user = Auth::user();
                              $user_id = $user->id;

                              $announcement = Announcement::findOrFail($id);
                              $comments = $announcement->comments()->orderBy("updated_at","desc")->get();
                              
                              $type = "App\Notifications\AnnouncementNotify";
                              $getnoti = \DB::table("notifications")->where("notifiable_id",$user_id)->where("type",$type)->where('data->id',$id)->pluck('id');
                              // dd($getnoti);
                              \DB::table("notifications")->where('id',$getnoti)->update(["read_at"=>now()]);
                         
                              return view("announcements.show",["announcement"=>$announcement,"comments"=>$comments]);
                         }

                    =In LeavesController.php
                         public function show(string $id)
                         {
                              $leave = Leave::findOrFail($id);
                              $type = "App\Notifications\LeaveNotify";
                              $getnoti = \DB::table("notifications")->where("notifiable_id",$user_id)->where("type",$type)->where('data->id',$id)->pluck('id');
                              // dd($getnoti);
                              \DB::table("notifications")->where('id',$getnoti)->update(["read_at"=>now()]);
                              
                              return view("leaves.show",["leave"=>$leave]);
                         }


                    *result ($getnoti) - before checking conditions 
                    Illuminate\Support\Collection {#296 ▼ // app\Http\Controllers\AnnouncementsController.php:77
                    #items: array:3 [▼
                    0 => "0448356d-9b2e-4e1a-a156-ea0426b0d2ed"
                    1 => "9342f82e-40bd-4d4a-a612-f35dee6d2aa0"
                    2 => "bd6020e0-dfcf-4b55-9041-2dc57cb8c812"
                    ]
                    #escapeWhenCastingToString: false
                    }

                    "notifications"
                    id	                    type	                                        notifiable_type     notifiable_id	data	                                                                                                         read_at	          created_at	updated_at	
                    0448356d-9b2e-4e1a       App\Notifications\AnnouncementNotify         App\Models\User     20              {"id":25,"title":"announcement three","img":"assets\/img\/announcements\/165e59eca614cfagen-s-3-1.jpg"}       NULL
                    -a156-ea0426b0d2ed
                    0448356d-9b2e-4e1a       App\Notifications\AnnouncementNotify         App\Models\User     30              {"id":25,"title":"announcement three","img":"assets\/img\/announcements\/165e59eca614cfagen-s-3-1.jpg"}       NULL
                    -a156-ea0426b0d2ed 
                    0448356d-9b2e-4e1a       App\Notifications\AnnouncementNotify         App\Models\User     40              {"id":25,"title":"announcement three","img":"assets\/img\/announcements\/165e59eca614cfagen-s-3-1.jpg"}       NULL
                    -a156-ea0426b0d2ed      

                    ---------------------------------------------------------------------------------------------------
                    *result ($getnoti) - before checking conditions 
                    Illuminate\Support\Collection {#296 ▼ // app\Http\Controllers\AnnouncementsController.php:80
                    #items: array:2 [▼
                    0 => "491d087c-8e77-4577-a8f3-88bb17401765"
                    1 => "ea23f1ae-5fc0-4c80-8fb4-fc35e36c6eed"
                    ]
                    #escapeWhenCastingToString: false
                    }

                    "notifications"          
                    id                       notifiable_type     type                                    notifiable_id  data
                    ea23f1ae-5fc0-4c80       App\Models\User     App\Notifications\LeaveNotify           20             {"id":22,"title":"I am very sick","studentid":"WDF1002"}
                    -8fb4-fc35e36c6eed       
                    491d087c-8e77-4577       App\Models\User     App\Notifications\AnnouncementNotify    20             {"id":22,"title":"announcement one","img":null}
                    -a8f3-88bb17401765
                    __________________________________________________________________________________________________________
                    conditions > 
                         users
                         type   
                    *however notification id is '25', it can be other user's notification or other kind of notification. 

                    *must select only one notification related to user.

                    *result ($getnoti) - after checking conditions
                         Illuminate\Support\Collection {#296 ▼ // app\Http\Controllers\AnnouncementsController.php:81
                         #items: array:1 [▼
                         0 => "602bad4d-9fab-4396-90db-fcfbc710e3c1"
                         ]
                         #escapeWhenCastingToString: false
                         }
     =>Email Notification 
          Email Service Providers 
               mailpit
               mailgun 
               aws 
               alibaba
               mailtrap **
               sendgrid (https://docs.sendgrid.com/for-developers/sending-email/laravel)

          =>mailtrap     
               https://mailtrap.io/
               =sign up an account 

               https://mailtrap.io/home
               Email Testing 
               Email Sending 

               Email Testing
                    -for testing purpose (checking email template and delivery)  
                    -with fake server 

               Email Sending
                    -send email by the domain name
                    admin@dlt.com

               Email Testing > Inboxes > My Inbox 
                    =SMTP Settings > Show Credentials >
                         SMTP
                         Host:
                         sandbox.smtp.mailtrap.io
                         Port:
                         25 or 465 or 587 or 2525
                         Username:
                         a77caaa1571414
                         Password:
                         1dc9eaa9d53358
                         Auth:
                         PLAIN, LOGIN and CRAM-MD5
                         TLS:
                         Optional (STARTTLS on all ports)
                    *SMTP - Email Sending Protocol

                    =SMTP Settings > Reset Credentials

          =In .env 
               MAIL_MAILER=smtp
               MAIL_HOST=sandbox.smtp.mailtrap.io
               MAIL_PORT=2525
               MAIL_USERNAME=a77caaa1571414
               MAIL_PASSWORD=1dc9eaa9d53358
               MAIL_ENCRYPTION=tls
               MAIL_FROM_ADDRESS="yuzanapalaza@gmail.com"
               MAIL_FROM_NAME="${APP_NAME}"

               *mail trap provided host,port,username,password,encryption are used.
               *address is just naming of mailing address.
                    It can be fake address.
                    *Many BitCoins are stolen by this method.
                    *Lesson Learned 
                         -should check detail of an email.
                              =Example from gmail.
                                   from:	mpt-invoice@stt.mpt.com.mm
                                   to:	thoonlay779@gmail.com
                                   date:	Feb 6, 2024, 10:37 PM
                                   subject:	MPT e-invoice notification
                                   mailed-by:	eu-west-1.amazonses.com
                                   signed-by:	stt.mpt.com.mm
                                   security:	 Standard encryption (TLS) Learn more
                                   -------------------------------------------------------------------------
                                   from:	Myanmar-Passport-Issuing-Office <no-reply@passport.gov.mm>
                                   to:	thoonthoon469@gmail.com
                                   date:	Feb 16, 2024, 9:19 AM
                                   subject:	Appointment Letter
                                   mailed-by:	passport.gov.mm
                                   signed-by:	passport.gov.mm
                                   security:	 Standard encryption (TLS) Learn more
                              
                         -don't trust easily.

          php artisan config:clear
          php artisan  config:cache
          php artisan cache:clear
          php artisan route:clear
          php artisan route:cache


          php artisan make:notification ContactEmailNotify
          *Notification file format

          =In Contact.php
               use Illuminate\Notifications\Notifiable;

               class Contact extends Model
               {
               use HasFactory,Notifiable;
               ....
               }

          =>Laravel Documentation
               #Mail Notifications
                    #Formatting Mail Messages

               /**
               * Get the mail representation of the notification.
               */
               public function toMail(object $notifiable): MailMessage
               {
               $url = url('/invoice/'.$this->invoice->id);
               
               return (new MailMessage)
                              ->greeting('Hello!')
                              ->line('One of your invoices has been paid!')
                              ->lineIf($this->amount > 0, "Amount paid: {$this->amount}")
                              ->action('View Invoice', $url)
                              ->line('Thank you for using our application!');
               }
          
          =In ContactsController.php
               public function store(Request $request)
               {
                    ....

                    $contact->save();

                    $contactdata = [
                         "firstname" => $contact->firstname,
                         "lastname" => $contact->lastname,
                         "birthday" => $contact->birthday,
                         "relative" => $contact->relative["name"],
                         "url"=>url("/")
                    ];
                    Notification::send($user,new ContactEmailNotify($contactdata));

                    session()->flash("success","New Contact Created");
                    return redirect(route("contacts.index"));
               }

          =In ContactEmailNotify.php
               <?php

               namespace App\Notifications;

               use Illuminate\Bus\Queueable;
               use Illuminate\Contracts\Queue\ShouldQueue;
               use Illuminate\Notifications\Messages\MailMessage;
               use Illuminate\Notifications\Notification;

               class ContactEmailNotify extends Notification
               {
               use Queueable;

               private $data;

               /**
                    * Create a new notification instance.
                    */
               public function __construct($data)
               {
                    $this->data = $data;
               }

               /**
                    * Get the notification's delivery channels.
                    *
                    * @return array<int, string>
                    */
               public function via(object $notifiable): array
               {
                    return ['mail'];
               }

               /**
                    * Get the mail representation of the notification.
                    */
               public function toMail(object $notifiable): MailMessage
               {
                    return (new MailMessage)
                                   ->greeting("New Contact Created")
                                   ->line('Full Name : '.$this->data["firstname"]." ".$this->data["lastname"])
                                   ->line('Birth Date : '.$this->data["birthday"])
                                   ->line("Relative : {$this->data["relative"]}")
                                   ->action('Visit Site', $this->data["url"])
                                   ->line('Thank you for using our application!');
               }

               /**
                    * Get the array representation of the notification.
                    *
                    * @return array<string, mixed>
                    */
               public function toArray(object $notifiable): array
               {
                    return [
                         //
                    ];
               }
               }

               *line = text
               action = button

               *Email Notofication actually send email as a notification not actual email.
               Laravel already create template for email notification so follow the framework.

          =Viewing mailtrap inbox
               Inboxes > My Inbox > Contact Email Notify

               =>Email View 
                    =Create a contact with admin account
                         Contact Email Notify

                         From:DLT Student Management Project <yuzanapalaza@gmail.com>
                         To: <admin@gmail.com>

                         Show Headers > 
                         Date                Mon, 04 Mar 2024 19:48:57 +0630
                         From                DLT Student Management Project <yuzanapalaza@gmail.com>
                         To                  admin@gmail.com
                         Bcc                 Available on Enterprise, Premium, Business, and Team plans. 
                         Subject             Contact Email Notify
                    
                    =Create a contact with aung aung account
                         Contact Email Notify

                         From:DLT Student Management Project <yuzanapalaza@gmail.com>
                         To: <aungaung@gmail.com>

               =>Email Notification Template

               *Automatically create Subject From Notification file name
               *Automatically create Mailer Name From Application name 
               *Send to the current authenticated user email account 

     =>Sending Email Notification By Gmail

          *Gmail Risk 
               =Gmail password leak from .env file (It is not serious because we don't need to give actual gmail password for now)
               =can send to the spam
                    -solution: ssl certificate for the website
               
          =>Gmail Ingetrage (1.port forward,2.app password)
               =>IMAP On
                    Gmail > Setting Icon > See all settings > Forwarding and POP/IMAP >

                    IMAP access:   Status: IMAP is disabled
                                   *Enable IMAP
                                   Disable IMAP


                    *IMAP (Internet Management Access Protocol)
                    *Allow to gmail from own server, not gmail server
                         It is email forwarding.
                         Like message forwarding.We can forward other user's message.
                         Send email reach to the gmail and gmail transmit the mail to the user.
                    
               =>Creating Virtual Password
                    Gmail > Profile Icon > Magane Your Google Account > Security
                    2-Step Verification (Needed to on)
                         *for stronger security
                         -preventing attackers from hacking password by exploiting virtual password
                    
                    App passwords >s
                    App Name  - DLT Student Maganement Project
                    =Copy the password
          
          =In .env 
               # MAIL_MAILER=smtp
               # MAIL_HOST=sandbox.smtp.mailtrap.io
               # MAIL_PORT=2525
               # MAIL_USERNAME=a77caaa1571414
               # MAIL_PASSWORD=1dc9eaa9d53358
               # MAIL_ENCRYPTION=tls
               # MAIL_FROM_ADDRESS="yuzanapalaza@gmail.com"
               # MAIL_FROM_NAME="${APP_NAME}"

               MAIL_MAILER=smtp
               MAIL_HOST=smtp.gmail.com
               MAIL_PORT=587
               MAIL_USERNAME=thoonthoon469@gmail.com
               MAIL_PASSWORD="qstl fdqu mosh tsrk"
               MAIL_ENCRYPTION=tls
               MAIL_FROM_ADDRESS=thoonthoon469@gmail.com
               MAIL_FROM_NAME="${APP_NAME}"

          =>Other Person Inbox 
               "users"
                    id     name           email
                    20     aung aung      thoonlay779@gmail.com
               
               =logout aung aung
               =create a contact with "aung aung" account

               =>Gmail View
                    =from user email (thoonlay779@gmail.com)
                         DLT Student Management Project                    5:09 PM (4 minutes ago)
                         to me

                         from:	DLT Student Management Project <thoonthoon469@gmail.com>
                         to:	thoonlay779@gmail.com
                         date:	Mar 5, 2024, 5:09 PM
                         subject:	Contact Email Notify
                         mailed-by:	gmail.com
                         signed-by:	gmail.com
                         security:	 Standard encryption (TLS) Learn more
                    *Email are in the prmary inbox not in spam 

                    =from admin email (thoonthoon469@gmail.com)
                         DLT Student Management Project <thoonthoon469@gmail.com>    5:09 PM (14 minutes ago)
                         to thoonlay779

                         from:	DLT Student Management Project <thoonthoon469@gmail.com>
                         to:	thoonlay779@gmail.com
                         date:	Mar 5, 2024, 5:09 PM
                         subject:	Contact Email Notify
                         mailed-by:	gmail.com
                    *Email are in the Send box

     =>Email Sending Feature 
          =>Email Box
               -use ui accordion design from l1accordion
               
               =In students > show.blade.php
                    <div class="col-md-8 col-lg-9">
                         <h6>Compose</h6>
                         <div class="card border-0 rounded-0 shadow mb-4">
                              <div class="card-body">
                                   <div class="accordion">
                                        <div class="acctitle shown">Email</div>
                                        <div class="acccontent">
                                             <div class="col-md-12 py-3">
                                                  <form action="" method="">
                                                       @csrf
                                                       <div class="row">
                                                            <div class="col-md-6 form-group mb-3">
                                                                 <input type="email" name="cmpemail" id="cmpemail" class="form-control form-control-sm border-0 rounded-0" placeholder="To:" value="" />
                                                            </div>
                                                            <div class="col-md-6 form-group mb-3">
                                                                 <input type="ext" name="cmpsubject" id="cmpsubject" class="form-control form-control-sm border-0 rounded-0" placeholder="Subject" value="" />
                                                            </div>
                                                            <div class="col-md-12 form-group mb-3">
                                                                 <textarea name="cmpcontent" id="cmpcontent" class="form-control form-control-sm border-0 rounded-0" style="resize:none;" rows="3" placeholder="Your message here...."></textarea>
                                                            </div>

                                                            <div class="col d-flex justify-content-end align-items-end">
                                                                 <button type="submit" class="btn btn-secondary btn-sm rounded-0">Send</button>
                                                            </div>

                                                       </div>
                                                  </form>
                                             </div>
                                        </div>
                                   </div>
                              </div>
                         </div>
                         ....
                    </div>
                    ....
                    @section("css")
                    <style type="text/css">
                         /* Start Accordion */
                              .accordion{
                              width: 100%;
                              }
                              .acctitle{
                              font-size: 13px;
                              user-select: none;

                              padding: 5px;
                              margin: 0;

                              cursor: pointer;

                              user-select: none;

                              position: relative;
                              }
                              .acctitle::after{
                              content: '\f0e0';
                              font-family: 'Font Awesome 5 Free';

                              /* position: absolute;
                              right: 15px;
                              top: 50%;
                              transform: translateY(-50%); */

                              float: right;
                              }
                              /* .active.acctitle::after{
                              content: '\f068';
                              } */
                              .shown::after{
                              content: '\f2B6';
                              }
                              .acccontent{
                              height: 0;
                              background-color: #f4f4f4;
                              text-align: justify;

                              padding: 0 10px;

                              overflow: hidden;

                              transition: height 0.3s ease-in-out;
                              }
                         /* End Accordion */
                    ....
                    // Start Accordion
                    var getacctitles = document.getElementsByClassName('acctitle');
                    // console.log(getacctitles);
                    var getacccontents = document.querySelectorAll('.acccontent');
                    // console.log(getacccontents);


                    for(var x = 0 ; x < getacctitles.length ; x++){
                    
                    getacctitles[x].addEventListener('click',function(e){
                         // console.log(e.target);
                         // console.log(this);

                         this.classList.toggle('shown');

                         var getcontent = this.nextElementSibling;
                         // console.log(getcontent);

                         if(getcontent.style.height){
                              getcontent.style.height = null; //beware can't set 0
                         }else{
                              // console.log(getcontent.scrollHeight);
                              getcontent.style.height = getcontent.scrollHeight + 'px';
                         }
                    });

                    if(getacctitles[x].classList.contains('shown')){
                         getacccontents[x].style.height = getacccontents[x].scrollHeight + 'px';
                    }
                    }
                    // End Accordion

               -customer service staff can use this feature to easily communicate with users.

          =>Auto Filing Email Address
               =In students > show.blade.php
                    <div class="col-md-6 form-group mb-3">
                         <input type="email" name="cmpemail" id="cmpemail" class="form-control form-control-sm border-0 rounded-0" placeholder="To:" value="{{ $student->user['email'] }}" readonly />
                    </div>

          php artisan make:mail MailBox
          app > Mail > MailBox.php

          =>Original MailBox.php
               <?php

               namespace App\Mail;

               use Illuminate\Bus\Queueable;
               use Illuminate\Contracts\Queue\ShouldQueue;
               use Illuminate\Mail\Mailable;
               use Illuminate\Mail\Mailables\Content;
               use Illuminate\Mail\Mailables\Envelope;
               use Illuminate\Queue\SerializesModels;

               class MailBox extends Mailable
               {
               use Queueable, SerializesModels;

               /**
                    * Create a new message instance.
                    */
               public function __construct()
               {
                    //
               }

               /**
                    * Get the message envelope.
                    */
               public function envelope(): Envelope
               {
                    return new Envelope(
                         subject: 'Mail Box',
                    );
               }

               /**
                    * Get the message content definition.
                    */
               public function content(): Content
               {
                    return new Content(
                         view: 'view.name',
                    );
               }

               /**
                    * Get the attachments for the message.
                    *
                    * @return array<int, \Illuminate\Mail\Mailables\Attachment>
                    */
               public function attachments(): array
               {
                    return [];
               }
               }
          *__construct() for data request 
          *envelope() for email subject
          *content() for email temlate design
          *attachments() for attaching files 

          =In students > show.blade.php
               <form action="{{ route('students.mailbox') }}" method="POST">

          =In web.php 
               Route::resource("students",StudentsController::class);
               Route::post("compose/mailbox",[StudentsController::class,"mailbox"])->name("students.mailbox");
          
          =In MailBox.php 
               public $subject,$content;
               public function __construct($subject,$content)
               {   
                    $this->subject = $subject;
                    $this->content = $content;
               }
               public function envelope(): Envelope
               {
                    return new Envelope(
                         subject: $this->subject,
                    );
               }
          
          =In StudentsController.php 
               public function mailbox(Request $request){
                    // dd($request["cmpemail"]);        // "admin@gmail.com"
                    // dd($request["cmpsubject"]);      // "very important" // app\Http\Controllers\StudentsController.php:131
                    // dd($request["cmpcontent"]);      // "hello" // app\Http\Controllers\StudentsController.php:132
                    
                    $to = $request["cmpemail"];
                    $subject = $request["cmpsubject"];
                    $content = $request["cmpcontent"];

                    Mail::to($to)->send(new MailBox($subject,$content));

                    return redirect()->back();
               }
               *use Illuminate\Support\Facades\Mail;
               *use App\Mail\MailBox;

               *to() is primary email user.

          =>Using Cutomized Email Template
               =template.html 
                    -decorate your email design 
               
               resources > views > mailtemplate > mailbox.blade.php 
               =In mailbox.blade.php 
                    <!DOCTYPE html>
                    <html>
                         <head>

                              <title></title>
                              <style type="text/css">
                                   body{
                                        font-size: 12px;

                                        padding: 20px;
                                        margin: 20px;
                                        margin: 0;
                                   }

                                   .card-body{
                                        text-indent: 50px;
                                        text-align: justify;
                                   }

                                   .list-unstyled{
                                        list-style: none;

                                        padding: 0;
                                        margin: 0;
                                   }
                              </style>
                         </head>
                         <body>
                              

                              <section>
                                   <b>Deaer Student, </b>
                              </section>

                              <section>
                                   <div class="card">
                                        <div class="card-body">
                                             <p>
                                                  {!! $content  !!}
                                             </p>
                                        </div>
                                   </div>
                              </section>

                              <section>
                                   <ul class="list-unstyled">
                                        <li>Best Regards,</li>
                                        <li>{{ config("app.name") }}</li>
                                   </ul>
                              </section>
                         </body>
                    </html>

               =In MailBox.php 
                    public function content(): Content
                    {
                         return new Content(
                              view: 'mailtemplate.mailbox',
                         );
                    }

          =>Email Testing With mailtrap 
               =In .env
                    MAIL_MAILER=smtp
                    MAIL_HOST=sandbox.smtp.mailtrap.io
                    MAIL_PORT=2525
                    MAIL_USERNAME=a77caaa1571414
                    MAIL_PASSWORD=1dc9eaa9d53358
                    MAIL_ENCRYPTION=tls
                    MAIL_FROM_ADDRESS="yuzanapalaza@gmail.com"
                    MAIL_FROM_NAME="${APP_NAME}"

                    # MAIL_MAILER=smtp
                    # MAIL_HOST=smtp.gmail.com
                    # MAIL_PORT=587
                    # MAIL_USERNAME=thoonthoon469@gmail.com
                    # MAIL_PASSWORD="qstl fdqu mosh tsrk"
                    # MAIL_ENCRYPTION=tls
                    # MAIL_FROM_ADDRESS=thoonthoon469@gmail.com
                    # MAIL_FROM_NAME="${APP_NAME}"

               =>Mailtrap View 
                    =Send an email to a student (aung aung)
                         Very important

                         From:DLT Student Management Project <yuzanapalaza@gmail.com>
                         To:  <thoonlay779@gmail.com>

                         Show Headers > 
                         Date                Wed, 06 Mar 2024 16:20:45 +0630
                         From                DLT Student Management Project <yuzanapalaza@gmail.com>
                         To                  thoonlay779@gmail.com
                         Bcc                 Available on Enterprise, Premium, Business, and Team plans. 
                         Subject             Very important
                    
                    =Send an email to a student (admin)
                         Very important

                         From:DLT Student Management Project <yuzanapalaza@gmail.com>
                         To:  <admin@gmail.com>
                    =Email Template 
                         Deaer Student,
                              hello world

                         Best Regards,
                         DLT Student Management Project

                         *can add project icon, images 

               *Email Subject name display as specified. 
               *Email Template display as predefind.

               =>Additional Email Sending 
                    =In StudentController.php 
                    public function mailbox(Request $request){
                         ....
                         Mail::to($to)->cc("admin@dlt.com")->bcc("info@dlt.com")->send(new MailBox($subject,$content));

                         return redirect()->back();
                    }
                    *cc (carbon copy)
                    * bcc (blind carbon copy) = for checking outbound email of org
                    -email are sent to the copying email address 

                    *It is not multi user email sending.
                    Multi user email are sent by iteraing a looping of Mail::to()

          =>Requesting email data as Array
               php artisan make:mail StudentMailBox

               =In StudentMailBox.php 
                    public $data;
              
                    public function __construct($data)
                    {
                         $this->data = $data;
                    }

      
                    public function envelope(): Envelope
                    {
                         return new Envelope(
                              subject: $this->data["subject"],
                         );
                    }

          
                    public function content(): Content
                    {
                         return new Content(
                              view: 'mailtemplate.studentmailbox',
                         );
                    }

               =In StudentController.php 
                    public function mailbox(Request $request){
                         ....
                         // =>Method 2 (to StudentMailBox)
                         // $data["to"] = $request["cmpemail"];
                         // $data["subject"] = $request["cmpsubject"];
                         // $data["content"] = $request["cmpcontent"];

                         $data = [
                              "to" => $request["cmpemail"],
                              "subject" => $request["cmpsubject"],
                              "content" => $request["cmpcontent"]
                         ];
                         
                         Mail::to($data["to"])->send(new StudentMailBox($data));

                         return redirect()->back();
                    }
                    
               resources > views > mailtemplate >
               =In studentmailbox.blade.php 
                    <body>
          
                         <section>
                              <b>Deaer Student, </b>
                         </section>

                         <section>
                              <div class="card">
                                   <div class="card-body">
                                        <p>
                                             {!! $data["content"]  !!}
                                        </p>
                                   </div>
                              </div>
                         </section>

                         <section>
                              <ul class="list-unstyled">
                                   <li>Best Regards,</li>
                                   <li>{{ config("app.name") }}</li>
                              </ul>
                         </section>
                    </body>

     =>Queue Process 
          -Database Notification do not have to wait.
          -Email Notification and email sending have to wait a little.     
               checking header, datatype, authentication
          -It is a solution for waiting issue.

          =In .evn 
               QUEUE_CONNECTION=database

               sync (default), file can also be used.
               both 'sync' and 'database' still have to wait.
               -email sending tasks are stored at database.

          =>Generating Queue Table
               php artisan queue:table

               =>Queue migrations
                    public function up(): void
                    {
                         Schema::create('jobs', function (Blueprint $table) {
                              $table->bigIncrements('id');
                              $table->string('queue')->index();
                              $table->longText('payload');
                              $table->unsignedTinyInteger('attempts');
                              $table->unsignedInteger('reserved_at')->nullable();
                              $table->unsignedInteger('available_at');
                              $table->unsignedInteger('created_at');
                         });
                    }
               
               php artisan migrate

               =>phpmyadmin
                    "jobs"
                    id	queue	payload	attempts	reserved_at	available_at	created_at	


               =>Laravell Default 'failed_jobs' table
                    "failed_jobs"
                    id	uuid	connection	queue	payload	exception	failed_at	

          =>Email Notification & Email Sending Operations
               =Email Noti 
                    Example (Contact)
                    -DB (new contact store) 
                    -Sending Email Noti 
               =Queue Email Noti 
                    Example (Contact)
                    -DB (new contact store)
                    -DB (email noti sending task store at "jobs")
                    -Send Email Noti from stored database task 
               ----------------------------------------------------
               =Email Sending 
                    -Direct Email Send 
               
               =Queue Email Sending 
                    -DB (email sending task store at "jobs")
                    -Send Email from stored database task 

          =>Email Notification Queue
               =>Implementing ShouldQueue
                    class ContactEmailNotify extends Notification implements ShouldQueue
                    {....
                    }

                    (use Illuminate\Contracts\Queue\ShouldQueue;)

                    =create a new contact 
                    =create a new contact

                    "jobs"    
                    id	queue	payload	                                             attempts	reserved_at	available_at	created_at	
                    1    default   {"uuid":"9e0edf84-ef36-4d2e-bd67-b246329a47cc","di...  0         NULL           1709815251     1709815251
                    2    default   {"uuid":"4650182d-c5d9-454d-a9a1-7d90ab021f48","di...  0         NULL           1709816175     1709816175

                    {"uuid":"9e0edf84-ef36-4d2e-bd67-b246329a47cc","displayName":"App\\Notifications\\ContactEmailNotify","job":"Illuminate\\Queue\\CallQueuedHandler@call","maxTries":null,"maxExceptions":null,"failOnTimeout":false,"backoff":null,"timeout":null,"retryUntil":null,"data":{"commandName":"Illuminate\\Notifications\\SendQueuedNotifications","command":"O:48:\"Illuminate\\Notifications\\SendQueuedNotifications\":3:{s:11:\"notifiables\";O:45:\"Illuminate\\Contracts\\Database\\ModelIdentifier\":5:{s:5:\"class\";s:15:\"App\\Models\\User\";s:2:\"id\";a:1:{i:0;i:1;}s:9:\"relations\";a:0:{}s:10:\"connection\";s:5:\"mysql\";s:15:\"collectionClass\";N;}s:12:\"notification\";O:36:\"App\\Notifications\\ContactEmailNotify\":2:{s:42:\"\u0000App\\Notifications\\ContactEmailNotify\u0000data\";a:5:{s:9:\"firstname\";s:3:\"Tun\";s:8:\"lastname\";s:3:\"Hla\";s:8:\"birthday\";s:10:\"2024-03-22\";s:8:\"relative\";s:6:\"Friend\";s:3:\"url\";s:21:\"http:\/\/127.0.0.1:8000\";}s:2:\"id\";s:36:\"119aa1ad-2698-4d20-badb-de2e07253ddb\";}s:8:\"channels\";a:1:{i:0;s:4:\"mail\";}}"}}
                    
                    "failed_jobs"
                    id	uuid	connection	queue	payload	exception	failed_at	

                    mailtrap
                    -no mail receive 
                    
                    *ShouldQueue Interface, indicating to Laravel that the job should be pushed onto the queue to run asynchronously.
                    *store the respective task in the database to carry out later
               
               =>Working with Queue
                    php artisan queue:work
                    (or)
                    php artisan queue:listen
                    *this command needed to run continuously while the server on.
                    *tasks run in background from the "jobs" table.
                         2024-03-07 19:31:14 App\Notifications\ContactEmailNotify ................................................................ RUNNING  
                         2024-03-07 19:31:28 App\Notifications\ContactEmailNotify ............................................................... 14s DONE  
                         2024-03-07 19:31:28 App\Notifications\ContactEmailNotify ................................................................ RUNNING  
                         2024-03-07 19:31:30 App\Notifications\ContactEmailNotify ................................................................ 1s DONE  

                    "jobs"
                    id	queue	payload	attempts	reserved_at	available_at	created_at	

                    "failed_jobs"
                    id	uuid	connection	queue	payload	exception	failed_at	

                    mailtrap 
                    -mail arrive 
                    __________________________________________________________________________________________________________
                    =create a new contact 
                         =At queue working terminal
                              2024-03-07 19:31:14 App\Notifications\ContactEmailNotify ................................................................ RUNNING  
                              2024-03-07 19:31:28 App\Notifications\ContactEmailNotify ............................................................... 14s DONE  
                              2024-03-07 19:31:28 App\Notifications\ContactEmailNotify ................................................................ RUNNING  
                              2024-03-07 19:31:30 App\Notifications\ContactEmailNotify ................................................................ 1s DONE  
                              2024-03-07 19:38:44 App\Notifications\ContactEmailNotify ................................................................ RUNNING
                              2024-03-07 19:38:49 App\Notifications\ContactEmailNotify ................................................................ 5s DONE
                         
                         *do not have to run the command again
                         *proceed the tasks in the database
          
          =>Email Sending Queue
               =In StudentController.php 
                    public function mailbox(Request $request){
  
                         // Method 1 (to MailBox)
                         $to = $request["cmpemail"];
                         $subject = $request["cmpsubject"];
                         $content = $request["cmpcontent"];
                         Mail::to($to)->send(new MailBox($subject,$content));

                         return redirect()->back();
                    }
               
               =In Mailbox.php 
                    class MailBox extends Mailable implements ShouldQueue
                    {
                         ....
                    }

               =Use Gmail to solve mailtrap demo mail limit issue
               =send a mail to a student

               2024-03-08 17:13:19 App\Mail\MailBox .................................................................................... RUNNING
               2024-03-08 17:13:26 App\Mail\MailBox .................................................................................... 7s DONE

               *It work in current version, previsous version can't simply wirte only implements ShouldQueue

               =>****Important to Check 
                    =In .env
                         QUEUE_CONNECTION=database
                    Hovever the class implements ShouldQueue, setting above variable default 'sync' will not store tasks in database and directly work the task.
               ____________________________________________________________________________________________________________________________________________
          =>Queue Usage 
               -Email, SMS

               SMS Provider
               -twillo
               -local telecoms

               =User Queue
                    -full information user - success
                    -incomplete information user - queue 

                    A                   A 
                    B - incomplete      C 
                    C                   D 
                    D                   E 
                    E                   F  
                    F                   B 


     =>Email Sending By Job
          php artisan make:job MailBoxJob

          app > Jobs > MailBoxJob.php 
          =Original MailBoxJob.php
               <?php

               namespace App\Jobs;

               use Illuminate\Bus\Queueable;
               use Illuminate\Contracts\Queue\ShouldBeUnique;
               use Illuminate\Contracts\Queue\ShouldQueue;
               use Illuminate\Foundation\Bus\Dispatchable;
               use Illuminate\Queue\InteractsWithQueue;
               use Illuminate\Queue\SerializesModels;

               class MailBoxJob implements ShouldQueue
               {
               use Dispatchable, InteractsWithQueue, Queueable, SerializesModels;

               /**
                    * Create a new job instance.
                    */
               public function __construct()
               {
                    //
               }

               /**
                    * Execute the job.
                    */
               public function handle(): void
               {
                    //
               }
               }
          
          MailBoxJob > MailBox 
                    handle

          =>Using Job
               =Method 1 (to MailBox)
                    =In  StudentController.php 
                         public function mailbox(Request $request){     
                              dispatch(new MailBoxJob($to,$subject,$content));
                              // MailBoxJob::dispatch($to,$subject,$content);

                              return redirect()->back();
                         }

                         *use App\Jobs\MailBoxJob;

                    =In MailBoxJob.ph 
                         protected $to;
                         protected $subject;
                         protected $content;
               
                         public function __construct($to,$subject,$content)
                         {
                              $this->to = $to;
                              $this->subject = $subject;
                              $this->content = $content;
                         }

                         public function handle(): void
                         {
                              Mail::to($this->to)->send(new MailBox($this->subject,$this->content));
                         }
                         *use App\Mail\MailBox;
                         *use Illuminate\Support\Facades\Mail;

                    *conduct a job named MailBoxJob,
                         MailBoxJob operate EmailSending task 

                    2024-03-09 17:48:06 App\Jobs\MailBoxJob ............................................ RUNNING
                    2024-03-09 17:48:13 App\Jobs\MailBoxJob ............................................ 7s DONE
               =Method 2 (to StudentMailBox)
                    php artisan mke:job StudentMailBoxJob

                    =In StudentController.php 
                         public function mailbox(Request $request){

                              $data = [
                                   "to" => $request["cmpemail"],
                                   "subject" => $request["cmpsubject"],
                                   "content" => $request["cmpcontent"]
                              ];
                              
                              // Mail::to($data["to"])->send(new StudentMailBox($data));
                              dispatch(new StudentMailBoxJob($data));

                              return redirect()->back();
                         }
                         use App\Jobs\StudentMailBoxJob;

                    =In StudentMailBoxJob.php 
                         public function __construct($data)
                         {   
                              $this->data = $data;
                         }

                         public function handle(): void
                         {
                              Mail::to($this->data["to"])->send(new StudentMailBox($this->data));

                         }

                         use App\Mail\StudentMailBox;
                         use Illuminate\Support\Facades\Mail;

          =>Inspecting Error 
               
               *error 
                    $this->subject = $to;

                    "failed_jobs"
                    id	uuid	                                   connection	queue	payload	                                             exception	                                             failed_at	
                    3    626a1dc7-c73e-47e1-970a-61e890ad820f    database       default   {"uuid":"626a1dc7-c73e-47e1-970a-61e890ad820f","di...  Symfony\Component\Mime\Exception\LogicException: A...  2024-03-09 17:42:34

                    --------------------------------------------------------------
                    strage > logs > laravel.log 
                    *can read error message

     =>Like Feature 
          -Similar to Enroll 
          -User can only like a post one time. When a post is liked, unlike button appear.


          =Migration 
               php artisan make:migration create_post_like_table --create;
               =create_post_like_table.php 
                    up()
                         $table->id();
                         $table->foreignId("post_id")->constrained()->onUpdate("cascade")->onDelete("cascade");
                         $table->foreignId("user_id")->constrained(
                              table:"users",indexName:"post_user_id"
                         )->onUpdate("cascade")->onDelete("cascade");
                         $table->timestamps();

               php artisan migrate:status 
               php artisan migrate 

          =Seperate Controller 
               php artisan make:controller PostsLikeController
               =In PostsLikeController.php 
                    use App\Models\Post;
                    use Illuminate\Http\Request;

                    class PostsLikeController extends Controller
                    {
                         public function like(Post $post){

                         }

                         public function unlike(Post $post){

                         }
                    }

          =In Web.php 
               *use App\Http\Controllers\PostsLikeController;

               Route::resource("posts",PostsController::class);
               Route::post("posts/{post}/like",[PostsLikeController::class,"like"])->name("posts.like");
               Route::post("posts/{post}/unlike",[PostsLikeController::class,"unlike"])->name("posts.unlike");
          =In User.php 
               public function likes(){
                    return $this->belongsToMany(Post::class,"post_like");
               }
               *Many to Many relationship between Posts and Users,  the dummy table is "post_like".

          =In PostsLikeController.php 
               public function like(Post $post){
                    dd($post);
                    $user = Auth::user();
                    $user->likes()->attach($post);

                    session()->flash("success","You liked this post");
                    return redirect()->back();
               }
               *Route Model Binding
                    By type-hinting the controller method's parameter with the Post model (Post $post), Laravel knows that it should fetch a Post model from the database based on the post parameter in the URL. Laravel will automatically query the posts table for a record with an id matching the value provided in the URL.

                    *result ($post)
                         App\Models\Post {#1445 ▼ // app\Http\Controllers\PostsLikeController.php:12
                         #connection: "mysql"
                         #table: "posts"
                         #primaryKey: "id"
                         ....
                         #attributes: array:17 [▶]
                         #original: array:17 [▼
                         "id" => 3
                         "image" => "assets/img/posts/1659bede60b7573banner3.jpg"
                         "title" => "CSS Intermediate Batch5"
                         "slug" => ""
                         "content" => "hi sir"
                         "fee" => "15000.00"
                         "startdate" => "2023-11-22"
                         "enddate" => "2023-12-21"
                         "starttime" => "07:11:00"
                         "endtime" => "20:14:00"
                         "type_id" => 2
                         "tag_id" => 2
                         "attshow" => 3
                         "status_id" => 7
                         "user_id" => 1
                         "created_at" => "2024-01-08 19:12:55"
                         "updated_at" => "2024-01-22 18:35:13"
                         ]
                         ....
                         #fillable: array:14 [▶]
                         #guarded: array:1 [▶]
                         }
                    
               *Insert the dummy table using Many to Many relationship.

          =In posts > show.blade.php 
               <div class="w-100 d-flex flex-row justify-content-between mb-3">
                    @if(!$post->checkenroll($userdata->id))
                         <a href="#createmodal" class="w-100 btn btn-primary btn-sm rounded-0" data-bs-toggle="modal">Enroll</a>
                    @endif; 

                    <form class="w-100" action="{{route('posts.like',$post->id)}}" method="POST">
                         @csrf
                         <button type="submit" class="w-100 btn btn-outline-primary btn-sm rounded-0">Like</button>
                    </form>
               </div>

          =like a post
          =>phpmyadmin 
          "post_like"
               id   post_id   user_id   created_at     updated_at
               1    15        1         NULL           NULL


          =>Filling created and updated columns 
               =In User.php 
                    public function likes(){
                         return $this->belongsToMany(Post::class,"post_like")->withTimestamps();
                    }
               =phpmyadmin
                    "post_like"
                    id   post_id   user_id   created_at               updated_at
                    1    15        1         NULL                     NULL
                    2    15        1         2024-05-09 14:24:32      2024-05-09 14:24:32

          =>Prevent Double Like 
               =In User.php 
                    public function checkpostlike($postid){
                         return $this->likes()->where("post_id",$postid)->exists();
                    }
               =In posts > show.blade.php 
               <div class="w-100 d-flex flex-row justify-content-between mb-3">
                    @if(!$post->checkenroll($userdata->id))
                         <a href="#createmodal" class="w-100 btn btn-primary btn-sm rounded-0" data-bs-toggle="modal">Enroll</a>
                    @endif; 

                    @if($userdata->checkpostlike($post->id))
                         <form class="w-100" action="{{route('posts.unlike',$post->id)}}" method="POST">
                              @csrf
                              <button type="submit" class="w-100 btn btn-outline-primary btn-sm rounded-0">Unlike</button>
                         </form>
                    @else 
                         <form class="w-100" action="{{route('posts.like',$post->id)}}" method="POST">
                              @csrf
                              <button type="submit" class="w-100 btn btn-outline-primary btn-sm rounded-0">Like</button>
                         </form>
                    @endif;
                    
               </div>
                    
          =>Unlike Post 
               =In PostsLikeController.php 
                    public function unlike(Post $post){
                         $user = auth()->user();
                         $user->likes()->detach($post);

                         session()->flash("success","You unliked this post");
                         return redirect()->back();
                    }

               =like another post 
               =phpmyadmin
                    "post_like"
                    id   post_id   user_id   created_at               updated_at
                    1    15        1         NULL                     NULL
                    2    15        1         2024-05-09 14:24:32      2024-05-09 14:24:32
                    3    1         1         2024-05-09 14:24:32      2024-05-09 14:24:32

               -when unlike single like post it will only delete one row.
               =phpmyadmin
                    "post_like"
                    id   post_id   user_id   created_at               updated_at
                    1    15        1         NULL                     NULL
                    2    15        1         2024-05-09 14:24:32      2024-05-09 14:24:32

               -when unlike multiple likes post it will delete all row related to that post.

          =>Like/Unlike Testing with two user 
               =admin account
                    like a post 
               =aung aung account
                    like a post 
               
               =phpmyadmin
                    "post_like"
                    id   post_id   user_id   created_at               updated_at
                    4    1         1         2024-05-09 14:24:32      2024-05-09 14:24:32                   
                    5    1         20        2024-05-09 14:24:32      2024-05-09 14:24:32

               =admin account
                    unlike a post
               =phpmyadmin
                    "post_like"
                    id   post_id   user_id   created_at               updated_at
                    5    1         20        2024-05-09 14:24:32      2024-05-09 14:24:32     

               =aung aung account

          =>Counting Likes 
               =In Post.php 
                    public function likes(){
                         return $this->belongsToMany(User::class,"post_like");
                    }
                    *Many to Many relationship between Users and Posts.
                    *it don't need ->withTimestamps() fun. It won't insert like data.


               =In posts > show.blade.php
                    <div class="mb-5">
                         <p class="text-small text-muted text-uppercase mb-2">Other</p>
                         <div class="row g-0 mb-2">
                              <div class="col-auto me-2">
                                   <i class="fas fa-thumbs-up"></i>
                              </div>
                              <div class="col">{{ $post->likes()->count() }}</div>
                         </div>

               =>Counting Likes Testing with two users 
                    =admin Acc 
                         =like a post 
                         =view likes = 1
                    =aung aung Acc 
                         =view likes = 1
                         =like same post 
                         =view likes = 2

          *Like/Unlike feature has weakness of reloading because of php server language. 
          Others Plugins can be used to resolve this issues. Example Laravel plugin "Live Wire".    

     =>Follow Feature 
          =Migration 
               
               php artisan make:migration create_follower_user_table --create
               =In create_follower_user_table.php
                    up() 
                         $table->id();
                         $table->foreignId("user_id")->constrained()->onUpdate("cascade")->onDelete("cascade");
                         $table->foreignId("follower_id")->constrained(
                              table:"users",indexName:"users_follower_id"
                         )->onUpdate("cascade")->onDelete("cascade");
                         $table->timestamps();
               =php artisan migrate:status 
               =php artian migrate 
          
          =php artisan make:controller UsersFollowerController 
          =In UsersFollowerController.php  
               *use App\Models\User;
               public function follow(User $user){

               }

               public function unfollow(User $user){
                    
               }
          
          =In Web.php 
               *use App\Http\Controllers\UsersFollowerController;
               Route::post("users/{user}/follow",[UsersFollowerController::class,"follow"])->name("users.follow");
               Route::post("users/{user}/unfollow",[UsersFollowerController::class,"unfollow"])->name("users.unfollow");

          =In User.php 
               public function followings(){
                    return $this->belongsToMany(User::class,"follower_user")->withTimestamps();
               }
               -Establish many to many relationship between single user table.
          
          =In UsersFollowerController.php 
               public function follow(User $user){
                    $curloginuser = Auth::user();
                    $curloginuser->followings()->attach($user);

                    session()->flash("success","Followed Successfully");
                    return redirect()->back();
               }

               -Insert the user who follow another user to "follower_user" table

          =In students > show.blade.php 
               <form class="w-100" action="{{ route('users.follow',$student->user_id) }}" method="POST">
                    @csrf
                    <button type="submit" class="w-100 btn btn-outline-primary btn-sm rounded-0">Follow</button>
               </form>

          =follow a user 
               *error 
               SQLSTATE[HY000]: General error: 1364 Field 'follower_id' doesn't have a default value
               INSERT INTO `follower_user` (`created_at`, `updated_at`, `user_id`) VALUES (2024-05-10 13:46:56, 2024-05-10 13:46:56, 1)

          =>Adhering to naming convention
               =In User.php 
                    public function followings(){
                                                                                // fk           // rk (relative key)
                         return $this->belongsToMany(User::class,"follower_user","follower_id","user_id")->withTimestamps();
                    }

                    =Think by controller follow() func 
                         $curloginuser->followings()->attach($user);
                    *user1 <-> follower_id 
                    *user20 <-> user_id
               =phpmyadmin 
                    id   user_id   follower_id    created_at               updated_at
	               1    20        1              2024-05-10 13:53:17      2024-05-10 13:53:17

               =Misconcept XXXX
                    =In User.php 
                    public function followings(){
                         return $this->belongsToMany(User::class,"follower_user","user_id","follower_id")->withTimestamps();
                    }

                    =phpmyadmin 
                    id   user_id   follower_id    created_at               updated_at
	               1    20        1              2024-05-10 13:53:17      2024-05-10 13:53:17
	               1    1         20             2024-05-10 13:53:17      2024-05-10 13:53:17

                    follower_id = me
                    user_id = other 

                    userA <-> userB 
                    userB:    i have 4k followers.     
                    userA:    i have 8 followings.

          =>Prevent Multiple times follow 
               =In User.php 
                    public function checkuserfollowing($followingid){
                         return $this->followings()->where("user_id",$followingid)->exists();
                    
                         // Note:: user_id mean = Oher Person 
                         // Note:: follower_id mean = I
                         // Note:: $followingid mean = Other Person
                    }

               =In students > show.blade.php 
                    @if($userdata->checkuserfollowing($student->user_id))
                         <form class="w-100" action="{{ route('users.unfollow',$student->user_id) }}" method="POST">
                              @csrf
                              <button type="submit" class="w-100 btn btn-outline-primary btn-sm rounded-0">Unfollow</button>
                         </form>
                    @else 
                         <form class="w-100" action="{{ route('users.follow',$student->user_id) }}" method="POST">
                              @csrf
                              <button type="submit" class="w-100 btn btn-outline-primary btn-sm rounded-0">Follow</button>
                         </form>
                    @endif       

               =Noting 
                    =create_follower_user_table.php 
                         $table->foreignId("user_id")->constrained()->onUpdate("cascade")->onDelete("cascade")->comment("Other Person");
                         $table->foreignId("follower_id")->constrained(
                              table:"users",indexName:"users_follower_id"
                         )->onUpdate("cascade")->onDelete("cascade")->comment("I");   

                    php artisan migrate:rollback
                    php artisan migrate

          =>Unfollow User 
               =In UsersFollowerController.php 
                    public function unfollow(User $user){
                         $curloginuser = auth()->user();
                         $curloginuser->followings()->detach($user);

                         session()->flash("success","Unfollowed Successfully");
                         return redirect()->back();
                    }

          =Follow/Unfollow tesging
               =follow other users
               =phpmyadmin 
                    id   user_id   follower_id    created_at               updated_at
	               1    20        1              2024-05-10 13:53:17      2024-05-10 13:53:17
	               2    30        1              2024-05-10 13:53:17      2024-05-10 13:53:17
	               3    40        1              2024-05-10 13:53:17      2024-05-10 13:53:17

               =unfollow a user
               =phpmyadmin 
                    id   user_id   follower_id    created_at               updated_at
	               1    20        1              2024-05-10 13:53:17      2024-05-10 13:53:17
	               2    30        1              2024-05-10 13:53:17      2024-05-10 13:53:17

          =>Prevent Following myself
               =In students > show.blade.php 
                    @if($userdata->id !== $student->user_id)
                         @if($userdata->checkuserfollowing($student->user_id))
                              <form class="w-100" action="{{ route('users.unfollow',$student->user_id) }}" method="POST">
                                   @csrf
                                   <button type="submit" class="w-100 btn btn-outline-primary btn-sm rounded-0">Unfollow</button>
                              </form>
                         @else 
                              <form class="w-100" action="{{ route('users.follow',$student->user_id) }}" method="POST">
                                   @csrf
                                   <button type="submit" class="w-100 btn btn-outline-primary btn-sm rounded-0">Follow</button>
                              </form>
                         @endif
                    @endif 

               =Follow button appear for other users 
               =Follow button don't display for myself 

     =>API Delete 
          Studied  "API Switch to change on, off in UI" in previous lessions
          
          =In Web.php 
               Route::resource("types",TypesController::class)->except("destroy");
               Route::get("/typesstatus",[TypesController::class,"typestatus"]);
          
          php artisan route:list
               GET|HEAD        types ......... types.index › TypesController@index  
               POST            types ......... types.store › TypesController@store  
               GET|HEAD        types/create types.create › TypesController@create   
               GET|HEAD        types/{type} .... types.show › TypesController@show  
               PUT|PATCH       types/{type} types.update › TypesController@update   
               GET|HEAD        types/{type}/edit types.edit › TypesController@edit  
               GET|HEAD        typesstatus ............ TypesController@typestatus  
          *There is no "types.destroy" route.

          =In Web.php 
               Route::resource("types",TypesController::class)->except("destroy");
               Route::get("/typesstatus",[TypesController::class,"typestatus"]);
               Route::get("/typesdelete",[TypesController::class,"destroy"])->name("types.delete");

          php artisan route:list
               GET|HEAD        types ......... types.index › TypesController@index
               POST            types ......... types.store › TypesController@store  
               GET|HEAD        types/create types.create › TypesController@create   
               GET|HEAD        types/{type} .... types.show › TypesController@show  
               PUT|PATCH       types/{type} types.update › TypesController@update   
               GET|HEAD        types/{type}/edit types.edit › TypesController@edit  
               GET|HEAD        typesdelete types.delete › TypesController@destroy   
               GET|HEAD        typesstatus ............ TypesController@typestatus  
          *"type.delete" route is registered for api delete.

          =In TypesController.php 
               // public function destroy(string $id)
               // {
               //     $type = Type::findOrFail($id);
               //     $type->delete();

               //     session()->flash("info","Delete Successfully");
               //     return redirect()->back();
               // }

               public function destroy(Request $request)
               {
                    $type = Type::findOrFail($request["id"]);
                    $type->delete();

                    session()->flash("info","Delete Successfully");
                    return response()->json(["success"=>"Delete Successfully."]);
               }

          =In types > index.blade.php 
               <td>
                    <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$type->id}}" data-name="{{$type->name}}" data-status="{{$type->status_id}}"><i class="fas fa-pen"></i></a>
                    <!-- <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a> -->
                    <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}" data-id="{{$type->id}}"><i class="fas fa-trash-alt"></i></a>
               </td>
               {{-- 
               <form id="formdelete-{{ $idx }}" class="" action="{{route('types.destroy',$type->id)}}" method="POST">
                    @csrf
                    @method("DELETE")
               </form> --}}
               ....

               // Start Delete Item
               // $(".delete-btns").click(function(){
               //      // console.log('hay');
          
               //      var getidx = $(this).data("idx");
               //      // console.log(getidx);

               //      if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
               //           $('#formdelete-'+getidx).submit();
               //           return true;
               //      }else{
               //           false;
               //      }
               // });

               // by ajax 
               $(".delete-btns").click(function(){
                    const getidx = $(this).attr("data-idx");
                    const getid = $(this).data("id");
                    // console.log(getid);
                    
                    if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
                         $.ajax({
                              url:"typesdelete",
                              type:"GET",
                              dataType:"json",
                              data:{"id":getid},
                              success:function(response){
                                   window.alert(response.success);
                              }
                         });
                         return true;
                    }else{
                         return false;
                    }
               });


               // End Delete Item

          =delete a type 
          =Chrome Inspect > Console Tab
               Delete Successfully.
          *Only problem is that tyoe information still exist at UI and deleted in next reload.
               
          =>UI Delete 
               =In types > index.blade.php 
                    if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
                         // ui remove
                         $(this).parent().parent().remove();
                         //       <td>       <tr>


               *Inrelevant types information in UI is cleared.
               *Flash message also display at next reload. It no longer need to display for api delete.

     =>Payment
          php artisan make:controller PaymentmethodsController

          =Migration 
               php artisan make:model Paymentmethod -m

               =In create_paymentmethods_table.php 
                    $table->string("image")->nullable();
                    $table->string("name")->unique();
                    $table->string("slug");
                    $table->unsignedBigInteger("status_id");
                    $table->unsignedBigInteger("user_id");
               
               php artisan migrate:status 
               php artisan migrate

          =In Model (Paymentmethod.php)
               protected $table = "paymentmethods";
               protected $primaryKey = "id";
               protected $fillable = [
                    "image",
                    "name",
                    "slug",
                    "status_id",
                    "user_id"
               ];

               public function user(){
                    return $this->belongsTo(User::class);
               }

               public function status(){
                    return $this->belongsTo(Status::class);
               }

          =In Web.php 
               *use App\Http\Controllers\PaymentmethodsController;

               Route::resource("paymentmethods",PaymentmethodsController::class);
          =In PaymentmethodsController.php 
               *copy from TypesController

               public function index()
               {
                    $paymentmethods = Paymentmethod::all();
                    $statuses = Status::whereIn("id",[3,4])->get();
                    return view("paymentmethods.index",compact("paymentmethods","statuses"));
               }


               public function create()
               {
                    $statuses = Status::whereIn("id",[3,4])->get();
                    return view("paymentmethods.create",compact("statuses"));
               }


               public function store(Request $request)
               {
                    $this->validate($request,[
                         "name" => "required|max:50|unique:paymentmethods",
                         "status_id" => "required|in:3,4",
                    ]);

                    $user = Auth::user();
                    $user_id = $user->id;

                    $paymentmethod = new Paymentmethod();
                    $paymentmethod->name = $request["name"];
                    $paymentmethod->slug = Str::slug($request["name"]);
                    $paymentmethod->status_id = $request["status_id"];
                    $paymentmethod->user_id = $user_id;
                    $paymentmethod->save();
                    return redirect(route("paymentmethods.index"));
               }

               public function update(Request $request, string $id)
               {
                    $this->validate($request,[
                         "name" => ["required","max:50","unique:paymentmethods,name,".$id],
                         "status_id" => ["required","in:3,4"],
                    ]);

                    $user = Auth::user();
                    $user_id = $user["id"];

                    $paymentmethod = Paymentmethod::findOrFail($id);
                    $paymentmethod->name = $request["name"];
                    $paymentmethod->slug = Str::slug($request["name"]);
                    $paymentmethod->status_id = $request["status_id"];
                    $paymentmethod->user_id = $user_id;
                    $paymentmethod->save();
                    return redirect(route("paymentmethods.index"));
               }

               public function destroy(Request $request)
               {
                    $paymentmethod = Paymentmethod::findOrFail($request["id"]);
                    $paymentmethod->delete();

                    // session()->flash("info","Delete Successfully");
                    return response()->json(["success"=>"Delete Successfully."]);
               }

               public function typestatus(Request $request){
                    $paymentmethod = Paymentmethod::findOrFail($request["id"]);
                    $paymentmethod->status_id = $request["status_id"];
                    $paymentmethod->save();

                    return response()->json(["success"=>"Status Change Successfully"]);
               }

          "Paymentmethods"
               cash
               bank transfer
               mpu 
               visa
               master
               kpay 
               wave 
               truemoney

          =CRUD Testing 
               Edit wave to cbpay 
               Delete truemoney
                    *It only deleted in UI. Because the route is not registered.
          
          =>API Delete (Default Route)
               -the sperate route method requires extra routes.
                    ->except("destroy");
                    Route::get("/typesdelete"

               -This lession will use laravel default route
                    php artisan route:list   
                         GET|HEAD        paymentmethods ............................................ paymentmethods.index › PaymentmethodsController@index  
                         POST            paymentmethods ............................................ paymentmethods.store › PaymentmethodsController@store  
                         GET|HEAD        paymentmethods/create ................................... paymentmethods.create › PaymentmethodsController@create  
                         GET|HEAD        paymentmethods/{paymentmethod} .............................. paymentmethods.show › PaymentmethodsController@show
                         PUT|PATCH       paymentmethods/{paymentmethod} .......................... paymentmethods.update › PaymentmethodsController@update  
                         DELETE          paymentmethods/{paymentmethod} ........................ paymentmethods.destroy › PaymentmethodsController@destroy  
                         GET|HEAD        paymentmethods/{paymentmethod}/edit ......................... paymentmethods.edit › PaymentmethodsController@edit  

                    *default route use DELETE method
                    DELETE    paymentmethods/{paymentmethod}     paymentmethods.destroy

               
               =In PaymentmethodsController.php 
                    *use Exception;
                    public function destroy(Paymentmethod $paymentmethod)
                    {
                         try{
                              if($paymentmethod){
                                   $paymentmethod->delete();
                                   return response()->json(["status"=>"success","data"=>$paymentmethod,"message"=>"Delete Successfully"]);
                              }
                              return response()->json(["status"=>"failed","message"=>"No Data Found"]);
                         }catch(Exception $e){
                              Log::error($e->getmessage());
                              return response()->json(["status"=>"failed","message"=>$e->getMessage()]);
                         }
                    }
                    *Paymentmethod information is obtained from method parameter. 
                    *It is called with ajax. try catch must be used.
                    *Alghough the id don't have a chance to unmatch (only the available is shown on the interface),
                         whatever it is protected by checking if condition. 

                         Id can wrong when js function mistakenly pass getidx.
                         It is deleted in database, and delete again from UI.

               =In paymentmethods > index.blade.php 
                    ....
                    @foreach($paymentmethods as $idx=>$paymentmethod)
                         <tr id="delete_{{$paymentmethod->id}}">
                    ....
                    // by ajax 
                    // Using default laravel route
                    $(".delete-btns").click(function(){
                         const getidx = $(this).attr("data-idx");
                         const getid = $(this).data("id");
                         // console.log(getid);
                         
                         if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
                              // ui remove
                         
                              // data remove 
                              $.ajax({
                                   url:`paymentmethods/${getid}`,
                                   type:"DELETE",
                                   dataType:"json",
                                   success:function(response){
                                        if(response && response.status === "success"){
                                             const getdata = response.data;
                                             $(`#delete_${getdata.id}`).remove();
                                        }
                                   }
                              });
                              return true;
                         }else{
                              return false;
                         }
                    });

                    -ajax's data property isn't required.It will process with route id.
                    -data is passed to inform the deleted data and clear the irrelevant data in UI.

                    =delet a paymentmethod 
                    *Error
                    DELETE http://127.0.0.1:8000/paymentmethods/7 419 (unknown status)

                    =Chrome Inspect > Network Tab
                         Name      Status    Type      Initiator                Size      Time      Waterfall
                         7	     419	     xhr	     jquery-3.6.3.min.js:2	14.0 kB	461 ms
                    *Header Authenticate Error 

                    =>Solving Error
                         =>Sending _token data
                              =>In paymentmethods > index.blade.php 
                                   // data remove 
                                   $.ajax({
                                        url:`paymentmethods/${getid}`,
                                        type:"DELETE",
                                        dataType:"json",
                                        data:{_token:"{{csrf_token()}}"},
                                        success:function(response){
                                             if(response && response.status === "success"){
                                                  const getdata = response.data;
                                                  $(`#delete_${getdata.id}`).remove();
                                             }
                                        }
                                   });

                                   -laravel check token code in background. Ajax must send token information.

                         =>Ajax Header 
                              =>In layouts > adminheader.blade.php 
                                   <!-- Application Name -->
                                   <title>{{ config('app.name') }}</title>

                                   <meta name="csrf-token" content="{{ csrf_token() }}"/>
                              
                              =>In paymentmethods > index.blade.php 
                                   <script type="text/javascript">
          
                                   // Start Passing Header Token
                                   $.ajaxSetup({
                                        headers:{
                                             "X-CSRF-TOKEN": $("meta[name='csrf-token']").attr("content")
                                        }
                                   });
                                   // End Passing Header Token       
                                   ....
                                   // data remove 
                                   $.ajax({
                                        url:`paymentmethods/${getid}`,
                                        type:"DELETE",
                                        dataType:"json",
                                        // data:{_token:"{{csrf_token()}}"},
                                        success:function(response){
                                             if(response && response.status === "success"){
                                                  const getdata = response.data;
                                                  $(`#delete_${getdata.id}`).remove();
                                             }
                                        }
                                   });

                                   *Sending Required Technical Info With Header 
                                   *Get meta element with Attribute Selector and attain its value
                                   *can't define id and class to meta tag, id and class can only defien in body tag
                              
                    =>Meta Tag 
                         =layouts > adminheader.blade.php 
                              <!-- Application Name -->
                              <title>{{ config('app.name') }}</title>

                              <meta charseet="utf-8" />

                         *to display myanmar font and unicode font correctly

          =>Ajax Only Status Change 
               =>In Web.php 
                    Route::resource("paymentmethods",PaymentmethodsController::class);
                    Route::get("/paymentmethodsstatus",[PaymentmethodsController::class,"typestatus"]);

               =>In paymentmethods > index.blade.php 
                    //Start change-btn
                    $(".change-btn").change(function(){
                         var getid = $(this).data("id");
                         // console.log(getid); // 1 2

                         var setstatus = $(this).prop("checked") === true ? 3 : 4;
                         // console.log(setstatus); // 3 4

                         $.ajax({
                              url:"paymentmethodsstatus",
                              type:"GET",
                              dataType:"json",
                              data:{"id":getid,"status_id":setstatus},
                              success:function(response){
                                   console.log(response); // {success: 'Status Change Successfully'}
                                   console.log(response.success); // Status Change Successfully
                              }
                         });
                    });
                    // End change btn   

          =>Ajax Edit 
               =In PaymentmethodsController.php 
                    public function update(Request $request, string $id)
                    {
                         $this->validate($request,[
                              "name" => ["required","max:50","unique:paymentmethods,name,".$id],
                              "status_id" => ["required","in:3,4"],
                         ]);

                         $user = Auth::user();
                         $user_id = $user["id"];

                         try{
                              $paymentmethod = Paymentmethod::findOrFail($id);
                              $paymentmethod->name = $request["name"];
                              $paymentmethod->slug = Str::slug($request["name"]);
                              $paymentmethod->status_id = $request["status_id"];
                              $paymentmethod->user_id = $user_id;
                              $paymentmethod->save();

                              if($paymentmethod){
                                   return response()->json(["status"=>"success","data"=>$paymentmethod]);
                              }
                              return response()->json(["status"=>"failed","data"=>"Failed to update Payment Method"]);
                         }catch(Exception $e){
                              Log:error($e->getMessage());
                              return response()->json(["status"=>"failed","message"=>$e->getMessage()]);
                         }
                    }
               
               =In paymentmethods > index.blade.php 
                    ....
                    <td>
                         <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$paymentmethod->id}}" data-name="{{$paymentmethod->name}}" data-status="{{$paymentmethod->status_id}}"><i class="fas fa-pen"></i></a>
                         <!-- <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a> -->
                         <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}" data-id="{{$paymentmethod->id}}"><i class="fas fa-trash-alt"></i></a>
                    </td>   
                    ....
                    <!-- start edit modal -->
                         <div id="editmodal" class="modal fade">
                              <div class="modal-dialog modal-dialog-centered">
                                   <div class="modal-content rounded-0">
                                        <div class="modal-header">
                                             <h6 class="modal-title">Edit Form</h6>
                                             <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>

                                        <div class="modal-body">
                                             <form id="formaction" action="" method="">
                                                  <div class="row align-items-end">
                                                       <div class="col-md-7">
                                                            <label for="editname">Name <span class="text-danger">*</span></label>
                                                            <input type="text" name="name" id="editname" class="form-control form-control-sm rounded-0" placeholder="Enter Status Name" value="{{ old('name') }}"/>
                                                       </div>
                                                       
                                                       <div class="col-md-3 form-group">
                                                            <label for="editstatus_id">Status</label>
                                                            <select name="status_id" id="editstatus_id" class="form-control form-control-sm rounded-0">
                                                                 @foreach($statuses as $status)
                                                                      <option value="{{$status['id']}}">{{$status['name']}}</option>
                                                                 @endforeach     
                                                            </select>
                                                       </div>
                                                       
                              
                                                       <div class="col-md-2">
                                                            <button type="submit" class="btn btn-primary btn-sm rounded-0">Update</button>
                                                       </div>
                                                  </div>
                                             </form>
                                        </div>

                                        <div class="modal-footer">

                                        </div>
                                   </div>
                              </div>
                         </div>
                    <!-- end edit modal -->
                    .... 
                    // Start Passing Header Token
                    $.ajaxSetup({
                         headers:{
                              "X-CSRF-TOKEN": $("meta[name='csrf-token']").attr("content")
                         }
                    });
                    // End Passing Header Token

                    $(document).ready(function(){
                         // Start Edit Form
                         $(document).on("click",".editform",function(e){
                              
                              $("#editname").val($(this).attr("data-name"));
                              $("#editstatus_id").val($(this).data("status"));
                              
                              const getid = $(this).attr("data-id");
                              $("#formaction").attr("action",`/paymentmethods/${getid}`);
                              console.log(getid);
                         });

                         $("#formaction").submit(function(e){
                              e.preventDefault();

                              const getid = 1;
                              console.log(getid);

                              $.ajax({
                                   url:`paymentmethods/${getid}`,
                                   type:"PUT",
                                   dataType:"json",
                                   data:$("#formaction"),
                                   success:function(response){
                                        console.log(data);
                                   }
                              });

                              console.log("hello");
                         });
                         // End Edit Form

                    *Edit form doesn't need action and method.
                    *Error(PUT http://127.0.0.1:8000/paymentmethods/1 422 (Unprocessable Content))

                    =>In paymentmethods > index.blade.php 
                         // Start Edit Form
                         $(document).on("click",".editform",function(e){
                              
                              $("#editname").val($(this).attr("data-name"));
                              $("#editstatus_id").val($(this).data("status"));
                              
                              const getid = $(this).attr("data-id");
                              $("#formaction").attr("data-id",getid); // send id to formaction for request id from submit action
                              // console.log(getid);
                         });

                         $("#formaction").submit(function(e){
                              e.preventDefault();

                              const getid = $(this).attr("data-id");
                              console.log(getid);

                              $.ajax({
                                   url:`paymentmethods/${getid}`,
                                   type:"PUT",
                                   dataType:"json",
                                   data:$("#formaction").serialize(), // name=&status_id=4
                                   success:function(response){
                                        // console.log(this.data);  //name=kpay&status_id=3
                                        // console.log(response);   // paymentmethods:525 {status: 'success', data: {…}}
                                        console.log(response.status);
                                        $("#editmodal").modal("hide");

                                        // window.location.reload(); // temp reload

                                   }
                              });

                         });
                         // End Edit Form

                         *Transfering payment id to Edit form as attribute when cliking edit button. Use id data and submit ajax request. 
                         *$(formelment).serialize() get all form data. Not individual data with objects in previous status change.
                         *this.data is serialized form data not response data.
                         *UI remain irrelevant data because it is retrieved with php laravel by looping. After next reload, it is consistent.
                         *Upon the sucessful update, Edit Modal is hidden.
                         *Since avoiding reloading page, do not use js reload() 

                    =>Getting id for route 
                         =Way 2
                         =In paymentmethods > index.blade.php
                              <form id="formaction" action="" method="">
                                   <div class="row align-items-end">
                                        <div class="col-md-7">
                                             <label for="editname">Name <span class="text-danger">*</span></label>
                                             <input type="text" name="name" id="editname" class="form-control form-control-sm rounded-0" placeholder="Enter Status Name" value="{{ old('name') }}"/>
                                        </div>
                                        ....
                                        <input type="number" name="id" id="editid" hidden />
                                        ....
                                         // Start Edit Form
                                        $(document).on("click",".editform",function(e){
                                             
                                             $("#editname").val($(this).attr("data-name"));
                                             $("#editstatus_id").val($(this).data("status"));

                                             $("#editid").val($(this).attr("data-id"));
                                        });


                                        $("#formaction").submit(function(e){
                                             e.preventDefault();

                                             const getid = $("#editid").val();
                                             console.log(getid);

                                             $.ajax({
                                                  url:`paymentmethods/${getid}`,
                                                  type:"PUT",
                                                  dataType:"json",
                                                  data:$("#formaction").serialize(), // name=&status_id=4
                                                  success:function(response){
                                                       // console.log(this.data);  //name=kpay&status_id=3
                                                       // console.log(response);   // paymentmethods:525 {status: 'success', data: {…}}
                                                       console.log(response.status);
                                                       $("#editmodal").modal("hide");
                                                  }
                                             });

                                        });

          =>Ajax Quick Action 
               =In enrolls > index.blade.php 
                    <td>
                         <a href="javascript:void(0);" class="text-primary me-2 quickform" data-bs-toggle="modal" data-bs-target="#quickmodal" data-id="{{$enroll->id}}" data-stage="{{$enroll->stage_id}}" data-remark="{{$enroll->remark}}"><i class="fas fa-user-check"></i></a>
                         <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$enroll->id}}" data-stage_id="{{$enroll->stage_id}}"><i class="fas fa-pen"></i></a>
                    </td>
                    ....
                    <!-- START MODAL AREA -->
                         <!-- start quick modal -->
                         <div id="quickmodal" class="modal fade">
                              <div class="modal-dialog modal-dialog-centered">
                                   <div class="modal-content rounded-0">
                                        <div class="modal-header">
                                             <h6 class="modal-title">Quick Form</h6>
                                             <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>

                                        <div class="modal-body">
                                             <form id="quickformaction" action="" method="">
                                        
                                                  <div class="row align-items-end">
                                                       
                                                       <div class="col-md-3 form-group">
                                                            <label for="editstage_id">Stage <span class="text-danger">*</span></label>
                                                            <select name="editstage_id" id="editstage_id" class="form-control form-control-sm rounded-0">
                                                                 @foreach($stages as $stage)
                                                                      <option value="{{$stage->id}}">{{$stage->name}}</option> 
                                                                 @endforeach     
                                                            </select>
                                                       </div>

                                                       <div class="col-md-7 form-group">
                                                            <label for="editremark">Remark <span class="text-danger">*</span></label>
                                                            <input type="text" name="editremark" id="editremark" class="form-control form-control-sm rounded-0"/>
                                                       </div>
                                                       
                              
                                                       <div class="col-md-2">
                                                            <button type="submit" class="btn btn-primary btn-sm rounded-0">Update</button>
                                                       </div>
                                                  </div>
                                             </form>
                                        </div>

                                        <div class="modal-footer">

                                        </div>
                                   </div>
                              </div>
                         </div>
                         <!-- end quick modal -->
                    <!-- END MODAL AREA -->
                    ....

                    $.ajaxSetup({
                         headers:{
                              "X-CSRF-TOKEN" : $("meta[name='csrf-token']").attr("content")
                         }
                    });
                    $(document).ready(function(){

                         // Start Edit Form
                         $(document).on("click",".quickform",function(){
                              $("#editstage_id").val($(this).attr("data-stage"));
                              $("#editremark").val($(this).attr("data-remark"));

                              const getid = $(this).data("id");
                              // console.log(getid);

                              $("#quickformaction").attr("data-id",getid);
                         });

                         $("#quickformaction").submit(function(e){
                              e.preventDefault();

                              const getid = $(this).attr("data-id");

                              $.ajax({
                                   url:`enrolls/${getid}`,
                                   type:"PUT",
                                   dataType:"json",
                                   data: $(this).serialize(),
                                   success:function(response){
                                        if(response && response.status === "success"){
                                             console.log(response);
                                             $("#quickmodal").modal("hide");
                                        }
                                   }
                              });
                         });

                         // End Edit Form

               *Transfering enroll id to Quick form as attribute when cliking quick action button. Use id data and submit ajax request. 
               *Chrome's inxpect Element Tab
                    <form id="quickformaction" action="" method="" data-id="11">
               *dynamically change id

               *Admin can write remark for the enrollment and change enroll stage.

               =In EnrollsController.php 
                    public function update(Request $request, string $id)
                    {

                         $user = Auth::user();
                         $user_id = $user->id;

                         try{
                              $enroll = Enroll::findOrFail($id);
                              $enroll->stage_id = $request["editstage_id"];
                              $enroll->remark = $request["editremark"];
                              $enroll->user_id = $user_id;
                              $enroll->save();   
                              if($enroll){
                                   return response()->json(["status"=>"success","data"=>$enroll]);
                              }

                              return response()->json(["status"=>"failed","message"=>"Failed to update"]);
                         }catch(Exception $e){
                              Log::error($e->getMessage());
                              return response()->json(["status"=>"failed","message"=>$e->getMessage()]);
                         }
                    }

          =>Ajax Create
               =In payments > index.blade.php 
                    <form id="createform" action="" method="">

                         <div class="row align-items-end">
                              <div class="col-md-4">
                                   <label for="name">Name <span class="text-danger">*</span></label>
                                   @error("name")
                                        <span class="text-danger">{{ $message }}<span>
                                   @enderror
                                   <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Type Name" value="{{ old('name') }}"/>
                              </div>

                              <div class="col-md-4">
                                   <label for="status_id">Status</label>
                                   @error("status_id")
                                        <span class="text-danger">{{ $message }}<span>
                                   @enderror
                                   <select name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                                        @foreach($statuses as $status)
                                             <option value="{{$status['id']}}">{{$status['name']}}</option>
                                        @endforeach     
                                   </select>
                              </div>

                              <div class="col-md-4">
                                   <button type="reset" class="btn btn-secondary btn-sm rounded-0">Cancel</button>
                                   <button type="submit" id="create-btn" class="btn btn-primary btn-sm rounded-0 ms-3">Submit</button>
                              </div>
                         </div>
                    </form>
                    ....
                    $(document).ready(function(){

                    // Start Passing Header Token
                    $.ajaxSetup({
                         headers:{
                              "X-CSRF-TOKEN": $("meta[name='csrf-token']").attr("content")
                         }
                    });
                    // End Passing Header Token

                    // Start Create Form
                    $("#create-btn").click(function(e){
                         e.preventDefault();
                         
                         $.ajax({
                              url:"{{route('paymentmethods.store')}}",
                              type:"POST",
                              dataType:"json",
                              // data:$("#createform").serialize(),
                              data:$("#createform").serializeArray(),
                              success:function(response){
                                   console.log(response);
                                   console.log(response.status);
                              },
                              error:function(response){
                                   console.log("Error:",response);
                              }
                         })
                    });
                    // End Create Form

                    *result (response)
                         {status: 'success', data: {…}}
                         data: {name: 'truemoney', slug: 'truemoney', status_id: '3', user_id: 1, updated_at: '2024-05-16T12:03:52.000000Z', …}
                         status: "success"
                         [[Prototype]]: Object

                         *response.data can be used in prompting alert box when the item is created.

               =In PaymentmethodsController.php 
                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "name" => "required|max:50|unique:paymentmethods",
                              "status_id" => "required|in:3,4",
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         try{
                              $paymentmethod = new Paymentmethod();
                              $paymentmethod->name = $request["name"];
                              $paymentmethod->slug = Str::slug($request["name"]);
                              $paymentmethod->status_id = $request["status_id"];
                              $paymentmethod->user_id = $user_id;
                              $paymentmethod->save();

                              if($paymentmethod){
                                   return response()->json(["status"=>"success","data"=>$paymentmethod]);
                              }
                         }catch(Exception $e){
                              Log::error($e->getMessage());
                              return response()->json(["status"=>"failed","message"=>$e->getMessage()]);
                         }

                         
                    }

               *New item is not instantly appear on UI.
               *To see the added item, reload the web page.

               =>Reflecting created data 
                    =In  payments > index.blade.php 
                         $.ajax({
                              url:"{{route('paymentmethods.store')}}",
                              type:"POST",
                              dataType:"json",
                              // data:$("#createform").serialize(),
                              data:$("#createform").serializeArray(),
                              success:function(response){
                                   console.log(response);
                                   // console.log(response.status);
                                   // console.log(this.data);

                                   const data = response.data;
                                   $("#mytable").prepend(
                                        `
                                        <tr id="${'delete_'+data.id}">
                                             <td>${data.id}</td>
                                             <td>${data.name}</td>
                                             <td>
                                                  <div class="form-checkbox form-switch">
                                                       <input type="checkbox" class="form-check-input change-btn" ${data.status_id === 3 ? "checked" : ""} data-id="${data.id}" />
                                                  </div>
                                             </td>
                                             <td>${data.user_id}</td>
                                             <td>${data.created_at}</td>
                                             <td>${data.updated_at}</td>
                                             <td>
                                                  <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="${data.id}" data-name="${data.name}" data-status="${data.status_id}"><i class="fas fa-pen"></i></a>
                                                  <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="" data-id="${data.id}"><i class="fas fa-trash-alt"></i></a>
                                             </td>
                                        </tr>
                                        `
                                   );
                              },
                              error:function(response){
                                   console.log("Error:",response);
                              }
                         })

                    *result (UI)
                    Number    Name      Status    By        Created At                    Updaed At     
                    18	     1005	               1	     2024-05-17T07:17:24.000000Z	2024-05-17T07:17:24.000000Z
                    
                    *New added item instantly appear on UI but there are some weak points.
                    *It will display table id not index number. It is complicated to implement index number with php code and js code.
                    *It display user as integer number. Created/Updated date and time are not formated. 

     =>Social Application 
          =Migration
               php artisan make:model Socialapplication -m

               =In create_socialapplications_table.php
                    up()
                         $table->string("name")->unique();
                         $table->string("slug");
                         $table->unsignedBigInteger("status_id");
                         $table->unsignedBigInteger("user_id");

               php artian migrate:status 
               php artisan migrate

          =In Socialapplication.php
               protected $table = "socialapplications";
               protected $primaryKey = "id";
               protected $fillable = [
                    "name",
                    "slug",
                    "status_id",
                    "user_id"
               ];

               public function user(){
                    return $this->belongsTo(User::class);
               }

               public function status(){
                    return $this->belongsTo(Status::class);
               }

          php artisan make:controller SocialapplicationsController
          
          =In web.php
               *use App\Http\Controllers\SocialapplicationsController;
               Route::resource("socialapplications",SocialapplicationsController::class);
               Route::get("/socialapplicationsstatus",[SocialapplicationsController::class,"typestatus"]);
               
          =In SocialapplicationsController.php 
               <?php

               namespace App\Http\Controllers;

               use Illuminate\Http\Request;
               use App\Models\Status;
               use App\Models\Socialapplication;
               use Illuminate\Support\Facades\Auth;
               use Illuminate\Support\Str;
               use Illuminate\Support\Facades\Log;
               use Exception;

               class SocialapplicationsController extends Controller
               {
                    public function index()
                    {
                         $socialapplications = Socialapplication::all();
                         $statuses = Status::whereIn("id",[3,4])->get();
                         return view("socialapplications.index",compact("socialapplications","statuses"));
                    }


                    public function create()
                    {
                         $statuses = Status::whereIn("id",[3,4])->get();
                         return view("socialapplications.create",compact("statuses"));
                    }


                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "name" => "required|max:50|unique:socialapplications",
                              "status_id" => "required|in:3,4",
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         try{
                              $socialapplication = new Socialapplication();
                              $socialapplication->name = $request["name"];
                              $socialapplication->slug = Str::slug($request["name"]);
                              $socialapplication->status_id = $request["status_id"];
                              $socialapplication->user_id = $user_id;
                              $socialapplication->save();

                              if($socialapplication){
                                   return response()->json(["status"=>"success","data"=>$socialapplication]);
                              }
                         }catch(Exception $e){
                              Log::error($e->getMessage());
                              return response()->json(["status"=>"failed","message"=>$e->getMessage()]);
                         }

                         
                    }

                    public function update(Request $request, string $id)
                    {
                         $this->validate($request,[
                              "name" => ["required","max:50","unique:socialapplications,name,".$id],
                              "status_id" => ["required","in:3,4"],
                         ]);

                         $user = Auth::user();
                         $user_id = $user["id"];

                         try{
                              $socialapplication = Socialapplication::findOrFail($id);
                              $socialapplication->name = $request["name"];
                              $socialapplication->slug = Str::slug($request["name"]);
                              $socialapplication->status_id = $request["status_id"];
                              $socialapplication->user_id = $user_id;
                              $socialapplication->save();

                              if($socialapplication){
                                   return response()->json(["status"=>"success","data"=>$socialapplication]);
                              }
                              return response()->json(["status"=>"failed","data"=>"Failed to update Payment Method"]);
                         }catch(Exception $e){
                              Log:error($e->getMessage());
                              return response()->json(["status"=>"failed","message"=>$e->getMessage()]);
                         }
                         
                    }

                    public function destroy(Socialapplication $socialapplication)
                    {
                         try{
                              if($socialapplication){
                                   $socialapplication->delete();
                                   return response()->json(["status"=>"success","data"=>$socialapplication,"message"=>"Delete Successfully"]);
                              }
                              return response()->json(["status"=>"failed","message"=>"No Data Found"]);
                         }catch(Exception $e){
                              Log::error($e->getmessage());
                              return response()->json(["status"=>"failed","message"=>$e->getMessage()]);
                         }
                    }

                    public function typestatus(Request $request){
                         $socialapplication = Socialapplication::findOrFail($request["id"]);
                         $socialapplication->status_id = $request["status_id"];
                         $socialapplication->save();

                         return response()->json(["success"=>"Status Change Successfully"]);
                    }
               }

          =>Ajax create 
               =In socialapplications > index.blade.php 
                    <!-- Start Page Content Area -->
                    <div class="container-fluid">
                         
                         <div class="col-md-12">
                              <a href="javascript:void(0);" id="modal-btn" class="btn btn-primary btn-sm rounded-0">Create</a>
                         </div>
                         
                         <hr/>

                         <div class="col-md-12">
                              
                              <table id="mytable" class="table table-sm table-hover border">
                         
                                   <thead>
                                        <th>No</th>
                                        <th>Name</th>
                                        <th>Status</th>
                                        <th>By</th>
                                        <th>Created At</th>
                                        <th>Updated At</th>
                                        <th>Action</th>
                                   </thead>
                         
                                   <tbody>
                                        @foreach($socialapplications as $idx=>$socialapplication)
                                        <tr id="delete_{{$socialapplication->id}}">
                                             <td>{{++$idx}}</td>
                                             <td>{{$socialapplication["name"]}}</td>
                                             <td>
                                                  <div class="form-checkbox form-switch">
                                                       <input type="checkbox" class="form-check-input change-btn" {{  $socialapplication->status_id === 3 ? 'checked' : '' }} data-id="{{ $socialapplication->id }}" />
                                                  </div>
                                             </td>
                                             <td>{{ $socialapplication["user"]["name"] }}</td>
                                             <td>{{ $socialapplication->created_at->format('d M Y') }}</td>
                                             <td>{{ $socialapplication->updated_at->format('d M Y') }}</td>
                                             <td>
                                                  <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$socialapplication->id}}" data-name="{{$socialapplication->name}}" data-status="{{$socialapplication->status_id}}"><i class="fas fa-pen"></i></a>
                                                  <!-- <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a> -->
                                                  <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}" data-id="{{$socialapplication->id}}"><i class="fas fa-trash-alt"></i></a>
                                             </td>
                                        </tr>
                                        @endforeach
                                   </tbody>
                         
                              </table>
                         

                         </div>
                    </div>
                    <!-- End Page Content Area -->

                    <!-- START MODAL AREA -->
                         <!-- start create modal -->
                         <div id="createmodal" class="modal fade">
                              <div class="modal-dialog modal-dialog-centered">
                                   <div class="modal-content rounded-0">
                                        <div class="modal-header">
                                             <h6 class="modal-title">Create Form</h6>
                                             <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>

                                        <div class="modal-body">
                                             <form id="formaction" action="" method="">
                                                  <div class="row align-items-end">
                                                       <div class="col-md-7">
                                                            <label for="name">Name <span class="text-danger">*</span></label>
                                                            <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Application Name" value="{{ old('name') }}"/>
                                                       </div>
                                                       
                                                       <div class="col-md-3 form-group">
                                                            <label for="status_id">Status</label>
                                                            <select name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                                                                 @foreach($statuses as $status)
                                                                      <option value="{{$status['id']}}">{{$status['name']}}</option>
                                                                 @endforeach     
                                                            </select>
                                                       </div>
                                                       
                              
                                                       <div class="col-md-2">
                                                            <button type="submit" class="btn btn-primary btn-sm rounded-0">Submit</button>
                                                       </div>
                                                  </div>
                                             </form>
                                        </div>

                                        <div class="modal-footer">

                                        </div>
                                   </div>
                              </div>
                         </div>
                         <!-- end create modal -->
                    ....
                    $(document).ready(function(){

                    // Start Passing Header Token
                    $.ajaxSetup({
                         headers:{
                              "X-CSRF-TOKEN": $("meta[name='csrf-token']").attr("content")
                         }
                    });
                    // End Passing Header Token

                    // Start Create Form
                         $("#modal-btn").click(function(){
                              $("#createmodal").modal("show"); // toggle() can also used.
                         });

                         $("#formaction").validate({
                              rules:{
                                   name:"required"
                              },
                              messages:{
                                   name:"Please enter the application name"
                              },

                              submitHandler:function(form){
                                   // let formdata = $("#formaction").serialize();
                                   // let formdata = $("#formaction").serializeArray();
                                   let formdata = $("#formaction").serialize();
                                   // let formdata = $("#formaction").serializeArray();

                                   $.ajax({
                                        url: "{{route('socialapplications.store')}}",
                                        type:"POST",
                                        data: formdata,
                                        dataType:"json",
                                        success:function(response){
                                             console.log(response);
                                             // console.log(response.status);
                                             
                                             if(response && response.status === "success"){
                                                  $("#createmodal").modal("hide"); // toggle() can also used.
                                             }
                                        },
                                        error:function(response){
                                             console.log("Error:",response);
                                        }
                                   })
                              }
                         });
                    // End Create Form

               =Show modal using javascript

               =>jQuery Validate 
                    =to validate the form in frontend

                    =Google >  jquery validate
                    =open jQuery Validation Plugin site
                    =copy compressed file link (https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js) 
                    =integrate the file within the system
                    =Explore Documentation (https://jqueryvalidation.org/validate/)

                    .validate() is jquery based plug in.
                    *Error (Uncaught TypeError: $(...).validate is not a function)

                    submitHandler - Callback for handling the actual submit when the form is valid.
                    form - The form currently being validated, as a DOMElement.

                    rules: property specify the validation rules for each input. Rules can be single or compound.
                    message: property specify the validation error messages if the entry do not match the specified rules.

               =Create social application with same name (Without commenting laravel validation)
                    *error (from laravel)
                    POST http://127.0.0.1:8000/socialapplications 422 (Unprocessable Content)
                    Error: {readyState: 4, getResponseHeader: ƒ, getAllResponseHeaders: ƒ, setRequestHeader: ƒ, overrideMimeType: ƒ, …}
               =Create social application with same name (With commenting laravel validation)
                    *error (from database)
                    {status: 'failed', message: 'SQLSTATE[23000]: Integrity constraint violation: 1… 3, 1, 2024-05-17 18:19:08, 2024-05-17 18:19:08))'}
               
               =Create social appliation with empty name (After jQuery validate())
                    *Error Message display below the form field.

               =>Wiping Previous Form data 
                    =In socialapplications > index.blade.php
                         // Start Create Form
                         $("#modal-btn").click(function(){
                         
                              // clear form data
                              console.log($("#formaction")); // E.fn.init {0: form#formaction, length: 1}
                              console.log($("#formaction")[0]); // if you use reset(), that element can't be array.
                              // =method 1
                              // $("#formaction")[0].reset();

                              // =method 2
                              $("#formaction").trigger("reset");

                              $("#createmodal").modal("show"); // toggle() can also used.
                         
                         }); 

                    =create a socialapplication
                    =*do not reload
                    =create another socialapplication
                    =the prior form data still remain

                    *$("#formaction") returns a jQuery object, which is a specialized array-like object.
                    *To use reset(), It muse be an element especially form element.
                         So to obtain the absolute element, access the array with index number.$("#formaction")[0] 

                    The trigger() method activates the specified event.
                    
          =>Ajax delete
               =In SocialapplicationsController.php
                    *use Illuminate\Support\Facades\Response;
                    
                    public function destroy(string $id)
                    {
                         try{
                              $socialapplication = Socialapplication::where("id",$id)->delete();
                              return Response::json($socialapplication);

                         }catch(Exception $e){
                              Log::error($e->getmessage());
                              return response()->json(["status"=>"failed","message"=>$e->getMessage()]);
                         }
                    }

                    *Using Laravel default parameter strind id, not modal class object.
                    *Using Response class and its json method.
                    *If succcess, it will return 1. If encounter problem, it will return error message.
                         because it do not directly return the deletet item. It return after excuting delete().

               =In socialapplications > index.blade.php 
                    // by ajax 
                    // Using default laravel route
                    $(".delete-btns").click(function(){
                         const getidx = $(this).attr("data-idx");
                         const getid = $(this).data("id");
                         // console.log(getid);
                         
                         if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
                         
                              // data remove 
                              $.ajax({
                                   url:`socialapplications/${getid}`,
                                   type:"DELETE",
                                   dataType:"json",
                                   // data:{_token:"{{csrf_token()}}"},
                                   success:function(response){
                                        console.log(response);   // 1
                                        
                                        if(response){
                                             // ui remove
                                             $(`#delete_${getid}`).remove();
                                        }
                                   },
                                   error:function(response){
                                        console.log("Error: ",response)
                                   }
                              });
                              return true;
                         }else{
                              return false;
                         }
                    });

                    // End Delete Item

               *Server return boolean value, can't use response.data for deleted item.
               So that,getid value from delete btn is used.

          =>Single modal box and form for create/edit 
               =>Create Segment
                    =In socialapplications > index.blade.php 
                         <div class="col-md-12">
                              <a href="javascript:void(0);" id="modal-btn" class="btn btn-primary btn-sm rounded-0">Create</a>
                         </div>
                         ....
                         <!-- start create modal -->
                         <div id="createmodal" class="modal fade">
                              <div class="modal-dialog modal-dialog-centered">
                                   <div class="modal-content rounded-0">
                                        <div class="modal-header">
                                             <h6 class="modal-title">Modal Title</h6>
                                             <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>

                                        <div class="modal-body">
                                             <form id="formaction" action="" method="">
                                                  <div class="row align-items-end">
                                                       <div class="col-md-7">
                                                            <label for="name">Name <span class="text-danger">*</span></label>
                                                            <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Application Name" value="{{ old('name') }}"/>
                                                       </div>
                                                       
                                                       <div class="col-md-3 form-group">
                                                            <label for="status_id">Status</label>
                                                            <select name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                                                                 @foreach($statuses as $status)
                                                                      <option value="{{$status['id']}}">{{$status['name']}}</option>
                                                                 @endforeach     
                                                            </select>
                                                       </div>
                                                       
                              
                                                       <div class="col-md-2">
                                                            <button type="submit" id="action-btn" class="btn btn-primary btn-sm rounded-0" value="action-type">Submit</button>
                                                       </div>
                                                  </div>
                                             </form>
                                        </div>

                                        <div class="modal-footer">

                                        </div>
                                   </div>
                              </div>
                         </div>
                         <!-- end create modal -->
                         ....
                         $(document).ready(function(){

                              // Start Passing Header Token
                              $.ajaxSetup({
                                   headers:{
                                        "X-CSRF-TOKEN": $("meta[name='csrf-token']").attr("content")
                                   }
                              });
                              // End Passing Header Token

                              // Start Create Form
                              $("#modal-btn").click(function(){
                              
                                   // clear form data
                                   // console.log($("#formaction")); // E.fn.init {0: form#formaction, length: 1}
                                   // console.log($("#formaction")[0]); // if you use reset(), that element can't be array.
                                   // =method 1
                                   // $("#formaction")[0].reset();

                                   // =method 2
                                   $("#formaction").trigger("reset");

                                   $("#createmodal").modal("show"); // toggle() can also used.
                                   
                                   $("#createmodal .modal-title").text("Create Form");
                              });

                              $("#formaction").validate({
                                   rules:{
                                        name:"required"
                                   },
                                   messages:{
                                        name:"Please enter the application name"
                                   },

                                   submitHandler:function(form){
                                        // let formdata = $("#formaction").serialize();
                                        // let formdata = $("#formaction").serializeArray();
                                        let formdata = $(form).serialize();
                                        // let formdata = $(form).serializeArray();

                                        $("#action-btn").text("Sending....");

                                        $.ajax({
                                             url: "{{route('socialapplications.store')}}",
                                             type:"POST",
                                             data: formdata,
                                             dataType:"json",
                                             success:function(response){
                                                  console.log(response);
                                                  // console.log(response.status);
                                                  
                                                  if(response && response.status === "success"){
                                                       $("#createmodal").modal("hide"); // toggle() can also used.
                                                       
                                                       const data = response.data;
                                                       let html = `
                                                       <tr id="delete_${data.id}">
                                                            <td>${data.id}</td>
                                                            <td>${data.name}</td>
                                                            <td>
                                                                 <div class="form-checkbox form-switch">
                                                                      <input type="checkbox" class="form-check-input change-btn" ${data.status_id == 3 ? "checked" : "" }  data-id="${data.id}" />
                                                                 </div>
                                                            </td>
                                                            <td>${data.user_id}</td>
                                                            <td>${data.created_at}</td>
                                                            <td>${data.updated_at}</td>
                                                            <td>
                                                                 <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="${data.id}" data-name="${data.name}" data-status="${data.status_id}"><i class="fas fa-pen"></i></a>
                                                                 <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="${data.id}" data-id="${data.id}"><i class="fas fa-trash-alt"></i></a>
                                                            </td>
                                                       </tr>
                                                       `;
                                                       $("#mytable tbody").prepend(html);

                                                       $("#action-btn").html("Sutmit");
                                                  }
                                             },
                                             error:function(response){
                                                  console.log("Error:",response);
                                             }
                                        })
                                   }
                              });
                              // End Create Form

                    *Change Modal Title describing whether to create or update
                    *Submit button is for two purpose, create or update
                    
                    *result 
                    let html = `
                         <tr id="delete_{{$socialapplication->id}}">
                              <td>{{++$idx}}</td>
                              <td>{{$socialapplication["name"]}}</td>
                              <td>
                                   <div class="form-checkbox form-switch">
                                        <input type="checkbox" class="form-check-input change-btn" {{  $socialapplication->status_id === 3 ? 'checked' : '' }} data-id="{{ $socialapplication->id }}" />
                                   </div>
                              </td>
                              <td>{{ $socialapplication["user"]["name"] }}</td>
                              <td>{{ $socialapplication->created_at->format('d M Y') }}</td>
                              <td>{{ $socialapplication->updated_at->format('d M Y') }}</td>
                              <td>
                                   <a href="javascript:void(0);" class="text-info editform" data-bs-toggle="modal" data-bs-target="#editmodal" data-id="{{$socialapplication->id}}" data-name="{{$socialapplication->name}}" data-status="{{$socialapplication->status_id}}"><i class="fas fa-pen"></i></a>
                                   <!-- <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}"><i class="fas fa-trash-alt"></i></a> -->
                                   <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}" data-id="{{$socialapplication->id}}"><i class="fas fa-trash-alt"></i></a>
                              </td>
                         </tr>
                         `;
                    
                    3	kpay	admin	18 May 2024	18 May 2024
                    *show the last entry, looping stop in endmost item. 

                    *It will display the user as integer. This is because we use the ajax and blade with default laravel route not api route.

                    *Should not check condition with triple equal to ${data.status_id === 3 ? "checked" : "" }
                         it do not show the correct ouput.
                         =creaet a social application with status "on"
                         =ui show the off switch.

                         -ajax response present the data as string.

                    =>Sending Button when data submiting to server 
                         =create a socialapplication freely 
                         =Button change text to Sending and shortly revert to text Submit

                         =create a socialapplication with the same name 
                         =Button change text to Sending permanently and do not revert to text Submit
                              Because the item is not created errorlessly (Duplicate Entry).

                         =create a socialapplication freely while the button is Sending
                         =It can create an item and already added the item in UI. 

               =>Edit Segment 
                    =In socialapplications > index.blade.php
                         <td>
                              <a href="javascript:void(0);" class="text-info edit-btns" data-id="{{$socialapplication->id}}" ><i class="fas fa-pen"></i></a>
                              <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}" data-id="{{$socialapplication->id}}"><i class="fas fa-trash-alt"></i></a>
                         </td>
                         ....

                              let html = `
                              <tr id="delete_${data.id}">
                                   <td>${data.id}</td>
                                   <td>${data.name}</td>
                                   <td>
                                        <div class="form-checkbox form-switch">
                                             <input type="checkbox" class="form-check-input change-btn" ${data.status_id == 3 ? "checked" : "" }  data-id="${data.id}" />
                                        </div>
                                   </td>
                                   <td>${data.user_id}</td>
                                   <td>${data.created_at}</td>
                                   <td>${data.updated_at}</td>
                                   <td>
                                        <a href="javascript:void(0);" class="text-info edit-btns" data-id="${data.id}" ><i class="fas fa-pen"></i></a>
                                        <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="${data.id}" data-id="${data.id}"><i class="fas fa-trash-alt"></i></a>
                                   </td>
                              </tr>
                         ....
                         // Start Edit Form
                              $(document).on("click",".edit-btns",function(){
                                   const getid = $(this).data("id");
                                   // console.log(getid);

                                   $.get(`socialapplications/${getid}/edit`,function(response){
                                        // console.log(response); // {id: 9, name: 'myanmar', slug: 'myanmar', status_id: 3, user_id: 1, …}
                                   
                                        $("#createmodal .modal-title").text("Edit Form");
                                        $("#createmodal").modal("show"); // toggle() can also used.
                                        
                                        $("#name").val(response.name);
                                        $("#status_id").val(response.status_id);
                                   });
                              });
                         // End Edit Form

                    *Retrieve data from database instead of getting data passing from ui 
                    *Get dynamic data from database when clicking edit btn and display them in edit modal

                    =>In SocialapplicationsController.php 
                         public function edit(string $id){
                              $socialapplication = Socialapplication::findOrFail($id);
                              return response()->json($socialapplication);
                         }
                    *direct database response not from data

                    =edit a socialapplication
                    *result (inserting new socialapplication)
                         23	indonesia	1	2024-05-19T09:59:28.000000Z	2024-05-19T09:59:28.000000Z

                    *The submit button is not defined clearly for both create and edit

                    =>Designating Submit Btn
                         =In socialapplications > index.blade.php 
                              <div class="col-md-2">
                                   <button type="submit" id="action-btn" class="btn btn-primary btn-sm rounded-0" value="action-type">Submit</button>
                              </div>
                              ....
                              <form id="formaction" action="" method="">
                                   <div class="row align-items-end">
                                        <div class="col-md-7">
                                             <label for="name">Name <span class="text-danger">*</span></label>
                                             <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Application Name" value="{{ old('name') }}"/>
                                        </div>
                                        
                                        <div class="col-md-3 form-group">
                                             <label for="status_id">Status</label>
                                             <select name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                                                  @foreach($statuses as $status)
                                                       <option value="{{$status['id']}}">{{$status['name']}}</option>
                                                  @endforeach     
                                             </select>
                                        </div>
                                        
                                        <input type="hidden" name="id" id="id"/>

                                        <div class="col-md-2">
                                             <button type="submit" id="action-btn" class="btn btn-primary btn-sm rounded-0" value="action-type">Submit</button>
                                        </div>
                                   </div>
                              </form>
                              ....
                              $("#formaction").validate({
                                   rules:{
                                        name:"required"
                                   },
                                   messages:{
                                        name:"Please enter the application name"
                                   },

                                   submitHandler:function(form){
                                        let actiontype = $("#action-btn").val();
                                        console.log(actiontype);

                                        if(actiontype === "create-btn"){
                                             let formdata = $(form).serialize();

                                             $("#action-btn").text("Sending....");

                                             $.ajax({
                                                  url: "{{route('socialapplications.store')}}",
                                                  type:"POST",
                                                  data: formdata,
                                                  dataType:"json",
                                                  success:function(response){
                                                       console.log(response);
                                                       // console.log(response.status);
                                                       
                                                       if(response && response.status === "success"){
                                                            $("#createmodal").modal("hide"); // toggle() can also used.
                                                            
                                                            const data = response.data;
                                                            let html = `
                                                            <tr id="delete_${data.id}">
                                                                 <td>${data.id}</td>
                                                                 <td>${data.name}</td>
                                                                 <td>
                                                                      <div class="form-checkbox form-switch">
                                                                           <input type="checkbox" class="form-check-input change-btn" ${data.status_id == 3 ? "checked" : "" }  data-id="${data.id}" />
                                                                      </div>
                                                                 </td>
                                                                 <td>${data.user_id}</td>
                                                                 <td>${data.created_at}</td>
                                                                 <td>${data.updated_at}</td>
                                                                 <td>
                                                                      <a href="javascript:void(0);" class="text-info edit-btns" data-id="${data.id}" ><i class="fas fa-pen"></i></a>
                                                                      <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="${data.id}" data-id="${data.id}"><i class="fas fa-trash-alt"></i></a>
                                                                 </td>
                                                            </tr>
                                                            `;
                                                            $("#mytable tbody").prepend(html);

                                                            $("#action-btn").html("Sutmit");
                                                       }
                                                  },
                                                  error:function(response){
                                                       console.log("Error:",response);
                                                  }
                                             })
                                        }else{
                                             const getid = $("#id").val();
                                             
                                             $.ajax({
                                                  url:`socialapplications/${getid}`,
                                                  type:"PUT",
                                                  dataType:"json",
                                                  data:$("#formaction").serialize(), // name=&status_id=4
                                                  success:function(response){
                                                       // console.log(this.data);  //name=kpay&status_id=3
                                                       console.log(response);   // paymentmethods:525 {status: 'success', data: {…}}
                                                       // console.log(response.status);
                                                       const data = response.data;
                                                       let html = `
                                                            <tr id="delete_${data.id}">
                                                                 <td>${data.id}</td>
                                                                 <td>${data.name}</td>
                                                                 <td>
                                                                      <div class="form-checkbox form-switch">
                                                                           <input type="checkbox" class="form-check-input change-btn" ${data.status_id == 3 ? "checked" : "" }  data-id="${data.id}" />
                                                                      </div>
                                                                 </td>
                                                                 <td>${data.user_id}</td>
                                                                 <td>${data.created_at}</td>
                                                                 <td>${data.updated_at}</td>
                                                                 <td>
                                                                      <a href="javascript:void(0);" class="text-info edit-btns" data-id="${data.id}" ><i class="fas fa-pen"></i></a>
                                                                      <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="${data.id}" data-id="${data.id}"><i class="fas fa-trash-alt"></i></a>
                                                                 </td>
                                                            </tr>
                                                            `;
                                                       $("#delete_"+data.id).replaceWith(html);
                                                       
                                                       $("#createmodal").modal("hide");

                                                       // window.location.reload(); // temp reload
                                                  }
                                             });
                                        }
                                   }
                              });
                              // Start Edit Form
                                   $(document).on("click",".edit-btns",function(){
                                        const getid = $(this).data("id");
                                        // console.log(getid);

                                        $.get(`socialapplications/${getid}/edit`,function(response){
                                             // console.log(response); // {id: 9, name: 'myanmar', slug: 'myanmar', status_id: 3, user_id: 1, …}
                                        
                                             $("#createmodal .modal-title").text("Edit Form");
                                             $("#action-btn").text("Update");
                                             $("#action-btn").val("edit-btn");
                                             $("#createmodal").modal("show"); // toggle() can also used.
                                             
                                             $("#id").val(response.id);
                                             $("#name").val(response.name);
                                             $("#status_id").val(response.status_id);
                                        });
                                   });
                              // End Edit Form
                    
                         *Chrome's inspect > Element
                              =Initial State
                                   <button type="submit" id="action-btn" class="btn btn-primary btn-sm rounded-0" value="action-type">Submit</button>         
                              =After Clicking Create Button 
                                   <button type="submit" id="action-btn" class="btn btn-primary btn-sm rounded-0" value="create-btn">Submit</button>

                              Click create means submit form to store new item 
                              Click Edit icon mean update the existing item

                         *Passing socialapplication id as from input
                              -get id from response and pass to hidden input
                               *Chrome's inspect > Element
                                   =Click Create btn 
                                        <input type="hidden" name="id" id="id">
                                   =Click Edit Btn 
                                        <input type="hidden" name="id" id="id" value="18">
          
          =>Ajsx Concept
               Create (Store into database and show in UI)
               Edit (Retrieve from database and display in modal and show in UI)
               Delete (Delete from database and remove from UI)

          =>My Own Create Update Single Form 

               =>Create Part
                    <div class="col-md-12">
                         <a href="javascript:void(0);" id="create-btn" class="btn btn-primary btn-sm rounded-0">Create</a>
                    </div>
                    ....
                    <!-- start create edit modal -->
                         <div id="cemodal" class="modal fade">
                              <div class="modal-dialog modal-dialog-centered">
                                   <div class="modal-content rounded-0">
                                        <div class="modal-header">
                                             <h6 class="modal-title">Modal Title</h6>
                                             <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>

                                        <div class="modal-body">
                                             <form id="formaction" action="" method="">
                                                  <div class="row align-items-end">
                                                       <div class="col-md-7">
                                                            <label for="name">Name <span class="text-danger">*</span></label>
                                                            <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Application Name" value="{{ old('name') }}"/>
                                                       </div>
                                                       
                                                       <div class="col-md-3 form-group">
                                                            <label for="status_id">Status</label>
                                                            <select name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                                                                 @foreach($statuses as $status)
                                                                      <option value="{{$status['id']}}">{{$status['name']}}</option>
                                                                 @endforeach     
                                                            </select>
                                                       </div>
                                                       
                                                       <div class="col-md-2">
                                                            <button type="submit" id="action-btn" class="btn btn-primary btn-sm rounded-0" value="action-type">Submit</button>
                                                       </div>
                                                  </div>
                                             </form>
                                        </div>

                                        <div class="modal-footer">

                                        </div>
                                   </div>
                              </div>
                         </div>
                    <!-- end create edit modal -->
                    ....

                    $(document).ready(function(){

                         // Start Passing Header Token
                         $.ajaxSetup({
                              headers:{
                                   "X-CSRF-TOKEN": $("meta[name='csrf-token']").attr("content")
                              }
                         });
                         // End Passing Header Token

                    
                         $("#create-btn").click(function(){
                              // Clearing previous form data
                              $("#formaction").trigger("reset");

                              // Preparing modal and form for create
                              $("#cemodal .modal-title").text("Create Form");
                              $("#action-btn").html("Sutmit");
                              $("#action-btn").val("creating");

                              // Showing modal
                              $("#cemodal").modal("show");
                         });

                         $("#formaction").validate({
                              rules:{
                                   name:"required"
                              },
                              messages:{
                                   name:"Please enter the application name"
                              },

                              submitHandler:function(form){
                                   let actiontype = $("#action-btn").val();
                                   console.log(actiontype);

                                   if(actiontype === "creating"){
                                        let formdata = $(form).serialize();

                                        $("#action-btn").text("Sending....");

                                        $.ajax({
                                             url: "{{route('socialapplications.store')}}",
                                             type:"POST",
                                             data: formdata,
                                             dataType:"json",
                                             success:function(response){
                                                  console.log(response);
                                                  // console.log(response.status);
                                                  
                                                  if(response && response.status === "success"){
                                                       
                                                       const data = response.data;
                                                       let html = `
                                                       <tr id="socialapp_${data.id}">
                                                            <td>${data.id}</td>
                                                            <td>${data.name}</td>
                                                            <td>
                                                                 <div class="form-checkbox form-switch">
                                                                      <input type="checkbox" class="form-check-input change-btn" ${data.status_id == 3 ? "checked" : "" }  data-id="${data.id}" />
                                                                 </div>
                                                            </td>
                                                            <td>${data.user_id}</td>
                                                            <td>${data.created_at}</td>
                                                            <td>${data.updated_at}</td>
                                                            <td>
                                                                 <a href="javascript:void(0);" class="text-info edit-btns" data-id="${data.id}" ><i class="fas fa-pen"></i></a>
                                                                 <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="${data.id}" data-id="${data.id}"><i class="fas fa-trash-alt"></i></a>
                                                            </td>
                                                       </tr>
                                                       `;
                                                       $("#mytable tbody").prepend(html);

                                                       $("#action-btn").html("Sutmit");

                                                       // Hide modal after adding social app item
                                                       $("#cemodal").modal("hide"); 
                                                  }
                                             },
                                             error:function(response){
                                                  console.log("Error:",response);
                                             }
                                        })
                                   }

               =>Edit Part
                    <td>
                         <a href="javascript:void(0);" class="text-info edit-btns" data-id="{{$socialapplication->id}}" ><i class="fas fa-pen"></i></a>
                         <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="{{$idx}}" data-id="{{$socialapplication->id}}"><i class="fas fa-trash-alt"></i></a>
                    </td>
                    ....
                    <!-- start create edit modal -->
                    <div id="cemodal" class="modal fade">
                         <div class="modal-dialog modal-dialog-centered">
                              <div class="modal-content rounded-0">
                                   <div class="modal-header">
                                        <h6 class="modal-title">Modal Title</h6>
                                        <button type="" class="btn-close" data-bs-dismiss="modal"></button>
                                   </div>

                                   <div class="modal-body">
                                        <form id="formaction" action="" method="">
                                             <div class="row align-items-end">
                                                  <div class="col-md-7">
                                                       <label for="name">Name <span class="text-danger">*</span></label>
                                                       <input type="text" name="name" id="name" class="form-control form-control-sm rounded-0" placeholder="Enter Application Name" value="{{ old('name') }}"/>
                                                  </div>
                                                  
                                                  <div class="col-md-3 form-group">
                                                       <label for="status_id">Status</label>
                                                       <select name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                                                            @foreach($statuses as $status)
                                                                 <option value="{{$status['id']}}">{{$status['name']}}</option>
                                                            @endforeach     
                                                       </select>
                                                  </div>
                                                  
                                                  <input type="hidden" name="id" id="id"/>

                                                  <div class="col-md-2">
                                                       <button type="submit" id="action-btn" class="btn btn-primary btn-sm rounded-0" value="action-type">Submit</button>
                                                  </div>
                                             </div>
                                        </form>
                                   </div>

                                   <div class="modal-footer">

                                   </div>
                              </div>
                         </div>
                    </div>
                    <!-- end create edit modal -->

                    // Start Edit Form
                              $(document).on("click",".edit-btns",function(){
                              const getid = $(this).data("id");
                              // console.log(getid);

                              $.get(`socialapplications/${getid}/edit`,function(response){
                                   // console.log(response); // {id: 9, name: 'myanmar', slug: 'myanmar', status_id: 3, user_id: 1, …}

                                   // Preparing modal and form for create
                                   $("#cemodal .modal-title").text("Edit Form");
                                   $("#action-btn").text("Update");
                                   $("#action-btn").val("editing");
                                   
                                   $("#id").val(response.id);
                                   $("#name").val(response.name);
                                   $("#status_id").val(response.status_id);

                                   $("#cemodal").modal("show");
                              });
                         });
                    // End Edit Form

                    $("#formaction").validate({
                         rules:{
                              name:"required"
                         },
                         messages:{
                              name:"Please enter the application name"
                         },

                         submitHandler:function(form){
                              let actiontype = $("#action-btn").val();
                              console.log(actiontype);

                              if(actiontype === "create-btn"){
                                   ....
                              }else{
                                        const getid = $("#id").val();
                                        
                                        $.ajax({
                                             url:`socialapplications/${getid}`,
                                             type:"PUT",
                                             dataType:"json",
                                             data:$("#formaction").serialize(), // name=&status_id=4
                                             success:function(response){
                                                  // console.log(this.data);  //name=kpay&status_id=3
                                                  console.log(response);   // paymentmethods:525 {status: 'success', data: {…}}
                                                  // console.log(response.status);
                                                  const data = response.data;
                                                  let html = `
                                                       <tr id="socialapp_${data.id}">
                                                            <td>${data.id}</td>
                                                            <td>${data.name}</td>
                                                            <td>
                                                                 <div class="form-checkbox form-switch">
                                                                      <input type="checkbox" class="form-check-input change-btn" ${data.status_id == 3 ? "checked" : "" }  data-id="${data.id}" />
                                                                 </div>
                                                            </td>
                                                            <td>${data.user_id}</td>
                                                            <td>${data.created_at}</td>
                                                            <td>${data.updated_at}</td>
                                                            <td>
                                                                 <a href="javascript:void(0);" class="text-info edit-btns" data-id="${data.id}" ><i class="fas fa-pen"></i></a>
                                                                 <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="${data.id}" data-id="${data.id}"><i class="fas fa-trash-alt"></i></a>
                                                            </td>
                                                       </tr>
                                                       `;
                                                  $("#socialapp_"+data.id).replaceWith(html);
                                                  
                                                  // Hide modal after replacing social app item
                                                  $("#cemodal").modal("hide");
                                             }
                                        });
                                   }
                              }
                    });

               =>Delete Social Application 
                    $(".delete-btns").click(function(){
                         const getidx = $(this).attr("data-idx");
                         const getid = $(this).data("id");
                         // console.log(getid);

                         if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
                              
                              // data remove 
                              $.ajax({
                                   url:`socialapplications/${getid}`,
                                   type:"DELETE",
                                   dataType:"json",
                                   // data:{_token:"{{csrf_token()}}"},
                                   success:function(response){
                                        console.log(response);   // 1
                                        
                                        if(response){
                                             // ui remove
                                             $(`#socialapp_${getid}`).remove();
                                        }
                                   },
                                   error:function(response){
                                        console.log("Error: ",response)
                                   }
                              });
                              return true;
                         }else{
                              return false;
                         }
                    });          

          =>Ajax Read 
               =In SocialapplicationsController.php    
                    public function fetchalldatas()
                    {
                         try{
                              $socialapplications = Socialapplication::all();
                              return response()->json(["status"=>"scuccess","data"=>$socialapplications]);
                         }catch(Exception $e){
                              return response()->json(["status"=>"failed","message"=>$e->getMessage()]);
                         }
                         
                    }

               =socialapplications > index.blade.php 
                    //Start change-btn
                    $(document).on("change",".change-btn",function(){
                         console.log("hi");

                         var getid = $(this).data("id");
                         // console.log(getid); // 1 2

                         var setstatus = $(this).prop("checked") === true ? 3 : 4;
                         // console.log(setstatus); // 3 4

                         $.ajax({
                              url:"socialapplicationsstatus",
                              type:"GET",
                              dataType:"json",
                              data:{"id":getid,"status_id":setstatus},
                              success:function(response){
                                   console.log(response); // {success: 'Status Change Successfully'}
                                   console.log(response.success); // Status Change Successfully
                              }
                         });
                    });
                    // End change btn

                    // Start Delete Item
                    // by ajax 
                    // Using default laravel route
                    $(document).on("click",".delete-btns",function(){
                         const getidx = $(this).attr("data-idx");
                         const getid = $(this).data("id");
                         // console.log(getid);
                         
                         if(confirm(`Are you sure !!! you want to Delete ${getidx} ?`)){
                         
                              // data remove 
                              $.ajax({
                                   url:`socialapplications/${getid}`,
                                   type:"DELETE",
                                   dataType:"json",
                                   // data:{_token:"{{csrf_token()}}"},
                                   success:function(response){
                                        console.log(response);   // 1
                                        
                                        if(response){
                                             // ui remove
                                             $(`#delete_${getid}`).remove();
                                        }
                                   },
                                   error:function(response){
                                        console.log("Error: ",response)
                                   }
                              });
                              return true;
                         }else{
                              return false;
                         }
                    });

                    // End Delete Item

                    *generate custom idx 
                    *$(".change-btn").change(function(){  
                    is not working (we can't change status for social application, nothing happen) 
                    because it is not pure html element.
                    tr, td and buttons are created by javascript and moved to html page.
                    so we use document element calling method.   

                    =Change Status 
                    =Edit form (Stage already changed)

                    =Change status from Edit form
                    =Check status in UI (Stage already changed)             

          =>Alert Box for Ajax request
               =toaster only work when reload 
               =we ned to use another alert box to work with ajax

               https://sweetalert2.github.io/

               Examples > 
               A confirm dialog, with a function attached to the "Confirm"-button

               Swal.fire({
                    title: "Are you sure?",
                    text: "You won't be able to revert this!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Yes, delete it!"
               }).then((result) => {
                    if (result.isConfirmed) {
                         Swal.fire({
                              title: "Deleted!",
                              text: "Your file has been deleted.",
                              icon: "success"
                         });
                    }
               });

               DOWNLOAD & INSTALL
               <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

               =>Alert for delete socialapplications
                    =In socialapplications > index.blade.php 

                         @section("scripts")
                              <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js" type="text/javascript"></script>
                              <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js" type="text/javascript"></script>
                              <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

                              ....
                              // Using default laravel route
                              $(document).on("click",".delete-btns",function(){
                                   const getidx = $(this).attr("data-idx");
                                   const getid = $(this).data("id");
                                   // console.log(getid);
                                   
                                   Swal.fire({
                                        title: "Are you sure?",
                                        text: `You won't be able to revert this id ${getidx}`,
                                        icon: "warning",
                                        showCancelButton: true,
                                        confirmButtonColor: "#3085d6",
                                        cancelButtonColor: "#d33",
                                        confirmButtonText: "Yes, delete it!"
                                   }).then((result) => {
                                        if (result.isConfirmed) {
                                             // data remove 
                                             $.ajax({
                                                  url:`socialapplications/${getid}`,
                                                  type:"DELETE",
                                                  dataType:"json",
                                                  // data:{_token:"{{csrf_token()}}"},
                                                  success:function(response){
                                                       console.log(response);   // 1
                                                       
                                                       if(response){
                                                            // ui remove
                                                            $(`#delete_${getid}`).remove();
                                                       
                                                            Swal.fire({
                                                                 title: "Deleted!",
                                                                 text: "Your file has been deleted.",
                                                                 icon: "success"
                                                            });
                                                       }
                                                  },
                                                  error:function(response){
                                                       console.log("Error: ",response)
                                                  }
                                             });
                                             
                                        }
                                   });   
                              });

               =>Alert for create socialapplications
                    =In socialapplications > index.blade.php 
                         $("#formaction").validate({
                              rules:{
                                   name:"required"
                              },
                              messages:{
                                   name:"Please enter the application name"
                              },

                              submitHandler:function(form){
                                   let actiontype = $("#action-btn").val();
                                   console.log(actiontype);

                                   if(actiontype === "create-btn"){
                                        let formdata = $(form).serialize();

                                        $("#action-btn").text("Sending....");

                                        $.ajax({
                                             url: "{{route('socialapplications.store')}}",
                                             type:"POST",
                                             data: formdata,
                                             dataType:"json",
                                             success:function(response){
                                                  console.log(response);
                                                  // console.log(response.status);
                                                  
                                                  if(response && response.status === "success"){
                                                       $("#createmodal").modal("hide"); // toggle() can also used.
                                                       
                                                       const data = response.data;
                                                       let html = `
                                                       <tr id="delete_${data.id}">
                                                            <td>${data.id}</td>
                                                            <td>${data.name}</td>
                                                            <td>
                                                                 <div class="form-checkbox form-switch">
                                                                      <input type="checkbox" class="form-check-input change-btn" ${data.status_id == 3 ? "checked" : "" }  data-id="${data.id}" />
                                                                 </div>
                                                            </td>
                                                            <td>${data.user_id}</td>
                                                            <td>${data.created_at}</td>
                                                            <td>${data.updated_at}</td>
                                                            <td>
                                                                 <a href="javascript:void(0);" class="text-info edit-btns" data-id="${data.id}" ><i class="fas fa-pen"></i></a>
                                                                 <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="${data.id}" data-id="${data.id}"><i class="fas fa-trash-alt"></i></a>
                                                            </td>
                                                       </tr>
                                                       `;
                                                       $("#mytable tbody").prepend(html);

                                                       $("#action-btn").html("Sutmit");

                                                       Swal.fire({
                                                            title: "Added!",
                                                            text: "Added Successfully",
                                                            icon: "success"
                                                       });
                                                  }
                                             },
                                             error:function(response){
                                                  console.log("Error:",response);
                                             }
                                        })
                                   }else{
                                        ....
                                   }
                              }
                         });
               
               =>Alert for update socialapplications
                    =In socialapplications > index.blade.php 
                         $("#formaction").validate({
                              rules:{
                                   name:"required"
                              },
                              messages:{
                                   name:"Please enter the application name"
                              },

                              submitHandler:function(form){
                                   let actiontype = $("#action-btn").val();
                                   console.log(actiontype);

                                   if(actiontype === "create-btn"){
                                   ....
                                   }else{
                                        const getid = $("#id").val();
                                        
                                        $.ajax({
                                             url:`socialapplications/${getid}`,
                                             type:"PUT",
                                             dataType:"json",
                                             data:$("#formaction").serialize(), // name=&status_id=4
                                             success:function(response){
                                                  // console.log(this.data);  //name=kpay&status_id=3
                                                  console.log(response);   // paymentmethods:525 {status: 'success', data: {…}}
                                                  // console.log(response.status);
                                                  const data = response.data;
                                                  let html = `
                                                       <tr id="delete_${data.id}">
                                                            <td>${data.id}</td>
                                                            <td>${data.name}</td>
                                                            <td>
                                                                 <div class="form-checkbox form-switch">
                                                                      <input type="checkbox" class="form-check-input change-btn" ${data.status_id == 3 ? "checked" : "" }  data-id="${data.id}" />
                                                                 </div>
                                                            </td>
                                                            <td>${data.user_id}</td>
                                                            <td>${data.created_at}</td>
                                                            <td>${data.updated_at}</td>
                                                            <td>
                                                                 <a href="javascript:void(0);" class="text-info edit-btns" data-id="${data.id}" ><i class="fas fa-pen"></i></a>
                                                                 <a href="javascript:void(0);" class="text-danger ms-2 delete-btns" data-idx="${data.id}" data-id="${data.id}"><i class="fas fa-trash-alt"></i></a>
                                                            </td>
                                                       </tr>
                                                       `;
                                                  $("#delete_"+data.id).replaceWith(html);
                                                  
                                                  $("#createmodal").modal("hide");

                                                  Swal.fire({
                                                       title: "Updated!",
                                                       text: "Updated Successfully",
                                                       icon: "success"
                                                  });
                                             }
                                        });
                                   }
                              }
                         });

               =>Alert for status change socialapplications 
                    =In socialapplications > index.blade.php 
                         //Start change-btn
                         $(document).on("change",".change-btn",function(){

                              var getid = $(this).data("id");
                              // console.log(getid); // 1 2

                              var setstatus = $(this).prop("checked") === true ? 3 : 4;
                              // console.log(setstatus); // 3 4

                              $.ajax({
                                   url:"socialapplicationsstatus",
                                   type:"GET",
                                   dataType:"json",
                                   data:{"id":getid,"status_id":setstatus},
                                   success:function(response){
                                        console.log(response); // {success: 'Status Change Successfully'}
                                        console.log(response.success); // Status Change Successfully
                                   
                                        Swal.fire({
                                             title: "Updated!",
                                             text: "Updated Successfully",
                                             icon: "success"
                                        });
                                   }
                              });
                         });
                         // End change btn

                    =change status on/off 
                    =review alert message 
                    =reload the page (check status actually change)

          =>Testing Data Sending By changing network speed - (to notice button changes )
               Chrome  > http://127.0.0.1:8000/socialapplications
               Inspect 
               Network Tab 
               Network speed Dropdown > 
                    Change No Trottling - Slow 3G 

               =Edit a socialapplication 
               =You will notice the connection is very slow and see the button change its text to Sending.

     =>Attendance Code Auto Generator          
          Current attandance code system have some weaknesses.
               -students can provide multiple attendance codes for incorrect class and class date
               -database consumption
               -attendance data inaccuracy
               -need more human resource to verify attendance codes 

          Auto Attendance Generator Advantates
               -Student can only provide correct attendance code for precise class and class date 
               -database optiimation
               -Enhance data accuracy

          =Migration 
               php artisan make:model Attcodegenerator -m 

               =In create_attcodegenerators_table.php 
                    up()
                         $table->date("classdate");
                         $table->foreignId("post_id")->constrained()->onUpdate("cascade")->onDelete("cascade");
                         $table->string("attcode");    
                         $table->unsignedBigInteger("status_id");
                         $table->unsignedBigInteger("user_id");

                    *status_id for restriction of att code entry at the next day after class. 
                    The att code is expire after one day 24 hr. All code exceed one day, should automatically change state to 'off'. 

               php artisan migrate:status 
               php artisan migrate
     
          php artisan make:controller AttcodegeneratorsController

          =In web.php 
               *use App\Http\Controllers\AttcodegeneratorsController;
               
               Route::resource("attcodegenerators",AttcodegeneratorsController::class);
               Route::get("/attcodegeneratorssstatus",[AttcodegeneratorsController::class,"typestatus"]);
               
          =In Attcodegenerator.php 
               protected $table = "attcodegenerators";
               protected $primaryKey = "id";
               protected $fillable = [
                    "classdate",
                    "post_id",
                    "attcode",
                    "status_id",
                    "user_id"
               ];

               public function post(){
                    return $this->belongsTo(Post::class);
               }

               public function user(){
                    return $this->belongsTo(User::class);
               }


          =In attcodegenerators > index.blade.php 
               <form action="{{route('attcodegenerators.store')}}" method="POST">
                    {{ csrf_field() }}

                    <div class="row align-items-end">
                         <div class="col-md-3 form-group mb-3">
                              <label for="classdate">Class Date <span class="text-danger">*</span></label>
                              @error("classdate")
                                   <span class="text-danger">{{ $message }}<span>
                              @enderror
                              <input type="date" name="classdate" id="classdate" class="form-control form-control-sm rounded-0" value="{{ $gettoday }}"/>
                         </div>

                         <div class="col-md-3 form-group mb-3">
                              <label for="post_id">Class <span class="text-danger">*</span></label>
                              @error("post_id")
                                   <span class="text-danger">{{ $message }}<span>
                              @enderror
                              <select name="post_id" id="post_id" class="form-control form-control-sm rounded-0">
                                   <option selected disabled>Choose class</option>
                                   @foreach($posts as $post)
                                        {{-- <option value="{{$post['id']}}">{{$post['title']}}</option> --}}
                                        <option value="{{$post->id}}">{{$post->title}}</option> 
                                   @endforeach     
                              </select>
                         </div>

                         <div class="col-md-3 form-group mb-3">
                              <label for="status_id">Status</label>
                              @error("status_id")
                                   <span class="text-danger">{{ $message }}<span>
                              @enderror
                              <select name="status_id" id="status_id" class="form-control form-control-sm rounded-0">
                                   @foreach($statuses as $status)
                                        <option value="{{$status['id']}}">{{$status['name']}}</option>
                                   @endforeach     
                              </select>
                         </div>

                         <div class="col-md-3 form-group mb-3">
                              <label for="attcode">Attendance Code <span class="text-danger">*</span></label>
                              @error("attcode")
                                   <span class="text-danger">{{ $message }}<span>
                              @enderror
                              <input type="text" name="attcode" id="attcode" class="form-control form-control-sm rounded-0" value="{{ old('attcode') }}"/>
                         </div>

                         <div class="col-md-12 text-end">
                              <button type="reset" class="btn btn-secondary btn-sm rounded-0">Cancel</button>
                              <button type="submit" class="btn btn-primary btn-sm rounded-0 ms-3">Submit</button>
                         </div>
                    </div>
               </form>
               ...
               <table id="mytable" class="table table-sm table-hover border">
          
                    <thead>
                         <th>No</th>
                         <th>Class</th>
                         <th>Att Code</th>
                         <th>Class Date</th>
                         <th>By</th>
                         <th>Created At</th>
                         <th>Action</th>
                    </thead>
          
                    <tbody>
                         @foreach($attcodegenerators as $idx=>$attcodegenerator)
                         <tr>
                              <td>{{++$idx}}</td>
                              <td>{{$attcodegenerator->post["title"]}}</td>
                              <td>{{ $attcodegenerator->attcode }}</td>
                              <td>{{ $attcodegenerator->classdate }}</td>
                              <td>{{  $attcodegenerator->user->name }}</td>
                              <td>{{ $attcodegenerator->created_at->format('d M Y') }}</td>
                              <td>
                                   <div class="form-checkbox form-switch">
                                        <input type="checkbox" class="form-check-input change-btn" {{  $attcodegenerator->status_id === 3 ? 'checked' : '' }} data-id="{{ $attcodegenerator->id }}" />
                                   </div>
                              </td>
                         </tr>
                         @endforeach
                    </tbody>
               </table>
               ....

               //Start change-btn
               $(document).on("change",".change-btn",function(){

                    var getid = $(this).data("id");
                    // console.log(getid); // 1 2

                    var setstatus = $(this).prop("checked") === true ? 3 : 4;
                    // console.log(setstatus); // 3 4

                    $.ajax({
                         url:"attcodegeneratorssstatus",
                         type:"GET",
                         dataType:"json",
                         data:{"id":getid,"status_id":setstatus},
                         success:function(response){
                              console.log(response); // {success: 'Status Change Successfully'}
                              console.log(response.success); // Status Change Successfully
                         
                              Swal.fire({
                                   title: "Updated!",
                                   text: "Updated Successfully",
                                   icon: "success"
                              });
                         }
                    });
               });
               // End change btn

               *Laravel Server send today data as "Y-m-d"
                    -HTML show today as "m-d-Y" // 06/03/2024

               *When laravel send today as 
                    $gettoday = date("m-d-Y",strtotime(Carbon::today())); 
                    -HTML can't show date and time correctly.

          =In AttcodegeneratorsController.php
               public function index()
               {
                    $attcodegenerators = Attcodegenerator::orderBy('created_at','desc')->get();
                    // $posts = Post::where("attshow",3)->get();
                    $posts = DB::table("posts")->where("attshow",3)->orderBy("title","asc")->get();
                    $statuses = Status::whereIn("id",[3,4])->get();
                    // $gettoday = date("Y-m-d",strtotime(Carbon::today())); 
                    $gettoday = Carbon::today()->format("Y-m-d");
                    // dd($gettoday);//  "2024-06-03" 
                    // dd(strtotime(Carbon::today())); // 1717349400
                    
                    return view("attcodegenerators.index",compact("attcodegenerators","posts","statuses","gettoday"));
               }
               ....
               public function typestatus(Request $request){
                    $paymentmethod = Attcodegenerator::findOrFail($request["id"]);
                    $paymentmethod->status_id = $request["status_id"];
                    $paymentmethod->save();

                    return response()->json(["success"=>"Status Change Successfully"]);
               }

          =create an attcodegeeneratos without filling Attendance Code      
          *empty value will store to database 

          System must generate a random att code if nothing fill to att code.
          
          =>Generating Random Attendance Code
               =In AttcodegeneratorsController.php 

                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "classdate" => "required|date",
                              "post_id" => "required"
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $attcodegenerator = new Attcodegenerator();
                         $attcodegenerator->classdate = $request["classdate"];
                         $attcodegenerator->post_id = $request["post_id"];
                         $attcodegenerator->attcode = is_null($request['attcode']) ? $attcodegenerator->randomstringgenerator(4) : Str::upper($request["attcode"]);
                         $attcodegenerator->status_id = $request["status_id"];
                         $attcodegenerator->user_id = $user_id;

                         $attcodegenerator->save();
                         session()->flash("success","Att Code Created");
                         return redirect(route("attcodegenerators.index"));
                    }

               =In Attcodegenerator.php 
                    public function randomstringgenerator($length){
        
                         $characters = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"; // index 0 to 35
                         $characterlengts = strlen($characters);
                         // dd($characterlengts); // 36 

                         $randomstring = "";
                         for($i=0 ; $i<$length; $i++){
                              $randomstring .=  $characters[rand(0,$characterlengts-1)];
                         }

                         // dd($randomstring); // VJMD // 1XES
                         return $randomstring;
                    }

               -Until the string length reaching to its limitation, 
               -pick up string from characters array as the random generated index number 

               *result 
                    $randomstring .= rand(0,$characterlengts-1);
                    // 1528719
               *Nuber comming out more than 4 because number greater than 10 (more than 1 digit) can be generated 

               =In phpmyadmin 
                    "attcodegeneratos"
                         id	classdate	     post_id	attcode	status_id	user_id	created_at	     updated_at	
                         4    2024-06-04     16        VRVC      3         1         2024-06-04 16:05:32 2024-06-04 16:12:05
                         6    2024-06-04     17        SK7Q      3         1         2024-06-04 16:06:08 2024-06-04 16:12:07

                         manual entry (attcode)
                         7    2024-06-04     20        A1B1      3         1         2024-06-04 16:07:09 2024-06-04 16:12:01

          =>Verifying Student provided att code 

               =In AttendancesController.php 
                    public function store(Request $request)
                    {
                         $this->validate($request,[
                              "classdate" => "required|date",
                              "post_id" => "required",
                              "attcode" => "required"
                         ]);

                         $user = Auth::user();
                         $user_id = $user->id;

                         $getclassdate = $request["classdate"];
                         $getpostid = $request["post_id"];
                         $getattcode = Str::upper($request["attcode"]);

                         $attendance = new Attendance();
                         if($attendance->checkattcode($getclassdate,$getpostid,$getattcode)){
                              $attendance->classdate = $getclassdate;
                              $attendance->post_id = $getpostid;
                              $attendance->attcode = $getattcode;
                              $attendance->user_id = $user_id;
                    
                              $attendance->save();
                              session()->flash("success","Att Created");
                         }else{
                              session()->flash("error","Failed Try Again!");
                         }
                         return redirect(route("attendances.index"));
                         
                    }
               
               =In Attendance.php 
                    public function checkattcode($classdate,$postid,$attcode){
                         $checkresult = \DB::table("attcodegenerators")->whereDate("classdate",$classdate)->where("post_id",$postid)->where("attcode",$attcode)->where("status_id",3)->exists();
                         // dd($checkresult);
                         return $checkresult;
                    }

                    *The precedence of data column in checking where condition is to narrow scope of findings.
                         Among many class, firstly sort out today classes,
                         then choose the specific class, 
                         finally check class status.
               
               =In layouts > adminfooter.blade.php 
                    ....
                     @if(session()->has("error"))
                         <script>toastr.error('{{ session()->get("error") }}', 'Inconceivable')</script>
                    @endif

               *result (false) - Wrong Code 
                    Class Date * = 06/04/2024     
                    Class * = JS Small App Batch 10     
                    Attendance Code * = abcd

               *result (false) - Wrong Class 
                    Class Date * = 06/04/2024     
                    Class * = CSS Inter Batch 5
                    Attendance Code * = SK7Q

               *result (false) - Wrong Date 
                    Class Date * = 06/02/2024     
                    Class * = JS Small App Batch 10 
                    Attendance Code * = SK7Q

               *result (false) - (attcodegenerator status off)
                    Class Date * = 06/04/2024     
                    Class * = JS Small App Batch 10     
                    Attendance Code * = SK7Q

               *result (true) - (attcodegenerator status on)
                    Class Date * = 06/04/2024     
                    Class * = JS Small App Batch 10     
                    Attendance Code * = SK7Q

               We need to off status of attcodegenerator at 12PM at midnight automatically.
               We can use 
                    Linux - Chrome Job 
                    Window - Auto TAsk 
                    Laravel (single command) - Job

     =>Warehouse
          =>Ajax Weakness
               http://127.0.0.1:8000/socialapplications
               No	Name	Status	By	Created At	               Updated At	
               1	indonesia	     1	2024-05-19T12:21:15.000000Z	2024-06-03T09:45:24.000000Z        

               *By show user as number not user name 
               *Created At and Updated At are not formatted

          php artisan make:model Warehouse -m